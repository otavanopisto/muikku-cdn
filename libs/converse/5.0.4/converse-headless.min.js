!function(e){function t(t){for(var n,i,s=t[0],o=t[1],a=0,u=[];a<s.length;a++)i=s[a],r[i]&&u.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);u.length;)u.shift()()}var n={},r={162:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise(function(t,i){n=r[e]=[t,i]});t.push(n[2]=s);var o,a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(e){return i.p+""+({0:"locales/dayjs/af",1:"locales/dayjs/ar",2:"locales/dayjs/ar-dz",3:"locales/dayjs/ar-kw",4:"locales/dayjs/ar-ly",5:"locales/dayjs/ar-ma",6:"locales/dayjs/ar-sa",7:"locales/dayjs/ar-tn",8:"locales/dayjs/az",9:"locales/dayjs/be",10:"locales/dayjs/bg",11:"locales/dayjs/bm",12:"locales/dayjs/bn",13:"locales/dayjs/bo",14:"locales/dayjs/br",15:"locales/dayjs/bs",16:"locales/dayjs/ca",17:"locales/dayjs/cs",18:"locales/dayjs/cv",19:"locales/dayjs/cy",20:"locales/dayjs/da",21:"locales/dayjs/de",22:"locales/dayjs/de-at",23:"locales/dayjs/de-ch",24:"locales/dayjs/dv",25:"locales/dayjs/el",26:"locales/dayjs/en",27:"locales/dayjs/en-SG",28:"locales/dayjs/en-au",29:"locales/dayjs/en-ca",30:"locales/dayjs/en-gb",31:"locales/dayjs/en-ie",32:"locales/dayjs/en-il",33:"locales/dayjs/en-nz",34:"locales/dayjs/eo",35:"locales/dayjs/es",36:"locales/dayjs/es-do",37:"locales/dayjs/es-us",38:"locales/dayjs/et",39:"locales/dayjs/eu",40:"locales/dayjs/fa",41:"locales/dayjs/fi",42:"locales/dayjs/fo",43:"locales/dayjs/fr",44:"locales/dayjs/fr-ca",45:"locales/dayjs/fr-ch",46:"locales/dayjs/fy",47:"locales/dayjs/ga",48:"locales/dayjs/gd",49:"locales/dayjs/gl",50:"locales/dayjs/gom-latn",51:"locales/dayjs/gu",52:"locales/dayjs/he",53:"locales/dayjs/hi",54:"locales/dayjs/hr",55:"locales/dayjs/hu",56:"locales/dayjs/hy-am",57:"locales/dayjs/id",58:"locales/dayjs/is",59:"locales/dayjs/it",60:"locales/dayjs/it-ch",61:"locales/dayjs/ja",62:"locales/dayjs/jv",63:"locales/dayjs/ka",64:"locales/dayjs/kk",65:"locales/dayjs/km",66:"locales/dayjs/kn",67:"locales/dayjs/ko",68:"locales/dayjs/ku",69:"locales/dayjs/ky",70:"locales/dayjs/lb",71:"locales/dayjs/lo",72:"locales/dayjs/lt",73:"locales/dayjs/lv",74:"locales/dayjs/me",75:"locales/dayjs/mi",76:"locales/dayjs/mk",77:"locales/dayjs/ml",78:"locales/dayjs/mn",79:"locales/dayjs/mr",80:"locales/dayjs/ms",81:"locales/dayjs/ms-my",82:"locales/dayjs/mt",83:"locales/dayjs/my",84:"locales/dayjs/nb",85:"locales/dayjs/ne",86:"locales/dayjs/nl",87:"locales/dayjs/nl-be",88:"locales/dayjs/nn",89:"locales/dayjs/oc-lnc",90:"locales/dayjs/pa-in",91:"locales/dayjs/pl",92:"locales/dayjs/pt",93:"locales/dayjs/pt-br",94:"locales/dayjs/ro",95:"locales/dayjs/ru",96:"locales/dayjs/sd",97:"locales/dayjs/se",98:"locales/dayjs/si",99:"locales/dayjs/sk",100:"locales/dayjs/sl",101:"locales/dayjs/sq",102:"locales/dayjs/sr",103:"locales/dayjs/sr-cyrl",104:"locales/dayjs/ss",105:"locales/dayjs/sv",106:"locales/dayjs/sw",107:"locales/dayjs/ta",108:"locales/dayjs/te",109:"locales/dayjs/tet",110:"locales/dayjs/tg",111:"locales/dayjs/th",112:"locales/dayjs/tl-ph",113:"locales/dayjs/tlh",114:"locales/dayjs/tr",115:"locales/dayjs/tzl",116:"locales/dayjs/tzm",117:"locales/dayjs/tzm-latn",118:"locales/dayjs/ug-cn",119:"locales/dayjs/uk",120:"locales/dayjs/ur",121:"locales/dayjs/uz",122:"locales/dayjs/uz-latn",123:"locales/dayjs/vi",124:"locales/dayjs/x-pseudo",125:"locales/dayjs/yo",126:"locales/dayjs/zh-cn",127:"locales/dayjs/zh-hk",128:"locales/dayjs/zh-tw",129:"emojis",130:"locales/af-LC_MESSAGES-converse-po",131:"locales/ar-LC_MESSAGES-converse-po",132:"locales/bg-LC_MESSAGES-converse-po",133:"locales/ca-LC_MESSAGES-converse-po",134:"locales/cs-LC_MESSAGES-converse-po",135:"locales/de-LC_MESSAGES-converse-po",136:"locales/eo-LC_MESSAGES-converse-po",137:"locales/es-LC_MESSAGES-converse-po",138:"locales/eu-LC_MESSAGES-converse-po",139:"locales/fr-LC_MESSAGES-converse-po",140:"locales/gl-LC_MESSAGES-converse-po",141:"locales/he-LC_MESSAGES-converse-po",142:"locales/hi-LC_MESSAGES-converse-po",143:"locales/hu-LC_MESSAGES-converse-po",144:"locales/id-LC_MESSAGES-converse-po",145:"locales/it-LC_MESSAGES-converse-po",146:"locales/ja-LC_MESSAGES-converse-po",147:"locales/lt-LC_MESSAGES-converse-po",148:"locales/nb-LC_MESSAGES-converse-po",149:"locales/nl-LC_MESSAGES-converse-po",150:"locales/nl_BE-LC_MESSAGES-converse-po",151:"locales/oc-LC_MESSAGES-converse-po",152:"locales/pl-LC_MESSAGES-converse-po",153:"locales/pt-LC_MESSAGES-converse-po",154:"locales/pt_BR-LC_MESSAGES-converse-po",155:"locales/ro-LC_MESSAGES-converse-po",156:"locales/ru-LC_MESSAGES-converse-po",157:"locales/tr-LC_MESSAGES-converse-po",158:"locales/uk-LC_MESSAGES-converse-po",159:"locales/vi-LC_MESSAGES-converse-po",160:"locales/zh_CN-LC_MESSAGES-converse-po",161:"locales/zh_TW-LC_MESSAGES-converse-po"}[e]||e)+".js"}(e);var c=new Error;o=function(t){a.onerror=a.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+s+")",c.name="ChunkLoadError",c.type=i,c.request=s,n[1](c)}r[e]=void 0}};var u=setTimeout(function(){o({type:"timeout",target:a})},12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="https://cdn.muikkuverkko.fi/libs/converse/5.0.4/",i.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp=window.webpackJsonp||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var a=0;a<s.length;a++)t(s[a]);var c=o;i(i.s=352)}([function(e,t,n){var r,i;r=[n(2)],void 0===(i=function(e){return e.noConflict()}.apply(t,r))||(e.exports=i)},function(e,t,n){e.exports=function(e,t){function n(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function r(e,t){for(var n in t)e[n]=t[n];return e}function i(e,n,r){var i;if("local"===r&&!window.localStorage)throw"Backbone.browserStorage: Environment does not support localStorage.";if("session"===r&&!window.sessionStorage)throw"Backbone.browserStorage: Environment does not support sessionStorage.";if(this.name=e,this.serializer=n||{serialize:function(e){return t.isObject(e)?JSON.stringify(e):e},deserialize:function(e){return e&&JSON.parse(e)}},"session"===r)this.store=window.sessionStorage;else{if("local"!==r)throw"Backbone.browserStorage: No storage type was specified";this.store=window.localStorage}i=this.store.getItem(this.name),this.records=i&&i.split(",")||[]}e.BrowserStorage={local:function(e,t){return i.bind(this,e,t,"local")()},session:function(e,t){return i.bind(this,e,t,"session")()}};var s={save:function(){this.store.setItem(this.name,this.records.join(","))},create:function(e,t){return e.id||(e.id=n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n(),e.set(e.idAttribute,e.id,t)),this.store.setItem(this._itemName(e.id),this.serializer.serialize(e)),this.records.push(e.id.toString()),this.save(),this.find(e)},update:function(e){this.store.setItem(this._itemName(e.id),this.serializer.serialize(e));var t=e.id.toString();return function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1}(this.records,t)||(this.records.push(t),this.save()),this.find(e)},find:function(e){return this.serializer.deserialize(this.store.getItem(this._itemName(e.id)))},findAll:function(){for(var e,t,n=[],r=0;r<this.records.length;r++)e=this.records[r],null!==(t=this.serializer.deserialize(this.store.getItem(this._itemName(e))))&&n.push(t);return n},destroy:function(e){this.store.removeItem(this._itemName(e.id));for(var t=e.id.toString(),n=0;n<this.records.length;n++)this.records[n]===t&&this.records.splice(n,1);return this.save(),e},browserStorage:function(){return{session:sessionStorage,local:localStorage}},_clear:function(){var e,t=this.store;for(var n in e=new RegExp("^"+this.name.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+"-"),t.removeItem(this.name),t)e.test(n)&&t.removeItem(n);this.records.length=0},_storageSize:function(){return this.store.length},_itemName:function(e){return this.name+"-"+e}};return r(e.BrowserStorage.session.prototype,s),r(e.BrowserStorage.local.prototype,s),e.BrowserStorage.sync=e.localSync=function(t,n,r){var i,s,o=n.browserStorage||n.collection.browserStorage,a=e.$?e.$.Deferred&&e.$.Deferred():e.Deferred&&e.Deferred();try{switch(t){case"read":i=void 0!==n.id?o.find(n):o.findAll();break;case"create":i=o.create(n,r);break;case"update":i=o.update(n,r);break;case"delete":i=o.destroy(n,r)}}catch(e){s=22===e.code&&0===o._storageSize()?"Private browsing is unsupported":e.message}return i?(r&&r.success&&r.success(i,r),a&&a.resolve(i)):(s=s||"Record Not Found",r&&r.error&&r.error(s),a&&a.reject(s)),r&&r.complete&&r.complete(i),a&&a.promise()},e.ajaxSync=e.sync,e.getSyncMethod=function(t){return t.browserStorage||t.collection&&t.collection.browserStorage?e.localSync:e.ajaxSync},e.sync=function(t,n,r){return e.getSyncMethod(n).apply(this,[t,n,r])},e.BrowserStorage}(n(8),n(48))},function(e,t,n){(function(e,r){var i;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var s,o=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",u="__lodash_hash_undefined__",l=500,d="__lodash_placeholder__",h=1,f=2,p=4,g=1,m=2,_=1,v=2,b=4,y=8,S=16,w=32,x=64,E=128,A=256,j=512,N=30,C="...",O=800,T=16,R=1,M=2,I=1/0,k=9007199254740991,L=17976931348623157e292,D=NaN,F=4294967295,P=F-1,U=F>>>1,z=[["ary",E],["bind",_],["bindKey",v],["curry",y],["curryRight",S],["flip",j],["partial",w],["partialRight",x],["rearg",A]],B="[object Arguments]",H="[object Array]",q="[object AsyncFunction]",$="[object Boolean]",G="[object Date]",W="[object DOMException]",J="[object Error]",Y="[object Function]",X="[object GeneratorFunction]",V="[object Map]",Q="[object Number]",Z="[object Null]",K="[object Object]",ee="[object Proxy]",te="[object RegExp]",ne="[object Set]",re="[object String]",ie="[object Symbol]",se="[object Undefined]",oe="[object WeakMap]",ae="[object WeakSet]",ce="[object ArrayBuffer]",ue="[object DataView]",le="[object Float32Array]",de="[object Float64Array]",he="[object Int8Array]",fe="[object Int16Array]",pe="[object Int32Array]",ge="[object Uint8Array]",me="[object Uint8ClampedArray]",_e="[object Uint16Array]",ve="[object Uint32Array]",be=/\b__p \+= '';/g,ye=/\b(__p \+=) '' \+/g,Se=/(__e\(.*?\)|\b__t\)) \+\n'';/g,we=/&(?:amp|lt|gt|quot|#39);/g,xe=/[&<>"']/g,Ee=RegExp(we.source),Ae=RegExp(xe.source),je=/<%-([\s\S]+?)%>/g,Ne=/<%([\s\S]+?)%>/g,Ce=/<%=([\s\S]+?)%>/g,Oe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Te=/^\w*$/,Re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Me=/[\\^$.*+?()[\]{}|]/g,Ie=RegExp(Me.source),ke=/^\s+|\s+$/g,Le=/^\s+/,De=/\s+$/,Fe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Pe=/\{\n\/\* \[wrapped with (.+)\] \*/,Ue=/,? & /,ze=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Be=/\\(\\)?/g,He=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qe=/\w*$/,$e=/^[-+]0x[0-9a-f]+$/i,Ge=/^0b[01]+$/i,We=/^\[object .+?Constructor\]$/,Je=/^0o[0-7]+$/i,Ye=/^(?:0|[1-9]\d*)$/,Xe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ve=/($^)/,Qe=/['\n\r\u2028\u2029\\]/g,Ze="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ke="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",et="[\\ud800-\\udfff]",tt="["+Ke+"]",nt="["+Ze+"]",rt="\\d+",it="[\\u2700-\\u27bf]",st="[a-z\\xdf-\\xf6\\xf8-\\xff]",ot="[^\\ud800-\\udfff"+Ke+rt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",at="\\ud83c[\\udffb-\\udfff]",ct="[^\\ud800-\\udfff]",ut="(?:\\ud83c[\\udde6-\\uddff]){2}",lt="[\\ud800-\\udbff][\\udc00-\\udfff]",dt="[A-Z\\xc0-\\xd6\\xd8-\\xde]",ht="(?:"+st+"|"+ot+")",ft="(?:"+dt+"|"+ot+")",pt="(?:"+nt+"|"+at+")"+"?",gt="[\\ufe0e\\ufe0f]?"+pt+("(?:\\u200d(?:"+[ct,ut,lt].join("|")+")[\\ufe0e\\ufe0f]?"+pt+")*"),mt="(?:"+[it,ut,lt].join("|")+")"+gt,_t="(?:"+[ct+nt+"?",nt,ut,lt,et].join("|")+")",vt=RegExp("['’]","g"),bt=RegExp(nt,"g"),yt=RegExp(at+"(?="+at+")|"+_t+gt,"g"),St=RegExp([dt+"?"+st+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[tt,dt,"$"].join("|")+")",ft+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[tt,dt+ht,"$"].join("|")+")",dt+"?"+ht+"+(?:['’](?:d|ll|m|re|s|t|ve))?",dt+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rt,mt].join("|"),"g"),wt=RegExp("[\\u200d\\ud800-\\udfff"+Ze+"\\ufe0e\\ufe0f]"),xt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Et=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],At=-1,jt={};jt[le]=jt[de]=jt[he]=jt[fe]=jt[pe]=jt[ge]=jt[me]=jt[_e]=jt[ve]=!0,jt[B]=jt[H]=jt[ce]=jt[$]=jt[ue]=jt[G]=jt[J]=jt[Y]=jt[V]=jt[Q]=jt[K]=jt[te]=jt[ne]=jt[re]=jt[oe]=!1;var Nt={};Nt[B]=Nt[H]=Nt[ce]=Nt[ue]=Nt[$]=Nt[G]=Nt[le]=Nt[de]=Nt[he]=Nt[fe]=Nt[pe]=Nt[V]=Nt[Q]=Nt[K]=Nt[te]=Nt[ne]=Nt[re]=Nt[ie]=Nt[ge]=Nt[me]=Nt[_e]=Nt[ve]=!0,Nt[J]=Nt[Y]=Nt[oe]=!1;var Ct={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ot=parseFloat,Tt=parseInt,Rt="object"==typeof e&&e&&e.Object===Object&&e,Mt="object"==typeof self&&self&&self.Object===Object&&self,It=Rt||Mt||Function("return this")(),kt=t&&!t.nodeType&&t,Lt=kt&&"object"==typeof r&&r&&!r.nodeType&&r,Dt=Lt&&Lt.exports===kt,Ft=Dt&&Rt.process,Pt=function(){try{var e=Lt&&Lt.require&&Lt.require("util").types;return e||Ft&&Ft.binding&&Ft.binding("util")}catch(e){}}(),Ut=Pt&&Pt.isArrayBuffer,zt=Pt&&Pt.isDate,Bt=Pt&&Pt.isMap,Ht=Pt&&Pt.isRegExp,qt=Pt&&Pt.isSet,$t=Pt&&Pt.isTypedArray;function Gt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Wt(e,t,n,r){for(var i=-1,s=null==e?0:e.length;++i<s;){var o=e[i];t(r,o,n(o),e)}return r}function Jt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Yt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Xt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Vt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,s=[];++n<r;){var o=e[n];t(o,n,e)&&(s[i++]=o)}return s}function Qt(e,t){return!!(null==e?0:e.length)&&cn(e,t,0)>-1}function Zt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Kt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function en(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function tn(e,t,n,r){var i=-1,s=null==e?0:e.length;for(r&&s&&(n=e[++i]);++i<s;)n=t(n,e[i],i,e);return n}function nn(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function rn(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var sn=hn("length");function on(e,t,n){var r;return n(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function an(e,t,n,r){for(var i=e.length,s=n+(r?1:-1);r?s--:++s<i;)if(t(e[s],s,e))return s;return-1}function cn(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):an(e,ln,n)}function un(e,t,n,r){for(var i=n-1,s=e.length;++i<s;)if(r(e[i],t))return i;return-1}function ln(e){return e!=e}function dn(e,t){var n=null==e?0:e.length;return n?gn(e,t)/n:D}function hn(e){return function(t){return null==t?s:t[e]}}function fn(e){return function(t){return null==e?s:e[t]}}function pn(e,t,n,r,i){return i(e,function(e,i,s){n=r?(r=!1,e):t(n,e,i,s)}),n}function gn(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);o!==s&&(n=n===s?o:n+o)}return n}function mn(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function _n(e){return function(t){return e(t)}}function vn(e,t){return Kt(t,function(t){return e[t]})}function bn(e,t){return e.has(t)}function yn(e,t){for(var n=-1,r=e.length;++n<r&&cn(t,e[n],0)>-1;);return n}function Sn(e,t){for(var n=e.length;n--&&cn(t,e[n],0)>-1;);return n}var wn=fn({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),xn=fn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function En(e){return"\\"+Ct[e]}function An(e){return wt.test(e)}function jn(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function Nn(e,t){return function(n){return e(t(n))}}function Cn(e,t){for(var n=-1,r=e.length,i=0,s=[];++n<r;){var o=e[n];o!==t&&o!==d||(e[n]=d,s[i++]=n)}return s}function On(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function Tn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function Rn(e){return An(e)?function(e){var t=yt.lastIndex=0;for(;yt.test(e);)++t;return t}(e):sn(e)}function Mn(e){return An(e)?function(e){return e.match(yt)||[]}(e):function(e){return e.split("")}(e)}var In=fn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var kn=function e(t){var n,r=(t=null==t?It:kn.defaults(It.Object(),t,kn.pick(It,Et))).Array,i=t.Date,Ze=t.Error,Ke=t.Function,et=t.Math,tt=t.Object,nt=t.RegExp,rt=t.String,it=t.TypeError,st=r.prototype,ot=Ke.prototype,at=tt.prototype,ct=t["__core-js_shared__"],ut=ot.toString,lt=at.hasOwnProperty,dt=0,ht=(n=/[^.]+$/.exec(ct&&ct.keys&&ct.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",ft=at.toString,pt=ut.call(tt),gt=It._,mt=nt("^"+ut.call(lt).replace(Me,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_t=Dt?t.Buffer:s,yt=t.Symbol,wt=t.Uint8Array,Ct=_t?_t.allocUnsafe:s,Rt=Nn(tt.getPrototypeOf,tt),Mt=tt.create,kt=at.propertyIsEnumerable,Lt=st.splice,Ft=yt?yt.isConcatSpreadable:s,Pt=yt?yt.iterator:s,sn=yt?yt.toStringTag:s,fn=function(){try{var e=Ps(tt,"defineProperty");return e({},"",{}),e}catch(e){}}(),Ln=t.clearTimeout!==It.clearTimeout&&t.clearTimeout,Dn=i&&i.now!==It.Date.now&&i.now,Fn=t.setTimeout!==It.setTimeout&&t.setTimeout,Pn=et.ceil,Un=et.floor,zn=tt.getOwnPropertySymbols,Bn=_t?_t.isBuffer:s,Hn=t.isFinite,qn=st.join,$n=Nn(tt.keys,tt),Gn=et.max,Wn=et.min,Jn=i.now,Yn=t.parseInt,Xn=et.random,Vn=st.reverse,Qn=Ps(t,"DataView"),Zn=Ps(t,"Map"),Kn=Ps(t,"Promise"),er=Ps(t,"Set"),tr=Ps(t,"WeakMap"),nr=Ps(tt,"create"),rr=tr&&new tr,ir={},sr=lo(Qn),or=lo(Zn),ar=lo(Kn),cr=lo(er),ur=lo(tr),lr=yt?yt.prototype:s,dr=lr?lr.valueOf:s,hr=lr?lr.toString:s;function fr(e){if(Ca(e)&&!_a(e)&&!(e instanceof _r)){if(e instanceof mr)return e;if(lt.call(e,"__wrapped__"))return ho(e)}return new mr(e)}var pr=function(){function e(){}return function(t){if(!Na(t))return{};if(Mt)return Mt(t);e.prototype=t;var n=new e;return e.prototype=s,n}}();function gr(){}function mr(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=s}function _r(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=F,this.__views__=[]}function vr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function br(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function yr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Sr(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new yr;++t<n;)this.add(e[t])}function wr(e){var t=this.__data__=new br(e);this.size=t.size}function xr(e,t){var n=_a(e),r=!n&&ma(e),i=!n&&!r&&Sa(e),s=!n&&!r&&!i&&Da(e),o=n||r||i||s,a=o?mn(e.length,rt):[],c=a.length;for(var u in e)!t&&!lt.call(e,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Gs(u,c))||a.push(u);return a}function Er(e){var t=e.length;return t?e[Si(0,t-1)]:s}function Ar(e,t){return ao(ns(e),kr(t,0,e.length))}function jr(e){return ao(ns(e))}function Nr(e,t,n){(n===s||fa(e[t],n))&&(n!==s||t in e)||Mr(e,t,n)}function Cr(e,t,n){var r=e[t];lt.call(e,t)&&fa(r,n)&&(n!==s||t in e)||Mr(e,t,n)}function Or(e,t){for(var n=e.length;n--;)if(fa(e[n][0],t))return n;return-1}function Tr(e,t,n,r){return Ur(e,function(e,i,s){t(r,e,n(e),s)}),r}function Rr(e,t){return e&&rs(t,ic(t),e)}function Mr(e,t,n){"__proto__"==t&&fn?fn(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Ir(e,t){for(var n=-1,i=t.length,o=r(i),a=null==e;++n<i;)o[n]=a?s:Ka(e,t[n]);return o}function kr(e,t,n){return e==e&&(n!==s&&(e=e<=n?e:n),t!==s&&(e=e>=t?e:t)),e}function Lr(e,t,n,r,i,o){var a,c=t&h,u=t&f,l=t&p;if(n&&(a=i?n(e,r,i,o):n(e)),a!==s)return a;if(!Na(e))return e;var d=_a(e);if(d){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&lt.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!c)return ns(e,a)}else{var g=Bs(e),m=g==Y||g==X;if(Sa(e))return Vi(e,c);if(g==K||g==B||m&&!i){if(a=u||m?{}:qs(e),!c)return u?function(e,t){return rs(e,zs(e),t)}(e,function(e,t){return e&&rs(t,sc(t),e)}(a,e)):function(e,t){return rs(e,Us(e),t)}(e,Rr(a,e))}else{if(!Nt[g])return i?e:{};a=function(e,t,n){var r,i=e.constructor;switch(t){case ce:return Qi(e);case $:case G:return new i(+e);case ue:return function(e,t){var n=t?Qi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case le:case de:case he:case fe:case pe:case ge:case me:case _e:case ve:return Zi(e,n);case V:return new i;case Q:case re:return new i(e);case te:return function(e){var t=new e.constructor(e.source,qe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case ne:return new i;case ie:return r=e,dr?tt(dr.call(r)):{}}}(e,g,c)}}o||(o=new wr);var _=o.get(e);if(_)return _;o.set(e,a),Ia(e)?e.forEach(function(r){a.add(Lr(r,t,n,r,e,o))}):Oa(e)&&e.forEach(function(r,i){a.set(i,Lr(r,t,n,i,e,o))});var v=d?s:(l?u?Rs:Ts:u?sc:ic)(e);return Jt(v||e,function(r,i){v&&(r=e[i=r]),Cr(a,i,Lr(r,t,n,i,e,o))}),a}function Dr(e,t,n){var r=n.length;if(null==e)return!r;for(e=tt(e);r--;){var i=n[r],o=t[i],a=e[i];if(a===s&&!(i in e)||!o(a))return!1}return!0}function Fr(e,t,n){if("function"!=typeof e)throw new it(c);return ro(function(){e.apply(s,n)},t)}function Pr(e,t,n,r){var i=-1,s=Qt,a=!0,c=e.length,u=[],l=t.length;if(!c)return u;n&&(t=Kt(t,_n(n))),r?(s=Zt,a=!1):t.length>=o&&(s=bn,a=!1,t=new Sr(t));e:for(;++i<c;){var d=e[i],h=null==n?d:n(d);if(d=r||0!==d?d:0,a&&h==h){for(var f=l;f--;)if(t[f]===h)continue e;u.push(d)}else s(t,h,r)||u.push(d)}return u}fr.templateSettings={escape:je,evaluate:Ne,interpolate:Ce,variable:"",imports:{_:fr}},fr.prototype=gr.prototype,fr.prototype.constructor=fr,mr.prototype=pr(gr.prototype),mr.prototype.constructor=mr,_r.prototype=pr(gr.prototype),_r.prototype.constructor=_r,vr.prototype.clear=function(){this.__data__=nr?nr(null):{},this.size=0},vr.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},vr.prototype.get=function(e){var t=this.__data__;if(nr){var n=t[e];return n===u?s:n}return lt.call(t,e)?t[e]:s},vr.prototype.has=function(e){var t=this.__data__;return nr?t[e]!==s:lt.call(t,e)},vr.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=nr&&t===s?u:t,this},br.prototype.clear=function(){this.__data__=[],this.size=0},br.prototype.delete=function(e){var t=this.__data__,n=Or(t,e);return!(n<0||(n==t.length-1?t.pop():Lt.call(t,n,1),--this.size,0))},br.prototype.get=function(e){var t=this.__data__,n=Or(t,e);return n<0?s:t[n][1]},br.prototype.has=function(e){return Or(this.__data__,e)>-1},br.prototype.set=function(e,t){var n=this.__data__,r=Or(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},yr.prototype.clear=function(){this.size=0,this.__data__={hash:new vr,map:new(Zn||br),string:new vr}},yr.prototype.delete=function(e){var t=Ds(this,e).delete(e);return this.size-=t?1:0,t},yr.prototype.get=function(e){return Ds(this,e).get(e)},yr.prototype.has=function(e){return Ds(this,e).has(e)},yr.prototype.set=function(e,t){var n=Ds(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Sr.prototype.add=Sr.prototype.push=function(e){return this.__data__.set(e,u),this},Sr.prototype.has=function(e){return this.__data__.has(e)},wr.prototype.clear=function(){this.__data__=new br,this.size=0},wr.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},wr.prototype.get=function(e){return this.__data__.get(e)},wr.prototype.has=function(e){return this.__data__.has(e)},wr.prototype.set=function(e,t){var n=this.__data__;if(n instanceof br){var r=n.__data__;if(!Zn||r.length<o-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new yr(r)}return n.set(e,t),this.size=n.size,this};var Ur=os(Jr),zr=os(Yr,!0);function Br(e,t){var n=!0;return Ur(e,function(e,r,i){return n=!!t(e,r,i)}),n}function Hr(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=t(o);if(null!=a&&(c===s?a==a&&!La(a):n(a,c)))var c=a,u=o}return u}function qr(e,t){var n=[];return Ur(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function $r(e,t,n,r,i){var s=-1,o=e.length;for(n||(n=$s),i||(i=[]);++s<o;){var a=e[s];t>0&&n(a)?t>1?$r(a,t-1,n,r,i):en(i,a):r||(i[i.length]=a)}return i}var Gr=as(),Wr=as(!0);function Jr(e,t){return e&&Gr(e,t,ic)}function Yr(e,t){return e&&Wr(e,t,ic)}function Xr(e,t){return Vt(t,function(t){return Ea(e[t])})}function Vr(e,t){for(var n=0,r=(t=Wi(t,e)).length;null!=e&&n<r;)e=e[uo(t[n++])];return n&&n==r?e:s}function Qr(e,t,n){var r=t(e);return _a(e)?r:en(r,n(e))}function Zr(e){return null==e?e===s?se:Z:sn&&sn in tt(e)?function(e){var t=lt.call(e,sn),n=e[sn];try{e[sn]=s;var r=!0}catch(e){}var i=ft.call(e);return r&&(t?e[sn]=n:delete e[sn]),i}(e):function(e){return ft.call(e)}(e)}function Kr(e,t){return e>t}function ei(e,t){return null!=e&&lt.call(e,t)}function ti(e,t){return null!=e&&t in tt(e)}function ni(e,t,n){for(var i=n?Zt:Qt,o=e[0].length,a=e.length,c=a,u=r(a),l=1/0,d=[];c--;){var h=e[c];c&&t&&(h=Kt(h,_n(t))),l=Wn(h.length,l),u[c]=!n&&(t||o>=120&&h.length>=120)?new Sr(c&&h):s}h=e[0];var f=-1,p=u[0];e:for(;++f<o&&d.length<l;){var g=h[f],m=t?t(g):g;if(g=n||0!==g?g:0,!(p?bn(p,m):i(d,m,n))){for(c=a;--c;){var _=u[c];if(!(_?bn(_,m):i(e[c],m,n)))continue e}p&&p.push(m),d.push(g)}}return d}function ri(e,t,n){var r=null==(e=eo(e,t=Wi(t,e)))?e:e[uo(xo(t))];return null==r?s:Gt(r,e,n)}function ii(e){return Ca(e)&&Zr(e)==B}function si(e,t,n,r,i){return e===t||(null==e||null==t||!Ca(e)&&!Ca(t)?e!=e&&t!=t:function(e,t,n,r,i,o){var a=_a(e),c=_a(t),u=a?H:Bs(e),l=c?H:Bs(t),d=(u=u==B?K:u)==K,h=(l=l==B?K:l)==K,f=u==l;if(f&&Sa(e)){if(!Sa(t))return!1;a=!0,d=!1}if(f&&!d)return o||(o=new wr),a||Da(e)?Cs(e,t,n,r,i,o):function(e,t,n,r,i,s,o){switch(n){case ue:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ce:return!(e.byteLength!=t.byteLength||!s(new wt(e),new wt(t)));case $:case G:case Q:return fa(+e,+t);case J:return e.name==t.name&&e.message==t.message;case te:case re:return e==t+"";case V:var a=jn;case ne:var c=r&g;if(a||(a=On),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;r|=m,o.set(e,t);var l=Cs(a(e),a(t),r,i,s,o);return o.delete(e),l;case ie:if(dr)return dr.call(e)==dr.call(t)}return!1}(e,t,u,n,r,i,o);if(!(n&g)){var p=d&&lt.call(e,"__wrapped__"),_=h&&lt.call(t,"__wrapped__");if(p||_){var v=p?e.value():e,b=_?t.value():t;return o||(o=new wr),i(v,b,n,r,o)}}return!!f&&(o||(o=new wr),function(e,t,n,r,i,o){var a=n&g,c=Ts(e),u=c.length,l=Ts(t).length;if(u!=l&&!a)return!1;for(var d=u;d--;){var h=c[d];if(!(a?h in t:lt.call(t,h)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var p=!0;o.set(e,t),o.set(t,e);for(var m=a;++d<u;){h=c[d];var _=e[h],v=t[h];if(r)var b=a?r(v,_,h,t,e,o):r(_,v,h,e,t,o);if(!(b===s?_===v||i(_,v,n,r,o):b)){p=!1;break}m||(m="constructor"==h)}if(p&&!m){var y=e.constructor,S=t.constructor;y!=S&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof S&&S instanceof S)&&(p=!1)}return o.delete(e),o.delete(t),p}(e,t,n,r,i,o))}(e,t,n,r,si,i))}function oi(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=tt(e);i--;){var c=n[i];if(a&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++i<o;){var u=(c=n[i])[0],l=e[u],d=c[1];if(a&&c[2]){if(l===s&&!(u in e))return!1}else{var h=new wr;if(r)var f=r(l,d,u,e,t,h);if(!(f===s?si(d,l,g|m,r,h):f))return!1}}return!0}function ai(e){return!(!Na(e)||(t=e,ht&&ht in t))&&(Ea(e)?mt:We).test(lo(e));var t}function ci(e){return"function"==typeof e?e:null==e?Tc:"object"==typeof e?_a(e)?pi(e[0],e[1]):fi(e):Uc(e)}function ui(e){if(!Vs(e))return $n(e);var t=[];for(var n in tt(e))lt.call(e,n)&&"constructor"!=n&&t.push(n);return t}function li(e){if(!Na(e))return function(e){var t=[];if(null!=e)for(var n in tt(e))t.push(n);return t}(e);var t=Vs(e),n=[];for(var r in e)("constructor"!=r||!t&&lt.call(e,r))&&n.push(r);return n}function di(e,t){return e<t}function hi(e,t){var n=-1,i=ba(e)?r(e.length):[];return Ur(e,function(e,r,s){i[++n]=t(e,r,s)}),i}function fi(e){var t=Fs(e);return 1==t.length&&t[0][2]?Zs(t[0][0],t[0][1]):function(n){return n===e||oi(n,e,t)}}function pi(e,t){return Js(e)&&Qs(t)?Zs(uo(e),t):function(n){var r=Ka(n,e);return r===s&&r===t?ec(n,e):si(t,r,g|m)}}function gi(e,t,n,r,i){e!==t&&Gr(t,function(o,a){if(i||(i=new wr),Na(o))!function(e,t,n,r,i,o,a){var c=to(e,n),u=to(t,n),l=a.get(u);if(l)Nr(e,n,l);else{var d=o?o(c,u,n+"",e,t,a):s,h=d===s;if(h){var f=_a(u),p=!f&&Sa(u),g=!f&&!p&&Da(u);d=u,f||p||g?_a(c)?d=c:ya(c)?d=ns(c):p?(h=!1,d=Vi(u,!0)):g?(h=!1,d=Zi(u,!0)):d=[]:Ra(u)||ma(u)?(d=c,ma(c)?d=$a(c):Na(c)&&!Ea(c)||(d=qs(u))):h=!1}h&&(a.set(u,d),i(d,u,r,o,a),a.delete(u)),Nr(e,n,d)}}(e,t,a,n,gi,r,i);else{var c=r?r(to(e,a),o,a+"",e,t,i):s;c===s&&(c=o),Nr(e,a,c)}},sc)}function mi(e,t){var n=e.length;if(n)return Gs(t+=t<0?n:0,n)?e[t]:s}function _i(e,t,n){var r=-1;return t=Kt(t.length?t:[Tc],_n(Ls())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(hi(e,function(e,n,i){return{criteria:Kt(t,function(t){return t(e)}),index:++r,value:e}}),function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,s=t.criteria,o=i.length,a=n.length;++r<o;){var c=Ki(i[r],s[r]);if(c){if(r>=a)return c;var u=n[r];return c*("desc"==u?-1:1)}}return e.index-t.index}(e,t,n)})}function vi(e,t,n){for(var r=-1,i=t.length,s={};++r<i;){var o=t[r],a=Vr(e,o);n(a,o)&&ji(s,Wi(o,e),a)}return s}function bi(e,t,n,r){var i=r?un:cn,s=-1,o=t.length,a=e;for(e===t&&(t=ns(t)),n&&(a=Kt(e,_n(n)));++s<o;)for(var c=0,u=t[s],l=n?n(u):u;(c=i(a,l,c,r))>-1;)a!==e&&Lt.call(a,c,1),Lt.call(e,c,1);return e}function yi(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==s){var s=i;Gs(i)?Lt.call(e,i,1):Pi(e,i)}}return e}function Si(e,t){return e+Un(Xn()*(t-e+1))}function wi(e,t){var n="";if(!e||t<1||t>k)return n;do{t%2&&(n+=e),(t=Un(t/2))&&(e+=e)}while(t);return n}function xi(e,t){return io(Ks(e,t,Tc),e+"")}function Ei(e){return Er(fc(e))}function Ai(e,t){var n=fc(e);return ao(n,kr(t,0,n.length))}function ji(e,t,n,r){if(!Na(e))return e;for(var i=-1,o=(t=Wi(t,e)).length,a=o-1,c=e;null!=c&&++i<o;){var u=uo(t[i]),l=n;if(i!=a){var d=c[u];(l=r?r(d,u,c):s)===s&&(l=Na(d)?d:Gs(t[i+1])?[]:{})}Cr(c,u,l),c=c[u]}return e}var Ni=rr?function(e,t){return rr.set(e,t),e}:Tc,Ci=fn?function(e,t){return fn(e,"toString",{configurable:!0,enumerable:!1,value:Nc(t),writable:!0})}:Tc;function Oi(e){return ao(fc(e))}function Ti(e,t,n){var i=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(n=n>s?s:n)<0&&(n+=s),s=t>n?0:n-t>>>0,t>>>=0;for(var o=r(s);++i<s;)o[i]=e[i+t];return o}function Ri(e,t){var n;return Ur(e,function(e,r,i){return!(n=t(e,r,i))}),!!n}function Mi(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=U){for(;r<i;){var s=r+i>>>1,o=e[s];null!==o&&!La(o)&&(n?o<=t:o<t)?r=s+1:i=s}return i}return Ii(e,t,Tc,n)}function Ii(e,t,n,r){t=n(t);for(var i=0,o=null==e?0:e.length,a=t!=t,c=null===t,u=La(t),l=t===s;i<o;){var d=Un((i+o)/2),h=n(e[d]),f=h!==s,p=null===h,g=h==h,m=La(h);if(a)var _=r||g;else _=l?g&&(r||f):c?g&&f&&(r||!p):u?g&&f&&!p&&(r||!m):!p&&!m&&(r?h<=t:h<t);_?i=d+1:o=d}return Wn(o,P)}function ki(e,t){for(var n=-1,r=e.length,i=0,s=[];++n<r;){var o=e[n],a=t?t(o):o;if(!n||!fa(a,c)){var c=a;s[i++]=0===o?0:o}}return s}function Li(e){return"number"==typeof e?e:La(e)?D:+e}function Di(e){if("string"==typeof e)return e;if(_a(e))return Kt(e,Di)+"";if(La(e))return hr?hr.call(e):"";var t=e+"";return"0"==t&&1/e==-I?"-0":t}function Fi(e,t,n){var r=-1,i=Qt,s=e.length,a=!0,c=[],u=c;if(n)a=!1,i=Zt;else if(s>=o){var l=t?null:ws(e);if(l)return On(l);a=!1,i=bn,u=new Sr}else u=t?[]:c;e:for(;++r<s;){var d=e[r],h=t?t(d):d;if(d=n||0!==d?d:0,a&&h==h){for(var f=u.length;f--;)if(u[f]===h)continue e;t&&u.push(h),c.push(d)}else i(u,h,n)||(u!==c&&u.push(h),c.push(d))}return c}function Pi(e,t){return null==(e=eo(e,t=Wi(t,e)))||delete e[uo(xo(t))]}function Ui(e,t,n,r){return ji(e,t,n(Vr(e,t)),r)}function zi(e,t,n,r){for(var i=e.length,s=r?i:-1;(r?s--:++s<i)&&t(e[s],s,e););return n?Ti(e,r?0:s,r?s+1:i):Ti(e,r?s+1:0,r?i:s)}function Bi(e,t){var n=e;return n instanceof _r&&(n=n.value()),tn(t,function(e,t){return t.func.apply(t.thisArg,en([e],t.args))},n)}function Hi(e,t,n){var i=e.length;if(i<2)return i?Fi(e[0]):[];for(var s=-1,o=r(i);++s<i;)for(var a=e[s],c=-1;++c<i;)c!=s&&(o[s]=Pr(o[s]||a,e[c],t,n));return Fi($r(o,1),t,n)}function qi(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var c=r<o?t[r]:s;n(a,e[r],c)}return a}function $i(e){return ya(e)?e:[]}function Gi(e){return"function"==typeof e?e:Tc}function Wi(e,t){return _a(e)?e:Js(e,t)?[e]:co(Ga(e))}var Ji=xi;function Yi(e,t,n){var r=e.length;return n=n===s?r:n,!t&&n>=r?e:Ti(e,t,n)}var Xi=Ln||function(e){return It.clearTimeout(e)};function Vi(e,t){if(t)return e.slice();var n=e.length,r=Ct?Ct(n):new e.constructor(n);return e.copy(r),r}function Qi(e){var t=new e.constructor(e.byteLength);return new wt(t).set(new wt(e)),t}function Zi(e,t){var n=t?Qi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ki(e,t){if(e!==t){var n=e!==s,r=null===e,i=e==e,o=La(e),a=t!==s,c=null===t,u=t==t,l=La(t);if(!c&&!l&&!o&&e>t||o&&a&&u&&!c&&!l||r&&a&&u||!n&&u||!i)return 1;if(!r&&!o&&!l&&e<t||l&&n&&i&&!r&&!o||c&&n&&i||!a&&i||!u)return-1}return 0}function es(e,t,n,i){for(var s=-1,o=e.length,a=n.length,c=-1,u=t.length,l=Gn(o-a,0),d=r(u+l),h=!i;++c<u;)d[c]=t[c];for(;++s<a;)(h||s<o)&&(d[n[s]]=e[s]);for(;l--;)d[c++]=e[s++];return d}function ts(e,t,n,i){for(var s=-1,o=e.length,a=-1,c=n.length,u=-1,l=t.length,d=Gn(o-c,0),h=r(d+l),f=!i;++s<d;)h[s]=e[s];for(var p=s;++u<l;)h[p+u]=t[u];for(;++a<c;)(f||s<o)&&(h[p+n[a]]=e[s++]);return h}function ns(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function rs(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var c=t[o],u=r?r(n[c],e[c],c,n,e):s;u===s&&(u=e[c]),i?Mr(n,c,u):Cr(n,c,u)}return n}function is(e,t){return function(n,r){var i=_a(n)?Wt:Tr,s=t?t():{};return i(n,e,Ls(r,2),s)}}function ss(e){return xi(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:s,a=i>2?n[2]:s;for(o=e.length>3&&"function"==typeof o?(i--,o):s,a&&Ws(n[0],n[1],a)&&(o=i<3?s:o,i=1),t=tt(t);++r<i;){var c=n[r];c&&e(t,c,r,o)}return t})}function os(e,t){return function(n,r){if(null==n)return n;if(!ba(n))return e(n,r);for(var i=n.length,s=t?i:-1,o=tt(n);(t?s--:++s<i)&&!1!==r(o[s],s,o););return n}}function as(e){return function(t,n,r){for(var i=-1,s=tt(t),o=r(t),a=o.length;a--;){var c=o[e?a:++i];if(!1===n(s[c],c,s))break}return t}}function cs(e){return function(t){var n=An(t=Ga(t))?Mn(t):s,r=n?n[0]:t.charAt(0),i=n?Yi(n,1).join(""):t.slice(1);return r[e]()+i}}function us(e){return function(t){return tn(Ec(mc(t).replace(vt,"")),e,"")}}function ls(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=pr(e.prototype),r=e.apply(n,t);return Na(r)?r:n}}function ds(e){return function(t,n,r){var i=tt(t);if(!ba(t)){var o=Ls(n,3);t=ic(t),n=function(e){return o(i[e],e,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:s}}function hs(e){return Os(function(t){var n=t.length,r=n,i=mr.prototype.thru;for(e&&t.reverse();r--;){var o=t[r];if("function"!=typeof o)throw new it(c);if(i&&!a&&"wrapper"==Is(o))var a=new mr([],!0)}for(r=a?r:n;++r<n;){var u=Is(o=t[r]),l="wrapper"==u?Ms(o):s;a=l&&Ys(l[0])&&l[1]==(E|y|w|A)&&!l[4].length&&1==l[9]?a[Is(l[0])].apply(a,l[3]):1==o.length&&Ys(o)?a[u]():a.thru(o)}return function(){var e=arguments,r=e[0];if(a&&1==e.length&&_a(r))return a.plant(r).value();for(var i=0,s=n?t[i].apply(this,e):r;++i<n;)s=t[i].call(this,s);return s}})}function fs(e,t,n,i,o,a,c,u,l,d){var h=t&E,f=t&_,p=t&v,g=t&(y|S),m=t&j,b=p?s:ls(e);return function _(){for(var v=arguments.length,y=r(v),S=v;S--;)y[S]=arguments[S];if(g)var w=ks(_),x=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(y,w);if(i&&(y=es(y,i,o,g)),a&&(y=ts(y,a,c,g)),v-=x,g&&v<d){var E=Cn(y,w);return ys(e,t,fs,_.placeholder,n,y,E,u,l,d-v)}var A=f?n:this,j=p?A[e]:e;return v=y.length,u?y=function(e,t){for(var n=e.length,r=Wn(t.length,n),i=ns(e);r--;){var o=t[r];e[r]=Gs(o,n)?i[o]:s}return e}(y,u):m&&v>1&&y.reverse(),h&&l<v&&(y.length=l),this&&this!==It&&this instanceof _&&(j=b||ls(j)),j.apply(A,y)}}function ps(e,t){return function(n,r){return function(e,t,n,r){return Jr(e,function(e,i,s){t(r,n(e),i,s)}),r}(n,e,t(r),{})}}function gs(e,t){return function(n,r){var i;if(n===s&&r===s)return t;if(n!==s&&(i=n),r!==s){if(i===s)return r;"string"==typeof n||"string"==typeof r?(n=Di(n),r=Di(r)):(n=Li(n),r=Li(r)),i=e(n,r)}return i}}function ms(e){return Os(function(t){return t=Kt(t,_n(Ls())),xi(function(n){var r=this;return e(t,function(e){return Gt(e,r,n)})})})}function _s(e,t){var n=(t=t===s?" ":Di(t)).length;if(n<2)return n?wi(t,e):t;var r=wi(t,Pn(e/Rn(t)));return An(t)?Yi(Mn(r),0,e).join(""):r.slice(0,e)}function vs(e){return function(t,n,i){return i&&"number"!=typeof i&&Ws(t,n,i)&&(n=i=s),t=za(t),n===s?(n=t,t=0):n=za(n),function(e,t,n,i){for(var s=-1,o=Gn(Pn((t-e)/(n||1)),0),a=r(o);o--;)a[i?o:++s]=e,e+=n;return a}(t,n,i=i===s?t<n?1:-1:za(i),e)}}function bs(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=qa(t),n=qa(n)),e(t,n)}}function ys(e,t,n,r,i,o,a,c,u,l){var d=t&y;t|=d?w:x,(t&=~(d?x:w))&b||(t&=~(_|v));var h=[e,t,i,d?o:s,d?a:s,d?s:o,d?s:a,c,u,l],f=n.apply(s,h);return Ys(e)&&no(f,h),f.placeholder=r,so(f,e,t)}function Ss(e){var t=et[e];return function(e,n){if(e=qa(e),(n=null==n?0:Wn(Ba(n),292))&&Hn(e)){var r=(Ga(e)+"e").split("e");return+((r=(Ga(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var ws=er&&1/On(new er([,-0]))[1]==I?function(e){return new er(e)}:Lc;function xs(e){return function(t){var n=Bs(t);return n==V?jn(t):n==ne?Tn(t):function(e,t){return Kt(t,function(t){return[t,e[t]]})}(t,e(t))}}function Es(e,t,n,i,o,a,u,l){var h=t&v;if(!h&&"function"!=typeof e)throw new it(c);var f=i?i.length:0;if(f||(t&=~(w|x),i=o=s),u=u===s?u:Gn(Ba(u),0),l=l===s?l:Ba(l),f-=o?o.length:0,t&x){var p=i,g=o;i=o=s}var m=h?s:Ms(e),j=[e,t,n,i,o,p,g,a,u,l];if(m&&function(e,t){var n=e[1],r=t[1],i=n|r,s=i<(_|v|E),o=r==E&&n==y||r==E&&n==A&&e[7].length<=t[8]||r==(E|A)&&t[7].length<=t[8]&&n==y;if(!s&&!o)return e;r&_&&(e[2]=t[2],i|=n&_?0:b);var a=t[3];if(a){var c=e[3];e[3]=c?es(c,a,t[4]):a,e[4]=c?Cn(e[3],d):t[4]}(a=t[5])&&(c=e[5],e[5]=c?ts(c,a,t[6]):a,e[6]=c?Cn(e[5],d):t[6]),(a=t[7])&&(e[7]=a),r&E&&(e[8]=null==e[8]?t[8]:Wn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(j,m),e=j[0],t=j[1],n=j[2],i=j[3],o=j[4],!(l=j[9]=j[9]===s?h?0:e.length:Gn(j[9]-f,0))&&t&(y|S)&&(t&=~(y|S)),t&&t!=_)N=t==y||t==S?function(e,t,n){var i=ls(e);return function o(){for(var a=arguments.length,c=r(a),u=a,l=ks(o);u--;)c[u]=arguments[u];var d=a<3&&c[0]!==l&&c[a-1]!==l?[]:Cn(c,l);return(a-=d.length)<n?ys(e,t,fs,o.placeholder,s,c,d,s,s,n-a):Gt(this&&this!==It&&this instanceof o?i:e,this,c)}}(e,t,l):t!=w&&t!=(_|w)||o.length?fs.apply(s,j):function(e,t,n,i){var s=t&_,o=ls(e);return function t(){for(var a=-1,c=arguments.length,u=-1,l=i.length,d=r(l+c),h=this&&this!==It&&this instanceof t?o:e;++u<l;)d[u]=i[u];for(;c--;)d[u++]=arguments[++a];return Gt(h,s?n:this,d)}}(e,t,n,i);else var N=function(e,t,n){var r=t&_,i=ls(e);return function t(){return(this&&this!==It&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return so((m?Ni:no)(N,j),e,t)}function As(e,t,n,r){return e===s||fa(e,at[n])&&!lt.call(r,n)?t:e}function js(e,t,n,r,i,o){return Na(e)&&Na(t)&&(o.set(t,e),gi(e,t,s,js,o),o.delete(t)),e}function Ns(e){return Ra(e)?s:e}function Cs(e,t,n,r,i,o){var a=n&g,c=e.length,u=t.length;if(c!=u&&!(a&&u>c))return!1;var l=o.get(e);if(l&&o.get(t))return l==t;var d=-1,h=!0,f=n&m?new Sr:s;for(o.set(e,t),o.set(t,e);++d<c;){var p=e[d],_=t[d];if(r)var v=a?r(_,p,d,t,e,o):r(p,_,d,e,t,o);if(v!==s){if(v)continue;h=!1;break}if(f){if(!rn(t,function(e,t){if(!bn(f,t)&&(p===e||i(p,e,n,r,o)))return f.push(t)})){h=!1;break}}else if(p!==_&&!i(p,_,n,r,o)){h=!1;break}}return o.delete(e),o.delete(t),h}function Os(e){return io(Ks(e,s,vo),e+"")}function Ts(e){return Qr(e,ic,Us)}function Rs(e){return Qr(e,sc,zs)}var Ms=rr?function(e){return rr.get(e)}:Lc;function Is(e){for(var t=e.name+"",n=ir[t],r=lt.call(ir,t)?n.length:0;r--;){var i=n[r],s=i.func;if(null==s||s==e)return i.name}return t}function ks(e){return(lt.call(fr,"placeholder")?fr:e).placeholder}function Ls(){var e=fr.iteratee||Rc;return e=e===Rc?ci:e,arguments.length?e(arguments[0],arguments[1]):e}function Ds(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Fs(e){for(var t=ic(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Qs(i)]}return t}function Ps(e,t){var n=function(e,t){return null==e?s:e[t]}(e,t);return ai(n)?n:s}var Us=zn?function(e){return null==e?[]:(e=tt(e),Vt(zn(e),function(t){return kt.call(e,t)}))}:Hc,zs=zn?function(e){for(var t=[];e;)en(t,Us(e)),e=Rt(e);return t}:Hc,Bs=Zr;function Hs(e,t,n){for(var r=-1,i=(t=Wi(t,e)).length,s=!1;++r<i;){var o=uo(t[r]);if(!(s=null!=e&&n(e,o)))break;e=e[o]}return s||++r!=i?s:!!(i=null==e?0:e.length)&&ja(i)&&Gs(o,i)&&(_a(e)||ma(e))}function qs(e){return"function"!=typeof e.constructor||Vs(e)?{}:pr(Rt(e))}function $s(e){return _a(e)||ma(e)||!!(Ft&&e&&e[Ft])}function Gs(e,t){var n=typeof e;return!!(t=null==t?k:t)&&("number"==n||"symbol"!=n&&Ye.test(e))&&e>-1&&e%1==0&&e<t}function Ws(e,t,n){if(!Na(n))return!1;var r=typeof t;return!!("number"==r?ba(n)&&Gs(t,n.length):"string"==r&&t in n)&&fa(n[t],e)}function Js(e,t){if(_a(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!La(e))||Te.test(e)||!Oe.test(e)||null!=t&&e in tt(t)}function Ys(e){var t=Is(e),n=fr[t];if("function"!=typeof n||!(t in _r.prototype))return!1;if(e===n)return!0;var r=Ms(n);return!!r&&e===r[0]}(Qn&&Bs(new Qn(new ArrayBuffer(1)))!=ue||Zn&&Bs(new Zn)!=V||Kn&&"[object Promise]"!=Bs(Kn.resolve())||er&&Bs(new er)!=ne||tr&&Bs(new tr)!=oe)&&(Bs=function(e){var t=Zr(e),n=t==K?e.constructor:s,r=n?lo(n):"";if(r)switch(r){case sr:return ue;case or:return V;case ar:return"[object Promise]";case cr:return ne;case ur:return oe}return t});var Xs=ct?Ea:qc;function Vs(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||at)}function Qs(e){return e==e&&!Na(e)}function Zs(e,t){return function(n){return null!=n&&n[e]===t&&(t!==s||e in tt(n))}}function Ks(e,t,n){return t=Gn(t===s?e.length-1:t,0),function(){for(var i=arguments,s=-1,o=Gn(i.length-t,0),a=r(o);++s<o;)a[s]=i[t+s];s=-1;for(var c=r(t+1);++s<t;)c[s]=i[s];return c[t]=n(a),Gt(e,this,c)}}function eo(e,t){return t.length<2?e:Vr(e,Ti(t,0,-1))}function to(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var no=oo(Ni),ro=Fn||function(e,t){return It.setTimeout(e,t)},io=oo(Ci);function so(e,t,n){var r=t+"";return io(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(Fe,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Jt(z,function(n){var r="_."+n[0];t&n[1]&&!Qt(e,r)&&e.push(r)}),e.sort()}(function(e){var t=e.match(Pe);return t?t[1].split(Ue):[]}(r),n)))}function oo(e){var t=0,n=0;return function(){var r=Jn(),i=T-(r-n);if(n=r,i>0){if(++t>=O)return arguments[0]}else t=0;return e.apply(s,arguments)}}function ao(e,t){var n=-1,r=e.length,i=r-1;for(t=t===s?r:t;++n<t;){var o=Si(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}var co=function(e){var t=aa(e,function(e){return n.size===l&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Re,function(e,n,r,i){t.push(r?i.replace(Be,"$1"):n||e)}),t});function uo(e){if("string"==typeof e||La(e))return e;var t=e+"";return"0"==t&&1/e==-I?"-0":t}function lo(e){if(null!=e){try{return ut.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ho(e){if(e instanceof _r)return e.clone();var t=new mr(e.__wrapped__,e.__chain__);return t.__actions__=ns(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var fo=xi(function(e,t){return ya(e)?Pr(e,$r(t,1,ya,!0)):[]}),po=xi(function(e,t){var n=xo(t);return ya(n)&&(n=s),ya(e)?Pr(e,$r(t,1,ya,!0),Ls(n,2)):[]}),go=xi(function(e,t){var n=xo(t);return ya(n)&&(n=s),ya(e)?Pr(e,$r(t,1,ya,!0),s,n):[]});function mo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Ba(n);return i<0&&(i=Gn(r+i,0)),an(e,Ls(t,3),i)}function _o(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return n!==s&&(i=Ba(n),i=n<0?Gn(r+i,0):Wn(i,r-1)),an(e,Ls(t,3),i,!0)}function vo(e){return null!=e&&e.length?$r(e,1):[]}function bo(e){return e&&e.length?e[0]:s}var yo=xi(function(e){var t=Kt(e,$i);return t.length&&t[0]===e[0]?ni(t):[]}),So=xi(function(e){var t=xo(e),n=Kt(e,$i);return t===xo(n)?t=s:n.pop(),n.length&&n[0]===e[0]?ni(n,Ls(t,2)):[]}),wo=xi(function(e){var t=xo(e),n=Kt(e,$i);return(t="function"==typeof t?t:s)&&n.pop(),n.length&&n[0]===e[0]?ni(n,s,t):[]});function xo(e){var t=null==e?0:e.length;return t?e[t-1]:s}var Eo=xi(Ao);function Ao(e,t){return e&&e.length&&t&&t.length?bi(e,t):e}var jo=Os(function(e,t){var n=null==e?0:e.length,r=Ir(e,t);return yi(e,Kt(t,function(e){return Gs(e,n)?+e:e}).sort(Ki)),r});function No(e){return null==e?e:Vn.call(e)}var Co=xi(function(e){return Fi($r(e,1,ya,!0))}),Oo=xi(function(e){var t=xo(e);return ya(t)&&(t=s),Fi($r(e,1,ya,!0),Ls(t,2))}),To=xi(function(e){var t=xo(e);return t="function"==typeof t?t:s,Fi($r(e,1,ya,!0),s,t)});function Ro(e){if(!e||!e.length)return[];var t=0;return e=Vt(e,function(e){if(ya(e))return t=Gn(e.length,t),!0}),mn(t,function(t){return Kt(e,hn(t))})}function Mo(e,t){if(!e||!e.length)return[];var n=Ro(e);return null==t?n:Kt(n,function(e){return Gt(t,s,e)})}var Io=xi(function(e,t){return ya(e)?Pr(e,t):[]}),ko=xi(function(e){return Hi(Vt(e,ya))}),Lo=xi(function(e){var t=xo(e);return ya(t)&&(t=s),Hi(Vt(e,ya),Ls(t,2))}),Do=xi(function(e){var t=xo(e);return t="function"==typeof t?t:s,Hi(Vt(e,ya),s,t)}),Fo=xi(Ro);var Po=xi(function(e){var t=e.length,n=t>1?e[t-1]:s;return n="function"==typeof n?(e.pop(),n):s,Mo(e,n)});function Uo(e){var t=fr(e);return t.__chain__=!0,t}function zo(e,t){return t(e)}var Bo=Os(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return Ir(t,e)};return!(t>1||this.__actions__.length)&&r instanceof _r&&Gs(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:zo,args:[i],thisArg:s}),new mr(r,this.__chain__).thru(function(e){return t&&!e.length&&e.push(s),e})):this.thru(i)});var Ho=is(function(e,t,n){lt.call(e,n)?++e[n]:Mr(e,n,1)});var qo=ds(mo),$o=ds(_o);function Go(e,t){return(_a(e)?Jt:Ur)(e,Ls(t,3))}function Wo(e,t){return(_a(e)?Yt:zr)(e,Ls(t,3))}var Jo=is(function(e,t,n){lt.call(e,n)?e[n].push(t):Mr(e,n,[t])});var Yo=xi(function(e,t,n){var i=-1,s="function"==typeof t,o=ba(e)?r(e.length):[];return Ur(e,function(e){o[++i]=s?Gt(t,e,n):ri(e,t,n)}),o}),Xo=is(function(e,t,n){Mr(e,n,t)});function Vo(e,t){return(_a(e)?Kt:hi)(e,Ls(t,3))}var Qo=is(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});var Zo=xi(function(e,t){if(null==e)return[];var n=t.length;return n>1&&Ws(e,t[0],t[1])?t=[]:n>2&&Ws(t[0],t[1],t[2])&&(t=[t[0]]),_i(e,$r(t,1),[])}),Ko=Dn||function(){return It.Date.now()};function ea(e,t,n){return t=n?s:t,t=e&&null==t?e.length:t,Es(e,E,s,s,s,s,t)}function ta(e,t){var n;if("function"!=typeof t)throw new it(c);return e=Ba(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=s),n}}var na=xi(function(e,t,n){var r=_;if(n.length){var i=Cn(n,ks(na));r|=w}return Es(e,r,t,n,i)}),ra=xi(function(e,t,n){var r=_|v;if(n.length){var i=Cn(n,ks(ra));r|=w}return Es(t,r,e,n,i)});function ia(e,t,n){var r,i,o,a,u,l,d=0,h=!1,f=!1,p=!0;if("function"!=typeof e)throw new it(c);function g(t){var n=r,o=i;return r=i=s,d=t,a=e.apply(o,n)}function m(e){var n=e-l;return l===s||n>=t||n<0||f&&e-d>=o}function _(){var e=Ko();if(m(e))return v(e);u=ro(_,function(e){var n=t-(e-l);return f?Wn(n,o-(e-d)):n}(e))}function v(e){return u=s,p&&r?g(e):(r=i=s,a)}function b(){var e=Ko(),n=m(e);if(r=arguments,i=this,l=e,n){if(u===s)return function(e){return d=e,u=ro(_,t),h?g(e):a}(l);if(f)return Xi(u),u=ro(_,t),g(l)}return u===s&&(u=ro(_,t)),a}return t=qa(t)||0,Na(n)&&(h=!!n.leading,o=(f="maxWait"in n)?Gn(qa(n.maxWait)||0,t):o,p="trailing"in n?!!n.trailing:p),b.cancel=function(){u!==s&&Xi(u),d=0,r=l=i=u=s},b.flush=function(){return u===s?a:v(Ko())},b}var sa=xi(function(e,t){return Fr(e,1,t)}),oa=xi(function(e,t,n){return Fr(e,qa(t)||0,n)});function aa(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new it(c);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=e.apply(this,r);return n.cache=s.set(i,o)||s,o};return n.cache=new(aa.Cache||yr),n}function ca(e){if("function"!=typeof e)throw new it(c);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}aa.Cache=yr;var ua=Ji(function(e,t){var n=(t=1==t.length&&_a(t[0])?Kt(t[0],_n(Ls())):Kt($r(t,1),_n(Ls()))).length;return xi(function(r){for(var i=-1,s=Wn(r.length,n);++i<s;)r[i]=t[i].call(this,r[i]);return Gt(e,this,r)})}),la=xi(function(e,t){var n=Cn(t,ks(la));return Es(e,w,s,t,n)}),da=xi(function(e,t){var n=Cn(t,ks(da));return Es(e,x,s,t,n)}),ha=Os(function(e,t){return Es(e,A,s,s,s,t)});function fa(e,t){return e===t||e!=e&&t!=t}var pa=bs(Kr),ga=bs(function(e,t){return e>=t}),ma=ii(function(){return arguments}())?ii:function(e){return Ca(e)&&lt.call(e,"callee")&&!kt.call(e,"callee")},_a=r.isArray,va=Ut?_n(Ut):function(e){return Ca(e)&&Zr(e)==ce};function ba(e){return null!=e&&ja(e.length)&&!Ea(e)}function ya(e){return Ca(e)&&ba(e)}var Sa=Bn||qc,wa=zt?_n(zt):function(e){return Ca(e)&&Zr(e)==G};function xa(e){if(!Ca(e))return!1;var t=Zr(e);return t==J||t==W||"string"==typeof e.message&&"string"==typeof e.name&&!Ra(e)}function Ea(e){if(!Na(e))return!1;var t=Zr(e);return t==Y||t==X||t==q||t==ee}function Aa(e){return"number"==typeof e&&e==Ba(e)}function ja(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=k}function Na(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ca(e){return null!=e&&"object"==typeof e}var Oa=Bt?_n(Bt):function(e){return Ca(e)&&Bs(e)==V};function Ta(e){return"number"==typeof e||Ca(e)&&Zr(e)==Q}function Ra(e){if(!Ca(e)||Zr(e)!=K)return!1;var t=Rt(e);if(null===t)return!0;var n=lt.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&ut.call(n)==pt}var Ma=Ht?_n(Ht):function(e){return Ca(e)&&Zr(e)==te};var Ia=qt?_n(qt):function(e){return Ca(e)&&Bs(e)==ne};function ka(e){return"string"==typeof e||!_a(e)&&Ca(e)&&Zr(e)==re}function La(e){return"symbol"==typeof e||Ca(e)&&Zr(e)==ie}var Da=$t?_n($t):function(e){return Ca(e)&&ja(e.length)&&!!jt[Zr(e)]};var Fa=bs(di),Pa=bs(function(e,t){return e<=t});function Ua(e){if(!e)return[];if(ba(e))return ka(e)?Mn(e):ns(e);if(Pt&&e[Pt])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Pt]());var t=Bs(e);return(t==V?jn:t==ne?On:fc)(e)}function za(e){return e?(e=qa(e))===I||e===-I?(e<0?-1:1)*L:e==e?e:0:0===e?e:0}function Ba(e){var t=za(e),n=t%1;return t==t?n?t-n:t:0}function Ha(e){return e?kr(Ba(e),0,F):0}function qa(e){if("number"==typeof e)return e;if(La(e))return D;if(Na(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Na(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(ke,"");var n=Ge.test(e);return n||Je.test(e)?Tt(e.slice(2),n?2:8):$e.test(e)?D:+e}function $a(e){return rs(e,sc(e))}function Ga(e){return null==e?"":Di(e)}var Wa=ss(function(e,t){if(Vs(t)||ba(t))rs(t,ic(t),e);else for(var n in t)lt.call(t,n)&&Cr(e,n,t[n])}),Ja=ss(function(e,t){rs(t,sc(t),e)}),Ya=ss(function(e,t,n,r){rs(t,sc(t),e,r)}),Xa=ss(function(e,t,n,r){rs(t,ic(t),e,r)}),Va=Os(Ir);var Qa=xi(function(e,t){e=tt(e);var n=-1,r=t.length,i=r>2?t[2]:s;for(i&&Ws(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],a=sc(o),c=-1,u=a.length;++c<u;){var l=a[c],d=e[l];(d===s||fa(d,at[l])&&!lt.call(e,l))&&(e[l]=o[l])}return e}),Za=xi(function(e){return e.push(s,js),Gt(ac,s,e)});function Ka(e,t,n){var r=null==e?s:Vr(e,t);return r===s?n:r}function ec(e,t){return null!=e&&Hs(e,t,ti)}var tc=ps(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ft.call(t)),e[t]=n},Nc(Tc)),nc=ps(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ft.call(t)),lt.call(e,t)?e[t].push(n):e[t]=[n]},Ls),rc=xi(ri);function ic(e){return ba(e)?xr(e):ui(e)}function sc(e){return ba(e)?xr(e,!0):li(e)}var oc=ss(function(e,t,n){gi(e,t,n)}),ac=ss(function(e,t,n,r){gi(e,t,n,r)}),cc=Os(function(e,t){var n={};if(null==e)return n;var r=!1;t=Kt(t,function(t){return t=Wi(t,e),r||(r=t.length>1),t}),rs(e,Rs(e),n),r&&(n=Lr(n,h|f|p,Ns));for(var i=t.length;i--;)Pi(n,t[i]);return n});var uc=Os(function(e,t){return null==e?{}:function(e,t){return vi(e,t,function(t,n){return ec(e,n)})}(e,t)});function lc(e,t){if(null==e)return{};var n=Kt(Rs(e),function(e){return[e]});return t=Ls(t),vi(e,n,function(e,n){return t(e,n[0])})}var dc=xs(ic),hc=xs(sc);function fc(e){return null==e?[]:vn(e,ic(e))}var pc=us(function(e,t,n){return t=t.toLowerCase(),e+(n?gc(t):t)});function gc(e){return xc(Ga(e).toLowerCase())}function mc(e){return(e=Ga(e))&&e.replace(Xe,wn).replace(bt,"")}var _c=us(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),vc=us(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),bc=cs("toLowerCase");var yc=us(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});var Sc=us(function(e,t,n){return e+(n?" ":"")+xc(t)});var wc=us(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),xc=cs("toUpperCase");function Ec(e,t,n){return e=Ga(e),(t=n?s:t)===s?function(e){return xt.test(e)}(e)?function(e){return e.match(St)||[]}(e):function(e){return e.match(ze)||[]}(e):e.match(t)||[]}var Ac=xi(function(e,t){try{return Gt(e,s,t)}catch(e){return xa(e)?e:new Ze(e)}}),jc=Os(function(e,t){return Jt(t,function(t){t=uo(t),Mr(e,t,na(e[t],e))}),e});function Nc(e){return function(){return e}}var Cc=hs(),Oc=hs(!0);function Tc(e){return e}function Rc(e){return ci("function"==typeof e?e:Lr(e,h))}var Mc=xi(function(e,t){return function(n){return ri(n,e,t)}}),Ic=xi(function(e,t){return function(n){return ri(e,n,t)}});function kc(e,t,n){var r=ic(t),i=Xr(t,r);null!=n||Na(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=Xr(t,ic(t)));var s=!(Na(n)&&"chain"in n&&!n.chain),o=Ea(e);return Jt(i,function(n){var r=t[n];e[n]=r,o&&(e.prototype[n]=function(){var t=this.__chain__;if(s||t){var n=e(this.__wrapped__),i=n.__actions__=ns(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,en([this.value()],arguments))})}),e}function Lc(){}var Dc=ms(Kt),Fc=ms(Xt),Pc=ms(rn);function Uc(e){return Js(e)?hn(uo(e)):function(e){return function(t){return Vr(t,e)}}(e)}var zc=vs(),Bc=vs(!0);function Hc(){return[]}function qc(){return!1}var $c=gs(function(e,t){return e+t},0),Gc=Ss("ceil"),Wc=gs(function(e,t){return e/t},1),Jc=Ss("floor");var Yc,Xc=gs(function(e,t){return e*t},1),Vc=Ss("round"),Qc=gs(function(e,t){return e-t},0);return fr.after=function(e,t){if("function"!=typeof t)throw new it(c);return e=Ba(e),function(){if(--e<1)return t.apply(this,arguments)}},fr.ary=ea,fr.assign=Wa,fr.assignIn=Ja,fr.assignInWith=Ya,fr.assignWith=Xa,fr.at=Va,fr.before=ta,fr.bind=na,fr.bindAll=jc,fr.bindKey=ra,fr.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return _a(e)?e:[e]},fr.chain=Uo,fr.chunk=function(e,t,n){t=(n?Ws(e,t,n):t===s)?1:Gn(Ba(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,a=0,c=r(Pn(i/t));o<i;)c[a++]=Ti(e,o,o+=t);return c},fr.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var s=e[t];s&&(i[r++]=s)}return i},fr.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return en(_a(n)?ns(n):[n],$r(t,1))},fr.cond=function(e){var t=null==e?0:e.length,n=Ls();return e=t?Kt(e,function(e){if("function"!=typeof e[1])throw new it(c);return[n(e[0]),e[1]]}):[],xi(function(n){for(var r=-1;++r<t;){var i=e[r];if(Gt(i[0],this,n))return Gt(i[1],this,n)}})},fr.conforms=function(e){return function(e){var t=ic(e);return function(n){return Dr(n,e,t)}}(Lr(e,h))},fr.constant=Nc,fr.countBy=Ho,fr.create=function(e,t){var n=pr(e);return null==t?n:Rr(n,t)},fr.curry=function e(t,n,r){var i=Es(t,y,s,s,s,s,s,n=r?s:n);return i.placeholder=e.placeholder,i},fr.curryRight=function e(t,n,r){var i=Es(t,S,s,s,s,s,s,n=r?s:n);return i.placeholder=e.placeholder,i},fr.debounce=ia,fr.defaults=Qa,fr.defaultsDeep=Za,fr.defer=sa,fr.delay=oa,fr.difference=fo,fr.differenceBy=po,fr.differenceWith=go,fr.drop=function(e,t,n){var r=null==e?0:e.length;return r?Ti(e,(t=n||t===s?1:Ba(t))<0?0:t,r):[]},fr.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Ti(e,0,(t=r-(t=n||t===s?1:Ba(t)))<0?0:t):[]},fr.dropRightWhile=function(e,t){return e&&e.length?zi(e,Ls(t,3),!0,!0):[]},fr.dropWhile=function(e,t){return e&&e.length?zi(e,Ls(t,3),!0):[]},fr.fill=function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&Ws(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=Ba(n))<0&&(n=-n>i?0:i+n),(r=r===s||r>i?i:Ba(r))<0&&(r+=i),r=n>r?0:Ha(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},fr.filter=function(e,t){return(_a(e)?Vt:qr)(e,Ls(t,3))},fr.flatMap=function(e,t){return $r(Vo(e,t),1)},fr.flatMapDeep=function(e,t){return $r(Vo(e,t),I)},fr.flatMapDepth=function(e,t,n){return n=n===s?1:Ba(n),$r(Vo(e,t),n)},fr.flatten=vo,fr.flattenDeep=function(e){return null!=e&&e.length?$r(e,I):[]},fr.flattenDepth=function(e,t){return null!=e&&e.length?$r(e,t=t===s?1:Ba(t)):[]},fr.flip=function(e){return Es(e,j)},fr.flow=Cc,fr.flowRight=Oc,fr.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},fr.functions=function(e){return null==e?[]:Xr(e,ic(e))},fr.functionsIn=function(e){return null==e?[]:Xr(e,sc(e))},fr.groupBy=Jo,fr.initial=function(e){return null!=e&&e.length?Ti(e,0,-1):[]},fr.intersection=yo,fr.intersectionBy=So,fr.intersectionWith=wo,fr.invert=tc,fr.invertBy=nc,fr.invokeMap=Yo,fr.iteratee=Rc,fr.keyBy=Xo,fr.keys=ic,fr.keysIn=sc,fr.map=Vo,fr.mapKeys=function(e,t){var n={};return t=Ls(t,3),Jr(e,function(e,r,i){Mr(n,t(e,r,i),e)}),n},fr.mapValues=function(e,t){var n={};return t=Ls(t,3),Jr(e,function(e,r,i){Mr(n,r,t(e,r,i))}),n},fr.matches=function(e){return fi(Lr(e,h))},fr.matchesProperty=function(e,t){return pi(e,Lr(t,h))},fr.memoize=aa,fr.merge=oc,fr.mergeWith=ac,fr.method=Mc,fr.methodOf=Ic,fr.mixin=kc,fr.negate=ca,fr.nthArg=function(e){return e=Ba(e),xi(function(t){return mi(t,e)})},fr.omit=cc,fr.omitBy=function(e,t){return lc(e,ca(Ls(t)))},fr.once=function(e){return ta(2,e)},fr.orderBy=function(e,t,n,r){return null==e?[]:(_a(t)||(t=null==t?[]:[t]),_a(n=r?s:n)||(n=null==n?[]:[n]),_i(e,t,n))},fr.over=Dc,fr.overArgs=ua,fr.overEvery=Fc,fr.overSome=Pc,fr.partial=la,fr.partialRight=da,fr.partition=Qo,fr.pick=uc,fr.pickBy=lc,fr.property=Uc,fr.propertyOf=function(e){return function(t){return null==e?s:Vr(e,t)}},fr.pull=Eo,fr.pullAll=Ao,fr.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?bi(e,t,Ls(n,2)):e},fr.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?bi(e,t,s,n):e},fr.pullAt=jo,fr.range=zc,fr.rangeRight=Bc,fr.rearg=ha,fr.reject=function(e,t){return(_a(e)?Vt:qr)(e,ca(Ls(t,3)))},fr.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],s=e.length;for(t=Ls(t,3);++r<s;){var o=e[r];t(o,r,e)&&(n.push(o),i.push(r))}return yi(e,i),n},fr.rest=function(e,t){if("function"!=typeof e)throw new it(c);return xi(e,t=t===s?t:Ba(t))},fr.reverse=No,fr.sampleSize=function(e,t,n){return t=(n?Ws(e,t,n):t===s)?1:Ba(t),(_a(e)?Ar:Ai)(e,t)},fr.set=function(e,t,n){return null==e?e:ji(e,t,n)},fr.setWith=function(e,t,n,r){return r="function"==typeof r?r:s,null==e?e:ji(e,t,n,r)},fr.shuffle=function(e){return(_a(e)?jr:Oi)(e)},fr.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&Ws(e,t,n)?(t=0,n=r):(t=null==t?0:Ba(t),n=n===s?r:Ba(n)),Ti(e,t,n)):[]},fr.sortBy=Zo,fr.sortedUniq=function(e){return e&&e.length?ki(e):[]},fr.sortedUniqBy=function(e,t){return e&&e.length?ki(e,Ls(t,2)):[]},fr.split=function(e,t,n){return n&&"number"!=typeof n&&Ws(e,t,n)&&(t=n=s),(n=n===s?F:n>>>0)?(e=Ga(e))&&("string"==typeof t||null!=t&&!Ma(t))&&!(t=Di(t))&&An(e)?Yi(Mn(e),0,n):e.split(t,n):[]},fr.spread=function(e,t){if("function"!=typeof e)throw new it(c);return t=null==t?0:Gn(Ba(t),0),xi(function(n){var r=n[t],i=Yi(n,0,t);return r&&en(i,r),Gt(e,this,i)})},fr.tail=function(e){var t=null==e?0:e.length;return t?Ti(e,1,t):[]},fr.take=function(e,t,n){return e&&e.length?Ti(e,0,(t=n||t===s?1:Ba(t))<0?0:t):[]},fr.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Ti(e,(t=r-(t=n||t===s?1:Ba(t)))<0?0:t,r):[]},fr.takeRightWhile=function(e,t){return e&&e.length?zi(e,Ls(t,3),!1,!0):[]},fr.takeWhile=function(e,t){return e&&e.length?zi(e,Ls(t,3)):[]},fr.tap=function(e,t){return t(e),e},fr.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new it(c);return Na(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),ia(e,t,{leading:r,maxWait:t,trailing:i})},fr.thru=zo,fr.toArray=Ua,fr.toPairs=dc,fr.toPairsIn=hc,fr.toPath=function(e){return _a(e)?Kt(e,uo):La(e)?[e]:ns(co(Ga(e)))},fr.toPlainObject=$a,fr.transform=function(e,t,n){var r=_a(e),i=r||Sa(e)||Da(e);if(t=Ls(t,4),null==n){var s=e&&e.constructor;n=i?r?new s:[]:Na(e)&&Ea(s)?pr(Rt(e)):{}}return(i?Jt:Jr)(e,function(e,r,i){return t(n,e,r,i)}),n},fr.unary=function(e){return ea(e,1)},fr.union=Co,fr.unionBy=Oo,fr.unionWith=To,fr.uniq=function(e){return e&&e.length?Fi(e):[]},fr.uniqBy=function(e,t){return e&&e.length?Fi(e,Ls(t,2)):[]},fr.uniqWith=function(e,t){return t="function"==typeof t?t:s,e&&e.length?Fi(e,s,t):[]},fr.unset=function(e,t){return null==e||Pi(e,t)},fr.unzip=Ro,fr.unzipWith=Mo,fr.update=function(e,t,n){return null==e?e:Ui(e,t,Gi(n))},fr.updateWith=function(e,t,n,r){return r="function"==typeof r?r:s,null==e?e:Ui(e,t,Gi(n),r)},fr.values=fc,fr.valuesIn=function(e){return null==e?[]:vn(e,sc(e))},fr.without=Io,fr.words=Ec,fr.wrap=function(e,t){return la(Gi(t),e)},fr.xor=ko,fr.xorBy=Lo,fr.xorWith=Do,fr.zip=Fo,fr.zipObject=function(e,t){return qi(e||[],t||[],Cr)},fr.zipObjectDeep=function(e,t){return qi(e||[],t||[],ji)},fr.zipWith=Po,fr.entries=dc,fr.entriesIn=hc,fr.extend=Ja,fr.extendWith=Ya,kc(fr,fr),fr.add=$c,fr.attempt=Ac,fr.camelCase=pc,fr.capitalize=gc,fr.ceil=Gc,fr.clamp=function(e,t,n){return n===s&&(n=t,t=s),n!==s&&(n=(n=qa(n))==n?n:0),t!==s&&(t=(t=qa(t))==t?t:0),kr(qa(e),t,n)},fr.clone=function(e){return Lr(e,p)},fr.cloneDeep=function(e){return Lr(e,h|p)},fr.cloneDeepWith=function(e,t){return Lr(e,h|p,t="function"==typeof t?t:s)},fr.cloneWith=function(e,t){return Lr(e,p,t="function"==typeof t?t:s)},fr.conformsTo=function(e,t){return null==t||Dr(e,t,ic(t))},fr.deburr=mc,fr.defaultTo=function(e,t){return null==e||e!=e?t:e},fr.divide=Wc,fr.endsWith=function(e,t,n){e=Ga(e),t=Di(t);var r=e.length,i=n=n===s?r:kr(Ba(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},fr.eq=fa,fr.escape=function(e){return(e=Ga(e))&&Ae.test(e)?e.replace(xe,xn):e},fr.escapeRegExp=function(e){return(e=Ga(e))&&Ie.test(e)?e.replace(Me,"\\$&"):e},fr.every=function(e,t,n){var r=_a(e)?Xt:Br;return n&&Ws(e,t,n)&&(t=s),r(e,Ls(t,3))},fr.find=qo,fr.findIndex=mo,fr.findKey=function(e,t){return on(e,Ls(t,3),Jr)},fr.findLast=$o,fr.findLastIndex=_o,fr.findLastKey=function(e,t){return on(e,Ls(t,3),Yr)},fr.floor=Jc,fr.forEach=Go,fr.forEachRight=Wo,fr.forIn=function(e,t){return null==e?e:Gr(e,Ls(t,3),sc)},fr.forInRight=function(e,t){return null==e?e:Wr(e,Ls(t,3),sc)},fr.forOwn=function(e,t){return e&&Jr(e,Ls(t,3))},fr.forOwnRight=function(e,t){return e&&Yr(e,Ls(t,3))},fr.get=Ka,fr.gt=pa,fr.gte=ga,fr.has=function(e,t){return null!=e&&Hs(e,t,ei)},fr.hasIn=ec,fr.head=bo,fr.identity=Tc,fr.includes=function(e,t,n,r){e=ba(e)?e:fc(e),n=n&&!r?Ba(n):0;var i=e.length;return n<0&&(n=Gn(i+n,0)),ka(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&cn(e,t,n)>-1},fr.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Ba(n);return i<0&&(i=Gn(r+i,0)),cn(e,t,i)},fr.inRange=function(e,t,n){return t=za(t),n===s?(n=t,t=0):n=za(n),function(e,t,n){return e>=Wn(t,n)&&e<Gn(t,n)}(e=qa(e),t,n)},fr.invoke=rc,fr.isArguments=ma,fr.isArray=_a,fr.isArrayBuffer=va,fr.isArrayLike=ba,fr.isArrayLikeObject=ya,fr.isBoolean=function(e){return!0===e||!1===e||Ca(e)&&Zr(e)==$},fr.isBuffer=Sa,fr.isDate=wa,fr.isElement=function(e){return Ca(e)&&1===e.nodeType&&!Ra(e)},fr.isEmpty=function(e){if(null==e)return!0;if(ba(e)&&(_a(e)||"string"==typeof e||"function"==typeof e.splice||Sa(e)||Da(e)||ma(e)))return!e.length;var t=Bs(e);if(t==V||t==ne)return!e.size;if(Vs(e))return!ui(e).length;for(var n in e)if(lt.call(e,n))return!1;return!0},fr.isEqual=function(e,t){return si(e,t)},fr.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:s)?n(e,t):s;return r===s?si(e,t,s,n):!!r},fr.isError=xa,fr.isFinite=function(e){return"number"==typeof e&&Hn(e)},fr.isFunction=Ea,fr.isInteger=Aa,fr.isLength=ja,fr.isMap=Oa,fr.isMatch=function(e,t){return e===t||oi(e,t,Fs(t))},fr.isMatchWith=function(e,t,n){return n="function"==typeof n?n:s,oi(e,t,Fs(t),n)},fr.isNaN=function(e){return Ta(e)&&e!=+e},fr.isNative=function(e){if(Xs(e))throw new Ze(a);return ai(e)},fr.isNil=function(e){return null==e},fr.isNull=function(e){return null===e},fr.isNumber=Ta,fr.isObject=Na,fr.isObjectLike=Ca,fr.isPlainObject=Ra,fr.isRegExp=Ma,fr.isSafeInteger=function(e){return Aa(e)&&e>=-k&&e<=k},fr.isSet=Ia,fr.isString=ka,fr.isSymbol=La,fr.isTypedArray=Da,fr.isUndefined=function(e){return e===s},fr.isWeakMap=function(e){return Ca(e)&&Bs(e)==oe},fr.isWeakSet=function(e){return Ca(e)&&Zr(e)==ae},fr.join=function(e,t){return null==e?"":qn.call(e,t)},fr.kebabCase=_c,fr.last=xo,fr.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return n!==s&&(i=(i=Ba(n))<0?Gn(r+i,0):Wn(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):an(e,ln,i,!0)},fr.lowerCase=vc,fr.lowerFirst=bc,fr.lt=Fa,fr.lte=Pa,fr.max=function(e){return e&&e.length?Hr(e,Tc,Kr):s},fr.maxBy=function(e,t){return e&&e.length?Hr(e,Ls(t,2),Kr):s},fr.mean=function(e){return dn(e,Tc)},fr.meanBy=function(e,t){return dn(e,Ls(t,2))},fr.min=function(e){return e&&e.length?Hr(e,Tc,di):s},fr.minBy=function(e,t){return e&&e.length?Hr(e,Ls(t,2),di):s},fr.stubArray=Hc,fr.stubFalse=qc,fr.stubObject=function(){return{}},fr.stubString=function(){return""},fr.stubTrue=function(){return!0},fr.multiply=Xc,fr.nth=function(e,t){return e&&e.length?mi(e,Ba(t)):s},fr.noConflict=function(){return It._===this&&(It._=gt),this},fr.noop=Lc,fr.now=Ko,fr.pad=function(e,t,n){e=Ga(e);var r=(t=Ba(t))?Rn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return _s(Un(i),n)+e+_s(Pn(i),n)},fr.padEnd=function(e,t,n){e=Ga(e);var r=(t=Ba(t))?Rn(e):0;return t&&r<t?e+_s(t-r,n):e},fr.padStart=function(e,t,n){e=Ga(e);var r=(t=Ba(t))?Rn(e):0;return t&&r<t?_s(t-r,n)+e:e},fr.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Yn(Ga(e).replace(Le,""),t||0)},fr.random=function(e,t,n){if(n&&"boolean"!=typeof n&&Ws(e,t,n)&&(t=n=s),n===s&&("boolean"==typeof t?(n=t,t=s):"boolean"==typeof e&&(n=e,e=s)),e===s&&t===s?(e=0,t=1):(e=za(e),t===s?(t=e,e=0):t=za(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=Xn();return Wn(e+i*(t-e+Ot("1e-"+((i+"").length-1))),t)}return Si(e,t)},fr.reduce=function(e,t,n){var r=_a(e)?tn:pn,i=arguments.length<3;return r(e,Ls(t,4),n,i,Ur)},fr.reduceRight=function(e,t,n){var r=_a(e)?nn:pn,i=arguments.length<3;return r(e,Ls(t,4),n,i,zr)},fr.repeat=function(e,t,n){return t=(n?Ws(e,t,n):t===s)?1:Ba(t),wi(Ga(e),t)},fr.replace=function(){var e=arguments,t=Ga(e[0]);return e.length<3?t:t.replace(e[1],e[2])},fr.result=function(e,t,n){var r=-1,i=(t=Wi(t,e)).length;for(i||(i=1,e=s);++r<i;){var o=null==e?s:e[uo(t[r])];o===s&&(r=i,o=n),e=Ea(o)?o.call(e):o}return e},fr.round=Vc,fr.runInContext=e,fr.sample=function(e){return(_a(e)?Er:Ei)(e)},fr.size=function(e){if(null==e)return 0;if(ba(e))return ka(e)?Rn(e):e.length;var t=Bs(e);return t==V||t==ne?e.size:ui(e).length},fr.snakeCase=yc,fr.some=function(e,t,n){var r=_a(e)?rn:Ri;return n&&Ws(e,t,n)&&(t=s),r(e,Ls(t,3))},fr.sortedIndex=function(e,t){return Mi(e,t)},fr.sortedIndexBy=function(e,t,n){return Ii(e,t,Ls(n,2))},fr.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=Mi(e,t);if(r<n&&fa(e[r],t))return r}return-1},fr.sortedLastIndex=function(e,t){return Mi(e,t,!0)},fr.sortedLastIndexBy=function(e,t,n){return Ii(e,t,Ls(n,2),!0)},fr.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=Mi(e,t,!0)-1;if(fa(e[n],t))return n}return-1},fr.startCase=Sc,fr.startsWith=function(e,t,n){return e=Ga(e),n=null==n?0:kr(Ba(n),0,e.length),t=Di(t),e.slice(n,n+t.length)==t},fr.subtract=Qc,fr.sum=function(e){return e&&e.length?gn(e,Tc):0},fr.sumBy=function(e,t){return e&&e.length?gn(e,Ls(t,2)):0},fr.template=function(e,t,n){var r=fr.templateSettings;n&&Ws(e,t,n)&&(t=s),e=Ga(e),t=Ya({},t,r,As);var i,o,a=Ya({},t.imports,r.imports,As),c=ic(a),u=vn(a,c),l=0,d=t.interpolate||Ve,h="__p += '",f=nt((t.escape||Ve).source+"|"+d.source+"|"+(d===Ce?He:Ve).source+"|"+(t.evaluate||Ve).source+"|$","g"),p="//# sourceURL="+(lt.call(t,"sourceURL")?(t.sourceURL+"").replace(/[\r\n]/g," "):"lodash.templateSources["+ ++At+"]")+"\n";e.replace(f,function(t,n,r,s,a,c){return r||(r=s),h+=e.slice(l,c).replace(Qe,En),n&&(i=!0,h+="' +\n__e("+n+") +\n'"),a&&(o=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=c+t.length,t}),h+="';\n";var g=lt.call(t,"variable")&&t.variable;g||(h="with (obj) {\n"+h+"\n}\n"),h=(o?h.replace(be,""):h).replace(ye,"$1").replace(Se,"$1;"),h="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=Ac(function(){return Ke(c,p+"return "+h).apply(s,u)});if(m.source=h,xa(m))throw m;return m},fr.times=function(e,t){if((e=Ba(e))<1||e>k)return[];var n=F,r=Wn(e,F);t=Ls(t),e-=F;for(var i=mn(r,t);++n<e;)t(n);return i},fr.toFinite=za,fr.toInteger=Ba,fr.toLength=Ha,fr.toLower=function(e){return Ga(e).toLowerCase()},fr.toNumber=qa,fr.toSafeInteger=function(e){return e?kr(Ba(e),-k,k):0===e?e:0},fr.toString=Ga,fr.toUpper=function(e){return Ga(e).toUpperCase()},fr.trim=function(e,t,n){if((e=Ga(e))&&(n||t===s))return e.replace(ke,"");if(!e||!(t=Di(t)))return e;var r=Mn(e),i=Mn(t);return Yi(r,yn(r,i),Sn(r,i)+1).join("")},fr.trimEnd=function(e,t,n){if((e=Ga(e))&&(n||t===s))return e.replace(De,"");if(!e||!(t=Di(t)))return e;var r=Mn(e);return Yi(r,0,Sn(r,Mn(t))+1).join("")},fr.trimStart=function(e,t,n){if((e=Ga(e))&&(n||t===s))return e.replace(Le,"");if(!e||!(t=Di(t)))return e;var r=Mn(e);return Yi(r,yn(r,Mn(t))).join("")},fr.truncate=function(e,t){var n=N,r=C;if(Na(t)){var i="separator"in t?t.separator:i;n="length"in t?Ba(t.length):n,r="omission"in t?Di(t.omission):r}var o=(e=Ga(e)).length;if(An(e)){var a=Mn(e);o=a.length}if(n>=o)return e;var c=n-Rn(r);if(c<1)return r;var u=a?Yi(a,0,c).join(""):e.slice(0,c);if(i===s)return u+r;if(a&&(c+=u.length-c),Ma(i)){if(e.slice(c).search(i)){var l,d=u;for(i.global||(i=nt(i.source,Ga(qe.exec(i))+"g")),i.lastIndex=0;l=i.exec(d);)var h=l.index;u=u.slice(0,h===s?c:h)}}else if(e.indexOf(Di(i),c)!=c){var f=u.lastIndexOf(i);f>-1&&(u=u.slice(0,f))}return u+r},fr.unescape=function(e){return(e=Ga(e))&&Ee.test(e)?e.replace(we,In):e},fr.uniqueId=function(e){var t=++dt;return Ga(e)+t},fr.upperCase=wc,fr.upperFirst=xc,fr.each=Go,fr.eachRight=Wo,fr.first=bo,kc(fr,(Yc={},Jr(fr,function(e,t){lt.call(fr.prototype,t)||(Yc[t]=e)}),Yc),{chain:!1}),fr.VERSION="4.17.15",Jt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){fr[e].placeholder=fr}),Jt(["drop","take"],function(e,t){_r.prototype[e]=function(n){n=n===s?1:Gn(Ba(n),0);var r=this.__filtered__&&!t?new _r(this):this.clone();return r.__filtered__?r.__takeCount__=Wn(n,r.__takeCount__):r.__views__.push({size:Wn(n,F),type:e+(r.__dir__<0?"Right":"")}),r},_r.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),Jt(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==R||3==n;_r.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Ls(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),Jt(["head","last"],function(e,t){var n="take"+(t?"Right":"");_r.prototype[e]=function(){return this[n](1).value()[0]}}),Jt(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");_r.prototype[e]=function(){return this.__filtered__?new _r(this):this[n](1)}}),_r.prototype.compact=function(){return this.filter(Tc)},_r.prototype.find=function(e){return this.filter(e).head()},_r.prototype.findLast=function(e){return this.reverse().find(e)},_r.prototype.invokeMap=xi(function(e,t){return"function"==typeof e?new _r(this):this.map(function(n){return ri(n,e,t)})}),_r.prototype.reject=function(e){return this.filter(ca(Ls(e)))},_r.prototype.slice=function(e,t){e=Ba(e);var n=this;return n.__filtered__&&(e>0||t<0)?new _r(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==s&&(n=(t=Ba(t))<0?n.dropRight(-t):n.take(t-e)),n)},_r.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},_r.prototype.toArray=function(){return this.take(F)},Jr(_r.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=fr[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(fr.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,c=t instanceof _r,u=a[0],l=c||_a(t),d=function(e){var t=i.apply(fr,en([e],a));return r&&h?t[0]:t};l&&n&&"function"==typeof u&&1!=u.length&&(c=l=!1);var h=this.__chain__,f=!!this.__actions__.length,p=o&&!h,g=c&&!f;if(!o&&l){t=g?t:new _r(this);var m=e.apply(t,a);return m.__actions__.push({func:zo,args:[d],thisArg:s}),new mr(m,h)}return p&&g?e.apply(this,a):(m=this.thru(d),p?r?m.value()[0]:m.value():m)})}),Jt(["pop","push","shift","sort","splice","unshift"],function(e){var t=st[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);fr.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(_a(i)?i:[],e)}return this[n](function(n){return t.apply(_a(n)?n:[],e)})}}),Jr(_r.prototype,function(e,t){var n=fr[t];if(n){var r=n.name+"";lt.call(ir,r)||(ir[r]=[]),ir[r].push({name:t,func:n})}}),ir[fs(s,v).name]=[{name:"wrapper",func:s}],_r.prototype.clone=function(){var e=new _r(this.__wrapped__);return e.__actions__=ns(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ns(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ns(this.__views__),e},_r.prototype.reverse=function(){if(this.__filtered__){var e=new _r(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},_r.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=_a(e),r=t<0,i=n?e.length:0,s=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var s=n[r],o=s.size;switch(s.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=Wn(t,e+o);break;case"takeRight":e=Gn(e,t-o)}}return{start:e,end:t}}(0,i,this.__views__),o=s.start,a=s.end,c=a-o,u=r?a:o-1,l=this.__iteratees__,d=l.length,h=0,f=Wn(c,this.__takeCount__);if(!n||!r&&i==c&&f==c)return Bi(e,this.__actions__);var p=[];e:for(;c--&&h<f;){for(var g=-1,m=e[u+=t];++g<d;){var _=l[g],v=_.iteratee,b=_.type,y=v(m);if(b==M)m=y;else if(!y){if(b==R)continue e;break e}}p[h++]=m}return p},fr.prototype.at=Bo,fr.prototype.chain=function(){return Uo(this)},fr.prototype.commit=function(){return new mr(this.value(),this.__chain__)},fr.prototype.next=function(){this.__values__===s&&(this.__values__=Ua(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?s:this.__values__[this.__index__++]}},fr.prototype.plant=function(e){for(var t,n=this;n instanceof gr;){var r=ho(n);r.__index__=0,r.__values__=s,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},fr.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof _r){var t=e;return this.__actions__.length&&(t=new _r(this)),(t=t.reverse()).__actions__.push({func:zo,args:[No],thisArg:s}),new mr(t,this.__chain__)}return this.thru(No)},fr.prototype.toJSON=fr.prototype.valueOf=fr.prototype.value=function(){return Bi(this.__wrapped__,this.__actions__)},fr.prototype.first=fr.prototype.head,Pt&&(fr.prototype[Pt]=function(){return this}),fr}();It._=kn,(i=function(){return kn}.call(t,n,t,r))===s||(r.exports=i)}).call(this)}).call(this,n(20),n(33)(e))},function(e,t,n){var r;
/*!
 * Sizzle CSS Selector Engine v2.3.4
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2019-04-08
 */
/*!
 * Sizzle CSS Selector Engine v2.3.4
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2019-04-08
 */
!function(i){var s,o,a,c,u,l,d,h,f,p,g,m,_,v,b,y,S,w,x,E="sizzle"+1*new Date,A=i.document,j=0,N=0,C=he(),O=he(),T=he(),R=he(),M=function(e,t){return e===t&&(g=!0),0},I={}.hasOwnProperty,k=[],L=k.pop,D=k.push,F=k.push,P=k.slice,U=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},z="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",B="[\\x20\\t\\r\\n\\f]",H="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",q="\\["+B+"*("+H+")(?:"+B+"*([*^$|!~]?=)"+B+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+H+"))|)"+B+"*\\]",$=":("+H+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+q+")*)|.*)\\)|)",G=new RegExp(B+"+","g"),W=new RegExp("^"+B+"+|((?:^|[^\\\\])(?:\\\\.)*)"+B+"+$","g"),J=new RegExp("^"+B+"*,"+B+"*"),Y=new RegExp("^"+B+"*([>+~]|"+B+")"+B+"*"),X=new RegExp(B+"|>"),V=new RegExp($),Q=new RegExp("^"+H+"$"),Z={ID:new RegExp("^#("+H+")"),CLASS:new RegExp("^\\.("+H+")"),TAG:new RegExp("^("+H+"|[*])"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+$),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+B+"*(even|odd|(([+-]|)(\\d*)n|)"+B+"*(?:([+-]|)"+B+"*(\\d+)|))"+B+"*\\)|)","i"),bool:new RegExp("^(?:"+z+")$","i"),needsContext:new RegExp("^"+B+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+B+"*((?:-\\d)?\\d*)"+B+"*\\)|)(?=[^-]|$)","i")},K=/HTML$/i,ee=/^(?:input|select|textarea|button)$/i,te=/^h\d$/i,ne=/^[^{]+\{\s*\[native \w/,re=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ie=/[+~]/,se=new RegExp("\\\\([\\da-f]{1,6}"+B+"?|("+B+")|.)","ig"),oe=function(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},ae=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ce=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ue=function(){m()},le=Ee(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{F.apply(k=P.call(A.childNodes),A.childNodes),k[A.childNodes.length].nodeType}catch(e){F={apply:k.length?function(e,t){D.apply(e,P.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function de(e,t,n,r){var i,s,a,c,u,d,f,p=t&&t.ownerDocument,g=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==g&&9!==g&&11!==g)return n;if(!r&&((t?t.ownerDocument||t:A)!==_&&m(t),t=t||_,b)){if(11!==g&&(u=re.exec(e)))if(i=u[1]){if(9===g){if(!(a=t.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(p&&(a=p.getElementById(i))&&x(t,a)&&a.id===i)return n.push(a),n}else{if(u[2])return F.apply(n,t.getElementsByTagName(e)),n;if((i=u[3])&&o.getElementsByClassName&&t.getElementsByClassName)return F.apply(n,t.getElementsByClassName(i)),n}if(o.qsa&&!R[e+" "]&&(!y||!y.test(e))&&(1!==g||"object"!==t.nodeName.toLowerCase())){if(f=e,p=t,1===g&&X.test(e)){for((c=t.getAttribute("id"))?c=c.replace(ae,ce):t.setAttribute("id",c=E),s=(d=l(e)).length;s--;)d[s]="#"+c+" "+xe(d[s]);f=d.join(","),p=ie.test(e)&&Se(t.parentNode)||t}try{return F.apply(n,p.querySelectorAll(f)),n}catch(t){R(e,!0)}finally{c===E&&t.removeAttribute("id")}}}return h(e.replace(W,"$1"),t,n,r)}function he(){var e=[];return function t(n,r){return e.push(n+" ")>a.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function fe(e){return e[E]=!0,e}function pe(e){var t=_.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ge(e,t){for(var n=e.split("|"),r=n.length;r--;)a.attrHandle[n[r]]=t}function me(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function _e(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function ve(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function be(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&le(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function ye(e){return fe(function(t){return t=+t,fe(function(n,r){for(var i,s=e([],n.length,t),o=s.length;o--;)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function Se(e){return e&&void 0!==e.getElementsByTagName&&e}for(s in o=de.support={},u=de.isXML=function(e){var t=e.namespaceURI,n=(e.ownerDocument||e).documentElement;return!K.test(t||n&&n.nodeName||"HTML")},m=de.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:A;return r!==_&&9===r.nodeType&&r.documentElement?(v=(_=r).documentElement,b=!u(_),A!==_&&(n=_.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",ue,!1):n.attachEvent&&n.attachEvent("onunload",ue)),o.attributes=pe(function(e){return e.className="i",!e.getAttribute("className")}),o.getElementsByTagName=pe(function(e){return e.appendChild(_.createComment("")),!e.getElementsByTagName("*").length}),o.getElementsByClassName=ne.test(_.getElementsByClassName),o.getById=pe(function(e){return v.appendChild(e).id=E,!_.getElementsByName||!_.getElementsByName(E).length}),o.getById?(a.filter.ID=function(e){var t=e.replace(se,oe);return function(e){return e.getAttribute("id")===t}},a.find.ID=function(e,t){if(void 0!==t.getElementById&&b){var n=t.getElementById(e);return n?[n]:[]}}):(a.filter.ID=function(e){var t=e.replace(se,oe);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},a.find.ID=function(e,t){if(void 0!==t.getElementById&&b){var n,r,i,s=t.getElementById(e);if(s){if((n=s.getAttributeNode("id"))&&n.value===e)return[s];for(i=t.getElementsByName(e),r=0;s=i[r++];)if((n=s.getAttributeNode("id"))&&n.value===e)return[s]}return[]}}),a.find.TAG=o.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):o.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){for(;n=s[i++];)1===n.nodeType&&r.push(n);return r}return s},a.find.CLASS=o.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&b)return t.getElementsByClassName(e)},S=[],y=[],(o.qsa=ne.test(_.querySelectorAll))&&(pe(function(e){v.appendChild(e).innerHTML="<a id='"+E+"'></a><select id='"+E+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&y.push("[*^$]="+B+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||y.push("\\["+B+"*(?:value|"+z+")"),e.querySelectorAll("[id~="+E+"-]").length||y.push("~="),e.querySelectorAll(":checked").length||y.push(":checked"),e.querySelectorAll("a#"+E+"+*").length||y.push(".#.+[+~]")}),pe(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=_.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&y.push("name"+B+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&y.push(":enabled",":disabled"),v.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&y.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),y.push(",.*:")})),(o.matchesSelector=ne.test(w=v.matches||v.webkitMatchesSelector||v.mozMatchesSelector||v.oMatchesSelector||v.msMatchesSelector))&&pe(function(e){o.disconnectedMatch=w.call(e,"*"),w.call(e,"[s!='']:x"),S.push("!=",$)}),y=y.length&&new RegExp(y.join("|")),S=S.length&&new RegExp(S.join("|")),t=ne.test(v.compareDocumentPosition),x=t||ne.test(v.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},M=t?function(e,t){if(e===t)return g=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!o.sortDetached&&t.compareDocumentPosition(e)===n?e===_||e.ownerDocument===A&&x(A,e)?-1:t===_||t.ownerDocument===A&&x(A,t)?1:p?U(p,e)-U(p,t):0:4&n?-1:1)}:function(e,t){if(e===t)return g=!0,0;var n,r=0,i=e.parentNode,s=t.parentNode,o=[e],a=[t];if(!i||!s)return e===_?-1:t===_?1:i?-1:s?1:p?U(p,e)-U(p,t):0;if(i===s)return me(e,t);for(n=e;n=n.parentNode;)o.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;o[r]===a[r];)r++;return r?me(o[r],a[r]):o[r]===A?-1:a[r]===A?1:0},_):_},de.matches=function(e,t){return de(e,null,null,t)},de.matchesSelector=function(e,t){if((e.ownerDocument||e)!==_&&m(e),o.matchesSelector&&b&&!R[t+" "]&&(!S||!S.test(t))&&(!y||!y.test(t)))try{var n=w.call(e,t);if(n||o.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){R(t,!0)}return de(t,_,null,[e]).length>0},de.contains=function(e,t){return(e.ownerDocument||e)!==_&&m(e),x(e,t)},de.attr=function(e,t){(e.ownerDocument||e)!==_&&m(e);var n=a.attrHandle[t.toLowerCase()],r=n&&I.call(a.attrHandle,t.toLowerCase())?n(e,t,!b):void 0;return void 0!==r?r:o.attributes||!b?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},de.escape=function(e){return(e+"").replace(ae,ce)},de.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},de.uniqueSort=function(e){var t,n=[],r=0,i=0;if(g=!o.detectDuplicates,p=!o.sortStable&&e.slice(0),e.sort(M),g){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return p=null,e},c=de.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=c(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=c(t);return n},(a=de.selectors={cacheLength:50,createPseudo:fe,match:Z,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(se,oe),e[3]=(e[3]||e[4]||e[5]||"").replace(se,oe),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||de.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&de.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return Z.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&V.test(n)&&(t=l(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(se,oe).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=new RegExp("(^|"+B+")"+e+"("+B+"|$)"))&&C(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=de.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(G," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,c){var u,l,d,h,f,p,g=s!==o?"nextSibling":"previousSibling",m=t.parentNode,_=a&&t.nodeName.toLowerCase(),v=!c&&!a,b=!1;if(m){if(s){for(;g;){for(h=t;h=h[g];)if(a?h.nodeName.toLowerCase()===_:1===h.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[o?m.firstChild:m.lastChild],o&&v){for(b=(f=(u=(l=(d=(h=m)[E]||(h[E]={}))[h.uniqueID]||(d[h.uniqueID]={}))[e]||[])[0]===j&&u[1])&&u[2],h=f&&m.childNodes[f];h=++f&&h&&h[g]||(b=f=0)||p.pop();)if(1===h.nodeType&&++b&&h===t){l[e]=[j,f,b];break}}else if(v&&(b=f=(u=(l=(d=(h=t)[E]||(h[E]={}))[h.uniqueID]||(d[h.uniqueID]={}))[e]||[])[0]===j&&u[1]),!1===b)for(;(h=++f&&h&&h[g]||(b=f=0)||p.pop())&&((a?h.nodeName.toLowerCase()!==_:1!==h.nodeType)||!++b||(v&&((l=(d=h[E]||(h[E]={}))[h.uniqueID]||(d[h.uniqueID]={}))[e]=[j,b]),h!==t)););return(b-=i)===r||b%r==0&&b/r>=0}}},PSEUDO:function(e,t){var n,r=a.pseudos[e]||a.setFilters[e.toLowerCase()]||de.error("unsupported pseudo: "+e);return r[E]?r(t):r.length>1?(n=[e,e,"",t],a.setFilters.hasOwnProperty(e.toLowerCase())?fe(function(e,n){for(var i,s=r(e,t),o=s.length;o--;)e[i=U(e,s[o])]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:fe(function(e){var t=[],n=[],r=d(e.replace(W,"$1"));return r[E]?fe(function(e,t,n,i){for(var s,o=r(e,null,i,[]),a=e.length;a--;)(s=o[a])&&(e[a]=!(t[a]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),t[0]=null,!n.pop()}}),has:fe(function(e){return function(t){return de(e,t).length>0}}),contains:fe(function(e){return e=e.replace(se,oe),function(t){return(t.textContent||c(t)).indexOf(e)>-1}}),lang:fe(function(e){return Q.test(e||"")||de.error("unsupported lang: "+e),e=e.replace(se,oe).toLowerCase(),function(t){var n;do{if(n=b?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(e){var t=i.location&&i.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===v},focus:function(e){return e===_.activeElement&&(!_.hasFocus||_.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:be(!1),disabled:be(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!a.pseudos.empty(e)},header:function(e){return te.test(e.nodeName)},input:function(e){return ee.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ye(function(){return[0]}),last:ye(function(e,t){return[t-1]}),eq:ye(function(e,t,n){return[n<0?n+t:n]}),even:ye(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ye(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ye(function(e,t,n){for(var r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e}),gt:ye(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=a.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})a.pseudos[s]=_e(s);for(s in{submit:!0,reset:!0})a.pseudos[s]=ve(s);function we(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function Ee(e,t,n){var r=t.dir,i=t.next,s=i||r,o=n&&"parentNode"===s,a=N++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,i);return!1}:function(t,n,c){var u,l,d,h=[j,a];if(c){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,c))return!0}else for(;t=t[r];)if(1===t.nodeType||o)if(l=(d=t[E]||(t[E]={}))[t.uniqueID]||(d[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((u=l[s])&&u[0]===j&&u[1]===a)return h[2]=u[2];if(l[s]=h,h[2]=e(t,n,c))return!0}return!1}}function Ae(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function je(e,t,n,r,i){for(var s,o=[],a=0,c=e.length,u=null!=t;a<c;a++)(s=e[a])&&(n&&!n(s,r,i)||(o.push(s),u&&t.push(a)));return o}function Ne(e,t,n,r,i,s){return r&&!r[E]&&(r=Ne(r)),i&&!i[E]&&(i=Ne(i,s)),fe(function(s,o,a,c){var u,l,d,h=[],f=[],p=o.length,g=s||function(e,t,n){for(var r=0,i=t.length;r<i;r++)de(e,t[r],n);return n}(t||"*",a.nodeType?[a]:a,[]),m=!e||!s&&t?g:je(g,h,e,a,c),_=n?i||(s?e:p||r)?[]:o:m;if(n&&n(m,_,a,c),r)for(u=je(_,f),r(u,[],a,c),l=u.length;l--;)(d=u[l])&&(_[f[l]]=!(m[f[l]]=d));if(s){if(i||e){if(i){for(u=[],l=_.length;l--;)(d=_[l])&&u.push(m[l]=d);i(null,_=[],u,c)}for(l=_.length;l--;)(d=_[l])&&(u=i?U(s,d):h[l])>-1&&(s[u]=!(o[u]=d))}}else _=je(_===o?_.splice(p,_.length):_),i?i(null,o,_,c):F.apply(o,_)})}function Ce(e){for(var t,n,r,i=e.length,s=a.relative[e[0].type],o=s||a.relative[" "],c=s?1:0,u=Ee(function(e){return e===t},o,!0),l=Ee(function(e){return U(t,e)>-1},o,!0),d=[function(e,n,r){var i=!s&&(r||n!==f)||((t=n).nodeType?u(e,n,r):l(e,n,r));return t=null,i}];c<i;c++)if(n=a.relative[e[c].type])d=[Ee(Ae(d),n)];else{if((n=a.filter[e[c].type].apply(null,e[c].matches))[E]){for(r=++c;r<i&&!a.relative[e[r].type];r++);return Ne(c>1&&Ae(d),c>1&&xe(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(W,"$1"),n,c<r&&Ce(e.slice(c,r)),r<i&&Ce(e=e.slice(r)),r<i&&xe(e))}d.push(n)}return Ae(d)}we.prototype=a.filters=a.pseudos,a.setFilters=new we,l=de.tokenize=function(e,t){var n,r,i,s,o,c,u,l=O[e+" "];if(l)return t?0:l.slice(0);for(o=e,c=[],u=a.preFilter;o;){for(s in n&&!(r=J.exec(o))||(r&&(o=o.slice(r[0].length)||o),c.push(i=[])),n=!1,(r=Y.exec(o))&&(n=r.shift(),i.push({value:n,type:r[0].replace(W," ")}),o=o.slice(n.length)),a.filter)!(r=Z[s].exec(o))||u[s]&&!(r=u[s](r))||(n=r.shift(),i.push({value:n,type:s,matches:r}),o=o.slice(n.length));if(!n)break}return t?o.length:o?de.error(e):O(e,c).slice(0)},d=de.compile=function(e,t){var n,r=[],i=[],s=T[e+" "];if(!s){for(t||(t=l(e)),n=t.length;n--;)(s=Ce(t[n]))[E]?r.push(s):i.push(s);(s=T(e,function(e,t){var n=t.length>0,r=e.length>0,i=function(i,s,o,c,u){var l,d,h,p=0,g="0",v=i&&[],y=[],S=f,w=i||r&&a.find.TAG("*",u),x=j+=null==S?1:Math.random()||.1,E=w.length;for(u&&(f=s===_||s||u);g!==E&&null!=(l=w[g]);g++){if(r&&l){for(d=0,s||l.ownerDocument===_||(m(l),o=!b);h=e[d++];)if(h(l,s||_,o)){c.push(l);break}u&&(j=x)}n&&((l=!h&&l)&&p--,i&&v.push(l))}if(p+=g,n&&g!==p){for(d=0;h=t[d++];)h(v,y,s,o);if(i){if(p>0)for(;g--;)v[g]||y[g]||(y[g]=L.call(c));y=je(y)}F.apply(c,y),u&&!i&&y.length>0&&p+t.length>1&&de.uniqueSort(c)}return u&&(j=x,f=S),v};return n?fe(i):i}(i,r))).selector=e}return s},h=de.select=function(e,t,n,r){var i,s,o,c,u,h="function"==typeof e&&e,f=!r&&l(e=h.selector||e);if(n=n||[],1===f.length){if((s=f[0]=f[0].slice(0)).length>2&&"ID"===(o=s[0]).type&&9===t.nodeType&&b&&a.relative[s[1].type]){if(!(t=(a.find.ID(o.matches[0].replace(se,oe),t)||[])[0]))return n;h&&(t=t.parentNode),e=e.slice(s.shift().value.length)}for(i=Z.needsContext.test(e)?0:s.length;i--&&(o=s[i],!a.relative[c=o.type]);)if((u=a.find[c])&&(r=u(o.matches[0].replace(se,oe),ie.test(s[0].type)&&Se(t.parentNode)||t))){if(s.splice(i,1),!(e=r.length&&xe(s)))return F.apply(n,r),n;break}}return(h||d(e,f))(r,t,!b,n,!t||ie.test(e)&&Se(t.parentNode)||t),n},o.sortStable=E.split("").sort(M).join("")===E,o.detectDuplicates=!!g,m(),o.sortDetached=pe(function(e){return 1&e.compareDocumentPosition(_.createElement("fieldset"))}),pe(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||ge("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),o.attributes&&pe(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||ge("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),pe(function(e){return null==e.getAttribute("disabled")})||ge(z,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null});var Oe=i.Sizzle;de.noConflict=function(){return i.Sizzle===de&&(i.Sizzle=Oe),de},void 0===(r=function(){return de}.call(t,n,t,e))||(e.exports=r)}(window)},function(e,t,n){var r=n(49),i="object"==typeof self&&self&&self.Object===Object&&self,s=r||i||Function("return this")();e.exports=s},function(e,t){var n=Array.isArray;e.exports=n},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){(function(r){var i,s,o;o="object"==typeof self&&self.self===self&&self||"object"==typeof r&&r.global===r&&r,i=[n(48),n(231),t],void 0===(s=function(e,t,n){o.Backbone=function(e,t,n,r){var i=e.Backbone,s=Array.prototype.slice;t.VERSION="1.4.0",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o,a=t.Events={},c=/\s+/,u=function(e,t,r,i,s){var o,a=0;if(r&&"object"==typeof r){void 0!==i&&"context"in s&&void 0===s.context&&(s.context=i);for(o=n.keys(r);a<o.length;a++)t=u(e,t,o[a],r[o[a]],s)}else if(r&&c.test(r))for(o=r.split(c);a<o.length;a++)t=e(t,o[a],i,s);else t=e(t,r,i,s);return t};a.on=function(e,t,n){if(this._events=u(l,this._events||{},e,t,{context:n,ctx:this,listening:o}),o){var r=this._listeners||(this._listeners={});r[o.id]=o,o.interop=!1}return this},a.listenTo=function(e,t,r){if(!e)return this;var i=e._listenId||(e._listenId=n.uniqueId("l")),s=this._listeningTo||(this._listeningTo={}),a=o=s[i];a||(this._listenId||(this._listenId=n.uniqueId("l")),a=o=s[i]=new m(this,e));var c=d(e,t,r,this);if(o=void 0,c)throw c;return a.interop&&a.on(t,r),this};var l=function(e,t,n,r){if(n){var i=e[t]||(e[t]=[]),s=r.context,o=r.ctx,a=r.listening;a&&a.count++,i.push({callback:n,context:s,ctx:s||o,listening:a})}return e},d=function(e,t,n,r){try{e.on(t,n,r)}catch(e){return e}};a.off=function(e,t,n){return this._events?(this._events=u(h,this._events,e,t,{context:n,listeners:this._listeners}),this):this},a.stopListening=function(e,t,r){var i=this._listeningTo;if(!i)return this;for(var s=e?[e._listenId]:n.keys(i),o=0;o<s.length;o++){var a=i[s[o]];if(!a)break;a.obj.off(t,r,this),a.interop&&a.off(t,r)}return n.isEmpty(i)&&(this._listeningTo=void 0),this};var h=function(e,t,r,i){if(e){var s,o=i.context,a=i.listeners,c=0;if(t||o||r){for(s=t?[t]:n.keys(e);c<s.length;c++){t=s[c];var u=e[t];if(!u)break;for(var l=[],d=0;d<u.length;d++){var h=u[d];if(r&&r!==h.callback&&r!==h.callback._callback||o&&o!==h.context)l.push(h);else{var f=h.listening;f&&f.off(t,r)}}l.length?e[t]=l:delete e[t]}return e}for(s=n.keys(a);c<s.length;c++)a[s[c]].cleanup()}};a.once=function(e,t,n){var r=u(f,{},e,t,this.off.bind(this));return"string"==typeof e&&null==n&&(t=void 0),this.on(r,t,n)},a.listenToOnce=function(e,t,n){var r=u(f,{},t,n,this.stopListening.bind(this,e));return this.listenTo(e,r)};var f=function(e,t,r,i){if(r){var s=e[t]=n.once(function(){i(t,s),r.apply(this,arguments)});s._callback=r}return e};a.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),n=Array(t),r=0;r<t;r++)n[r]=arguments[r+1];return u(p,this._events,e,void 0,n),this};var p=function(e,t,n,r){if(e){var i=e[t],s=e.all;i&&s&&(s=s.slice()),i&&g(i,r),s&&g(s,[t].concat(r))}return e},g=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],a=t[2];switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,s);return;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,s,o,a);return;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t);return}},m=function(e,t){this.id=e._listenId,this.listener=e,this.obj=t,this.interop=!0,this.count=0,this._events=void 0};m.prototype.on=a.on,m.prototype.off=function(e,t){var n;this.interop?(this._events=u(h,this._events,e,t,{context:void 0,listeners:void 0}),n=!this._events):(this.count--,n=0===this.count),n&&this.cleanup()},m.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},a.bind=a.on,a.unbind=a.off,n.extend(t,a);var _=t.Model=function(e,t){var r=e||{};t||(t={}),this.preinitialize.apply(this,arguments),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{});var i=n.result(this,"defaults");r=n.defaults(n.extend({},i,r),i),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(_.prototype,a,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!n.iteratee(e,this)(this.attributes)},set:function(e,t,r){if(null==e)return this;var i;if("object"==typeof e?(i=e,r=t):(i={})[e]=t,r||(r={}),!this._validate(i,r))return!1;var s=r.unset,o=r.silent,a=[],c=this._changing;this._changing=!0,c||(this._previousAttributes=n.clone(this.attributes),this.changed={});var u=this.attributes,l=this.changed,d=this._previousAttributes;for(var h in i)t=i[h],n.isEqual(u[h],t)||a.push(h),n.isEqual(d[h],t)?delete l[h]:l[h]=t,s?delete u[h]:u[h]=t;if(this.idAttribute in i&&(this.id=this.get(this.idAttribute)),!o){a.length&&(this._pending=r);for(var f=0;f<a.length;f++)this.trigger("change:"+a[f],this,u[a[f]],r)}if(c)return this;if(!o)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&n.clone(this.changed);var t,r=this._changing?this._previousAttributes:this.attributes,i={};for(var s in e){var o=e[s];n.isEqual(r[s],o)||(i[s]=o,t=!0)}return!!t&&i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=n.extend({parse:!0},e);var t=this,r=e.success;return e.success=function(n){var i=e.parse?t.parse(n,e):n;if(!t.set(i,e))return!1;r&&r.call(e.context,t,n,e),t.trigger("sync",t,n,e)},$(this,e),this.sync("read",this,e)},save:function(e,t,r){var i;null==e||"object"==typeof e?(i=e,r=t):(i={})[e]=t;var s=(r=n.extend({validate:!0,parse:!0},r)).wait;if(i&&!s){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;var o=this,a=r.success,c=this.attributes;r.success=function(e){o.attributes=c;var t=r.parse?o.parse(e,r):e;if(s&&(t=n.extend({},i,t)),t&&!o.set(t,r))return!1;a&&a.call(r.context,o,e,r),o.trigger("sync",o,e,r)},$(this,r),i&&s&&(this.attributes=n.extend({},c,i));var u=this.isNew()?"create":r.patch?"patch":"update";"patch"!==u||r.attrs||(r.attrs=i);var l=this.sync(u,this,r);return this.attributes=c,l},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=e.wait,s=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){i&&s(),r&&r.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};var o=!1;return this.isNew()?n.defer(e.success):($(this,e),o=this.sync("delete",this,e)),i||s(),o},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||q();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return!r||(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1)}});var v=t.Collection=function(e,t){t||(t={}),this.preinitialize.apply(this,arguments),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},b={add:!0,remove:!0,merge:!0},y={add:!0,remove:!1},S=function(e,t,n){n=Math.min(Math.max(n,0),e.length);var r,i=Array(e.length-n),s=t.length;for(r=0;r<i.length;r++)i[r]=e[r+n];for(r=0;r<s;r++)e[r+n]=t[r];for(r=0;r<i.length;r++)e[r+s+n]=i[r]};n.extend(v.prototype,a,{model:_,preinitialize:function(){},initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,y))},remove:function(e,t){t=n.extend({},t);var r=!n.isArray(e);e=r?[e]:e.slice();var i=this._removeModels(e,t);return!t.silent&&i.length&&(t.changes={added:[],merged:[],removed:i},this.trigger("update",this,t)),r?i[0]:i},set:function(e,t){if(null!=e){(t=n.extend({},b,t)).parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);var r=!n.isArray(e);e=r?[e]:e.slice();var i=t.at;null!=i&&(i=+i),i>this.length&&(i=this.length),i<0&&(i+=this.length+1);var s,o,a=[],c=[],u=[],l=[],d={},h=t.add,f=t.merge,p=t.remove,g=!1,m=this.comparator&&null==i&&!1!==t.sort,_=n.isString(this.comparator)?this.comparator:null;for(o=0;o<e.length;o++){s=e[o];var v=this.get(s);if(v){if(f&&s!==v){var y=this._isModel(s)?s.attributes:s;t.parse&&(y=v.parse(y,t)),v.set(y,t),u.push(v),m&&!g&&(g=v.hasChanged(_))}d[v.cid]||(d[v.cid]=!0,a.push(v)),e[o]=v}else h&&(s=e[o]=this._prepareModel(s,t))&&(c.push(s),this._addReference(s,t),d[s.cid]=!0,a.push(s))}if(p){for(o=0;o<this.length;o++)s=this.models[o],d[s.cid]||l.push(s);l.length&&this._removeModels(l,t)}var w=!1,x=!m&&h&&p;if(a.length&&x?(w=this.length!==a.length||n.some(this.models,function(e,t){return e!==a[t]}),this.models.length=0,S(this.models,a,0),this.length=this.models.length):c.length&&(m&&(g=!0),S(this.models,c,null==i?this.length:i),this.length=this.models.length),g&&this.sort({silent:!0}),!t.silent){for(o=0;o<c.length;o++)null!=i&&(t.index=i+o),(s=c[o]).trigger("add",s,this,t);(g||w)&&this.trigger("sort",this,t),(c.length||l.length||u.length)&&(t.changes={added:c,removed:l,merged:u},this.trigger("update",this,t))}return r?e[0]:e}},reset:function(e,t){t=t?n.clone(t):{};for(var r=0;r<this.models.length;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return s.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[this.modelId(this._isModel(e)?e.attributes:e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var r=t.length;return n.isFunction(t)&&(t=t.bind(this)),1===r||n.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){var t=(e=n.extend({parse:!0},e)).success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t.call(e.context,r,n,e),r.trigger("sync",r,n,e)},$(this,e),this.sync("read",this,e)},create:function(e,t){var r=(t=t?n.clone(t):{}).wait;if(!(e=this._prepareModel(e,t)))return!1;r||this.add(e,t);var i=this,s=t.success;return t.success=function(e,t,n){r&&i.add(e,n),s&&s.call(n.context,e,t,n)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},values:function(){return new x(this,E)},keys:function(){return new x(this,A)},entries:function(){return new x(this,j)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;(t=t?n.clone(t):{}).collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_removeModels:function(e,t){for(var n=[],r=0;r<e.length;r++){var i=this.get(e[r]);if(i){var s=this.indexOf(i);this.models.splice(s,1),this.length--,delete this._byId[i.cid];var o=this.modelId(i.attributes);null!=o&&delete this._byId[o],t.silent||(t.index=s,i.trigger("remove",i,this,t)),n.push(i),this._removeReference(i,t)}}return n},_isModel:function(e){return e instanceof _},_addReference:function(e,t){this._byId[e.cid]=e;var n=this.modelId(e.attributes);null!=n&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var n=this.modelId(e.attributes);null!=n&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if(t){if(("add"===e||"remove"===e)&&n!==this)return;if("destroy"===e&&this.remove(t,r),"change"===e){var i=this.modelId(t.previousAttributes()),s=this.modelId(t.attributes);i!==s&&(null!=i&&delete this._byId[i],null!=s&&(this._byId[s]=t))}}this.trigger.apply(this,arguments)}});var w="function"==typeof Symbol&&Symbol.iterator;w&&(v.prototype[w]=v.prototype.values);var x=function(e,t){this._collection=e,this._kind=t,this._index=0},E=1,A=2,j=3;w&&(x.prototype[w]=function(){return this}),x.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var e,t=this._collection.at(this._index);if(this._index++,this._kind===E)e=t;else{var n=this._collection.modelId(t.attributes);e=this._kind===A?n:[n,t]}return{value:e,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var N=t.View=function(e){this.cid=n.uniqueId("view"),this.preinitialize.apply(this,arguments),n.extend(this,n.pick(e,O)),this._ensureElement(),this.initialize.apply(this,arguments)},C=/^(\S+)\s*(.*)$/,O=["model","collection","el","id","attributes","className","tagName","events"];n.extend(N.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=n.result(this,"events")),!e)return this;for(var t in this.undelegateEvents(),e){var r=e[t];if(n.isFunction(r)||(r=this[r]),r){var i=t.match(C);this.delegate(i[1],i[2],r.bind(this))}}return this},delegate:function(e,t,n){return this.$el.on(e+".delegateEvents"+this.cid,t,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){return this.$el.off(e+".delegateEvents"+this.cid,t,n),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e.class=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}});var T=function(e,t,r,i){n.each(r,function(n,r){t[r]&&(e.prototype[r]=function(e,t,n,r){switch(t){case 1:return function(){return e[n](this[r])};case 2:return function(t){return e[n](this[r],t)};case 3:return function(t,i){return e[n](this[r],R(t,this),i)};case 4:return function(t,i,s){return e[n](this[r],R(t,this),i,s)};default:return function(){var t=s.call(arguments);return t.unshift(this[r]),e[n].apply(e,t)}}}(t,n,r,i))})},R=function(e,t){return n.isFunction(e)?e:n.isObject(e)&&!t._isModel(e)?M(e):n.isString(e)?function(t){return t.get(e)}:e},M=function(e){var t=n.matches(e);return function(e){return t(e.attributes)}};n.each([[v,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models"],[_,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes"]],function(e){var t=e[0],r=e[1],i=e[2];t.mixin=function(e){var r=n.reduce(n.functions(e),function(e,t){return e[t]=0,e},{});T(t,e,r,i)},T(t,n,r,i)}),t.sync=function(e,r,i){var s=I[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};if(i.url||(o.url=n.result(r,"url")||q()),null!=i.data||!r||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),i.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",i.emulateJSON&&(o.data._method=s);var a=i.beforeSend;i.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",s),a)return a.apply(this,arguments)}}"GET"===o.type||i.emulateJSON||(o.processData=!1);var c=i.error;i.error=function(e,t,n){i.textStatus=t,i.errorThrown=n,c&&c.call(i.context,e,t,n)};var u=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,u,i),u};var I={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var k=t.Router=function(e){e||(e={}),this.preinitialize.apply(this,arguments),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},L=/\((.*?)\)/g,D=/(\(\?)?:\w+/g,F=/\*\w+/g,P=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(k.prototype,a,{preinitialize:function(){},initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);!1!==s.execute(i,o,r)&&(s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(P,"\\$&").replace(L,"(?:$1)?").replace(D,function(e,t){return t?e:"([^/?]+)"}).replace(F,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var U=t.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},z=/^[#\/]|\s+$/g,B=/^\/+|\/+$/g,H=/#.*$/;U.started=!1,n.extend(U.prototype,a,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(z,"")},start:function(e){if(U.started)throw new Error("Backbone.history has already been started");if(U.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(B,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var r=document.body,i=r.insertBefore(this.iframe,r.firstChild).contentWindow;i.document.open(),i.document.close(),i.location.hash="#"+this.fragment}var s=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};if(this._usePushState?s("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?s("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),U.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),n.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(e,t){if(!U.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");var n=this.root;""!==e&&"?"!==e.charAt(0)||(n=n.slice(0,-1)||"/");var r=n+e;e=e.replace(H,"");var i=this.decodeFragment(e);if(this.fragment!==i){if(this.fragment=i,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var s=this.iframe.contentWindow;t.replace||(s.document.open(),s.document.close()),this._updateHash(s.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new U,_.extend=v.extend=k.extend=N.extend=U.extend=function(e,t){var r,i=this;return r=e&&n.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},n.extend(r,i,t),r.prototype=n.create(i.prototype,e),r.prototype.constructor=r,r.__super__=i.prototype,r};var q=function(){throw new Error('A "url" property or function must be specified')},$=function(e,t){var n=t.error;t.error=function(r){n&&n.call(t.context,e,r,t),e.trigger("error",e,r,t)}};return t}(o,n,e,t)}.apply(t,i))||(e.exports=s)}).call(this,n(20))},function(e,t,n){var r=n(22),i=n(237),s=n(238),o="[object Null]",a="[object Undefined]",c=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?a:o:c&&c in Object(e)?i(e):s(e)}},function(e,t,n){var r=n(255),i=n(258);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},function(e,t,n){e.exports=function(){"use strict";var e="millisecond",t="second",n="minute",r="hour",i="day",s="week",o="month",a="quarter",c="year",u=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,l=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},h={s:d,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+d(r,2,"0")+":"+d(i,2,"0")},m:function(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,o),i=t-r<0,s=e.clone().add(n+(i?-1:1),o);return Number(-(n+(t-r)/(i?r-s:s-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(u){return{M:o,y:c,w:s,d:i,h:r,m:n,s:t,ms:e,Q:a}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},f={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},p="en",g={};g[p]=f;var m=function(e){return e instanceof y},_=function(e,t,n){var r;if(!e)return p;if("string"==typeof e)g[e]&&(r=e),t&&(g[e]=t,r=e);else{var i=e.name;g[i]=e,r=i}return n||(p=r),r},v=function(e,t,n){if(m(e))return e.clone();var r=t?"string"==typeof t?{format:t,pl:n}:t:{};return r.date=e,new y(r)},b=h;b.l=_,b.i=m,b.w=function(e,t){return v(e,{locale:t.$L,utc:t.$u})};var y=function(){function d(e){this.$L=this.$L||_(e.locale,null,!0),this.parse(e)}var h=d.prototype;return h.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(b.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(u);if(r)return n?new Date(Date.UTC(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)):new Date(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)}return new Date(t)}(e),this.init()},h.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},h.$utils=function(){return b},h.isValid=function(){return!("Invalid Date"===this.$d.toString())},h.isSame=function(e,t){var n=v(e);return this.startOf(t)<=n&&n<=this.endOf(t)},h.isAfter=function(e,t){return v(e)<this.startOf(t)},h.isBefore=function(e,t){return this.endOf(t)<v(e)},h.$g=function(e,t,n){return b.u(e)?this[t]:this.set(n,e)},h.year=function(e){return this.$g(e,"$y",c)},h.month=function(e){return this.$g(e,"$M",o)},h.day=function(e){return this.$g(e,"$W",i)},h.date=function(e){return this.$g(e,"$D","date")},h.hour=function(e){return this.$g(e,"$H",r)},h.minute=function(e){return this.$g(e,"$m",n)},h.second=function(e){return this.$g(e,"$s",t)},h.millisecond=function(t){return this.$g(t,"$ms",e)},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(e,a){var u=this,l=!!b.u(a)||a,d=b.p(e),h=function(e,t){var n=b.w(u.$u?Date.UTC(u.$y,t,e):new Date(u.$y,t,e),u);return l?n:n.endOf(i)},f=function(e,t){return b.w(u.toDate()[e].apply(u.toDate(),(l?[0,0,0,0]:[23,59,59,999]).slice(t)),u)},p=this.$W,g=this.$M,m=this.$D,_="set"+(this.$u?"UTC":"");switch(d){case c:return l?h(1,0):h(31,11);case o:return l?h(1,g):h(0,g+1);case s:var v=this.$locale().weekStart||0,y=(p<v?p+7:p)-v;return h(l?m-y:m+(6-y),g);case i:case"date":return f(_+"Hours",0);case r:return f(_+"Minutes",1);case n:return f(_+"Seconds",2);case t:return f(_+"Milliseconds",3);default:return this.clone()}},h.endOf=function(e){return this.startOf(e,!1)},h.$set=function(s,a){var u,l=b.p(s),d="set"+(this.$u?"UTC":""),h=(u={},u[i]=d+"Date",u.date=d+"Date",u[o]=d+"Month",u[c]=d+"FullYear",u[r]=d+"Hours",u[n]=d+"Minutes",u[t]=d+"Seconds",u[e]=d+"Milliseconds",u)[l],f=l===i?this.$D+(a-this.$W):a;if(l===o||l===c){var p=this.clone().set("date",1);p.$d[h](f),p.init(),this.$d=p.set("date",Math.min(this.$D,p.daysInMonth())).toDate()}else h&&this.$d[h](f);return this.init(),this},h.set=function(e,t){return this.clone().$set(e,t)},h.get=function(e){return this[b.p(e)]()},h.add=function(e,a){var u,l=this;e=Number(e);var d=b.p(a),h=function(t){var n=v(l);return b.w(n.date(n.date()+Math.round(t*e)),l)};if(d===o)return this.set(o,this.$M+e);if(d===c)return this.set(c,this.$y+e);if(d===i)return h(1);if(d===s)return h(7);var f=(u={},u[n]=6e4,u[r]=36e5,u[t]=1e3,u)[d]||1,p=this.valueOf()+e*f;return b.w(p,this)},h.subtract=function(e,t){return this.add(-1*e,t)},h.format=function(e){var t=this;if(!this.isValid())return"Invalid Date";var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=b.z(this),i=this.$locale(),s=this.$H,o=this.$m,a=this.$M,c=i.weekdays,u=i.months,d=function(e,r,i,s){return e&&(e[r]||e(t,n))||i[r].substr(0,s)},h=function(e){return b.s(s%12||12,e,"0")},f=i.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:b.s(a+1,2,"0"),MMM:d(i.monthsShort,a,u,3),MMMM:u[a]||u(this,n),D:this.$D,DD:b.s(this.$D,2,"0"),d:String(this.$W),dd:d(i.weekdaysMin,this.$W,c,2),ddd:d(i.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(s),HH:b.s(s,2,"0"),h:h(1),hh:h(2),a:f(s,o,!0),A:f(s,o,!1),m:String(o),mm:b.s(o,2,"0"),s:String(this.$s),ss:b.s(this.$s,2,"0"),SSS:b.s(this.$ms,3,"0"),Z:r};return n.replace(l,function(e,t){return t||p[e]||r.replace(":","")})},h.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},h.diff=function(e,u,l){var d,h=b.p(u),f=v(e),p=6e4*(f.utcOffset()-this.utcOffset()),g=this-f,m=b.m(this,f);return m=(d={},d[c]=m/12,d[o]=m,d[a]=m/3,d[s]=(g-p)/6048e5,d[i]=(g-p)/864e5,d[r]=g/36e5,d[n]=g/6e4,d[t]=g/1e3,d)[h]||g,l?m:b.a(m)},h.daysInMonth=function(){return this.endOf(o).$D},h.$locale=function(){return g[this.$L]},h.locale=function(e,t){if(!e)return this.$L;var n=this.clone();return n.$L=_(e,t,!0),n},h.clone=function(){return b.w(this.toDate(),this)},h.toDate=function(){return new Date(this.$d)},h.toJSON=function(){return this.toISOString()},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},d}();return v.prototype=y.prototype,v.extend=function(e,t){return e(t,y,v),v},v.locale=_,v.isDayjs=m,v.unix=function(e){return v(1e3*e)},v.en=g[p],v.Ls=g,v}()},function(e,t,n){var r=n(31),i=n(35);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},function(e,t,n){var r=n(51),i=n(55),s=n(12);e.exports=function(e){return s(e)?r(e):i(e)}},function(e,t,n){var r=n(66),i=n(12),s=n(67),o=n(34),a=n(46),c=Math.max;e.exports=function(e,t,n,u){e=i(e)?e:a(e),n=n&&!u?o(n):0;var l=e.length;return n<0&&(n=c(l+n,0)),s(e)?n<=l&&e.indexOf(t,n)>-1:!!l&&r(e,t,n)>-1}},function(e,t){var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var i=typeof e;return!!(t=null==t?n:t)&&("number"==i||"symbol"!=i&&r.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(21),i=1/0;e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}},function(e,t,n){e.exports=n(239)},function(e,t,n){e.exports=n(253)},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(9),i=n(7),s="[object Symbol]";e.exports=function(e){return"symbol"==typeof e||i(e)&&r(e)==s}},function(e,t,n){var r=n(4).Symbol;e.exports=r},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(38),i=n(6);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=r(e.prototype),s=e.apply(n,t);return i(s)?s:n}}},function(e,t){var n="__lodash_placeholder__";e.exports=function(e,t){for(var r=-1,i=e.length,s=0,o=[];++r<i;){var a=e[r];a!==t&&a!==n||(e[r]=n,o[s++]=r)}return o}},function(e,t,n){var r=n(290),i=n(291),s=n(292),o=n(293),a=n(294);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=s,c.prototype.has=o,c.prototype.set=a,e.exports=c},function(e,t,n){var r=n(23);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(10)(Object,"create");e.exports=r},function(e,t,n){var r=n(308);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(5),i=n(45),s=n(331),o=n(90);e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:s(o(e))}},function(e,t,n){var r=n(9),i=n(6),s="[object AsyncFunction]",o="[object Function]",a="[object GeneratorFunction]",c="[object Proxy]";e.exports=function(e){if(!i(e))return!1;var t=r(e);return t==o||t==a||t==s||t==c}},function(e,t,n){
/**
 * @preserve jed.js https://github.com/SlexAxton/Jed
 */
!function(n,r){var i=Array.prototype,s=Object.prototype,o=i.slice,a=s.hasOwnProperty,c=i.forEach,u={},l={forEach:function(e,t,n){var r,i,s;if(null!==e)if(c&&e.forEach===c)e.forEach(t,n);else if(e.length===+e.length){for(r=0,i=e.length;r<i;r++)if(r in e&&t.call(n,e[r],r,e)===u)return}else for(s in e)if(a.call(e,s)&&t.call(n,e[s],s,e)===u)return},extend:function(e){return this.forEach(o.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e}},d=function(e){if(this.defaults={locale_data:{messages:{"":{domain:"messages",lang:"en",plural_forms:"nplurals=2; plural=(n != 1);"}}},domain:"messages",debug:!1},this.options=l.extend({},this.defaults,e),this.textdomain(this.options.domain),e.domain&&!this.options.locale_data[this.options.domain])throw new Error("Text domain set to non-existent domain: `"+e.domain+"`")};function h(e){return d.PF.compile(e||"nplurals=2; plural=(n != 1);")}function f(e,t){this._key=e,this._i18n=t}d.context_delimiter=String.fromCharCode(4),l.extend(f.prototype,{onDomain:function(e){return this._domain=e,this},withContext:function(e){return this._context=e,this},ifPlural:function(e,t){return this._val=e,this._pkey=t,this},fetch:function(e){return"[object Array]"!={}.toString.call(e)&&(e=[].slice.call(arguments,0)),(e&&e.length?d.sprintf:function(e){return e})(this._i18n.dcnpgettext(this._domain,this._context,this._key,this._pkey,this._val),e)}}),l.extend(d.prototype,{translate:function(e){return new f(e,this)},textdomain:function(e){if(!e)return this._textdomain;this._textdomain=e},gettext:function(e){return this.dcnpgettext.call(this,void 0,void 0,e)},dgettext:function(e,t){return this.dcnpgettext.call(this,e,void 0,t)},dcgettext:function(e,t){return this.dcnpgettext.call(this,e,void 0,t)},ngettext:function(e,t,n){return this.dcnpgettext.call(this,void 0,void 0,e,t,n)},dngettext:function(e,t,n,r){return this.dcnpgettext.call(this,e,void 0,t,n,r)},dcngettext:function(e,t,n,r){return this.dcnpgettext.call(this,e,void 0,t,n,r)},pgettext:function(e,t){return this.dcnpgettext.call(this,void 0,e,t)},dpgettext:function(e,t,n){return this.dcnpgettext.call(this,e,t,n)},dcpgettext:function(e,t,n){return this.dcnpgettext.call(this,e,t,n)},npgettext:function(e,t,n,r){return this.dcnpgettext.call(this,void 0,e,t,n,r)},dnpgettext:function(e,t,n,r,i){return this.dcnpgettext.call(this,e,t,n,r,i)},dcnpgettext:function(e,t,n,r,i){var s;if(r=r||n,e=e||this._textdomain,!this.options)return(s=new d).dcnpgettext.call(s,void 0,void 0,n,r,i);if(!this.options.locale_data)throw new Error("No locale data provided.");if(!this.options.locale_data[e])throw new Error("Domain `"+e+"` was not found.");if(!this.options.locale_data[e][""])throw new Error("No locale meta information provided.");if(!n)throw new Error("No translation key found.");var o,a,c,u=t?t+d.context_delimiter+n:n,l=this.options.locale_data,f=l[e],p=(l.messages||this.defaults.locale_data.messages)[""],g=f[""].plural_forms||f[""]["Plural-Forms"]||f[""]["plural-forms"]||p.plural_forms||p["Plural-Forms"]||p["plural-forms"];if(void 0===i)c=0;else{if("number"!=typeof i&&(i=parseInt(i,10),isNaN(i)))throw new Error("The number that was passed in is not a number.");c=h(g)(i)}if(!f)throw new Error("No domain named `"+e+"` could be found.");return!(o=f[u])||c>o.length?(this.options.missing_key_callback&&this.options.missing_key_callback(u,e),a=[n,r],!0===this.options.debug&&console.log(a[h(g)(i)]),a[h()(i)]):(a=o[c])||(a=[n,r])[h()(i)]}});var p,g,m=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.format=function(n,r){var i,s,o,a,c,u,l,d=1,h=n.length,f="",p=[];for(s=0;s<h;s++)if("string"===(f=e(n[s])))p.push(n[s]);else if("array"===f){if((a=n[s])[2])for(i=r[d],o=0;o<a[2].length;o++){if(!i.hasOwnProperty(a[2][o]))throw m('[sprintf] property "%s" does not exist',a[2][o]);i=i[a[2][o]]}else i=a[1]?r[a[1]]:r[d++];if(/[^s]/.test(a[8])&&"number"!=e(i))throw m("[sprintf] expecting number but found %s",e(i));switch(null==i&&(i=""),a[8]){case"b":i=i.toString(2);break;case"c":i=String.fromCharCode(i);break;case"d":i=parseInt(i,10);break;case"e":i=a[7]?i.toExponential(a[7]):i.toExponential();break;case"f":i=a[7]?parseFloat(i).toFixed(a[7]):parseFloat(i);break;case"o":i=i.toString(8);break;case"s":i=(i=String(i))&&a[7]?i.substring(0,a[7]):i;break;case"u":i=Math.abs(i);break;case"x":i=i.toString(16);break;case"X":i=i.toString(16).toUpperCase()}i=/[def]/.test(a[8])&&a[3]&&i>=0?"+"+i:i,u=a[4]?"0"==a[4]?"0":a[4].charAt(1):" ",l=a[6]-String(i).length,c=a[6]?t(u,l):"",p.push(a[5]?i+c:c+i)}return p.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],r=[],i=0;t;){if(null!==(n=/^[^\x25]+/.exec(t)))r.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(t)))r.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?";if(n[2]){i|=1;var s=[],o=n[2],a=[];if(null===(a=/^([a-z_][a-z_\d]*)/i.exec(o)))throw"[sprintf] huh?";for(s.push(a[1]);""!==(o=o.substring(a[0].length));)if(null!==(a=/^\.([a-z_][a-z_\d]*)/i.exec(o)))s.push(a[1]);else{if(null===(a=/^\[(\d+)\]/.exec(o)))throw"[sprintf] huh?";s.push(a[1])}n[2]=s}else i|=2;if(3===i)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";r.push(n)}t=t.substring(n[0].length)}return r},n}(),_=function(e,t){return t.unshift(e),m.apply(null,t)};d.parse_plural=function(e,t){return e=e.replace(/n/g,t),d.parse_expression(e)},d.sprintf=function(e,t){return"[object Array]"=={}.toString.call(t)?_(e,[].slice.call(t)):m.apply(this,[].slice.call(arguments))},d.prototype.sprintf=function(){return d.sprintf.apply(this,arguments)},d.PF={},d.PF.parse=function(e){var t=d.PF.extractPluralExpr(e);return d.PF.parser.parse.call(d.PF.parser,t)},d.PF.compile=function(e){var t=d.PF.parse(e);return function(e){return!0===(n=d.PF.interpreter(t)(e))?1:n||0;var n}},d.PF.interpreter=function(e){return function(t){switch(e.type){case"GROUP":return d.PF.interpreter(e.expr)(t);case"TERNARY":return d.PF.interpreter(e.expr)(t)?d.PF.interpreter(e.truthy)(t):d.PF.interpreter(e.falsey)(t);case"OR":return d.PF.interpreter(e.left)(t)||d.PF.interpreter(e.right)(t);case"AND":return d.PF.interpreter(e.left)(t)&&d.PF.interpreter(e.right)(t);case"LT":return d.PF.interpreter(e.left)(t)<d.PF.interpreter(e.right)(t);case"GT":return d.PF.interpreter(e.left)(t)>d.PF.interpreter(e.right)(t);case"LTE":return d.PF.interpreter(e.left)(t)<=d.PF.interpreter(e.right)(t);case"GTE":return d.PF.interpreter(e.left)(t)>=d.PF.interpreter(e.right)(t);case"EQ":return d.PF.interpreter(e.left)(t)==d.PF.interpreter(e.right)(t);case"NEQ":return d.PF.interpreter(e.left)(t)!=d.PF.interpreter(e.right)(t);case"MOD":return d.PF.interpreter(e.left)(t)%d.PF.interpreter(e.right)(t);case"VAR":return t;case"NUM":return e.val;default:throw new Error("Invalid Token found.")}}},d.PF.extractPluralExpr=function(e){e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),/;\s*$/.test(e)||(e=e.concat(";"));var t,n=/nplurals\=(\d+);/,r=e.match(n);if(!(r.length>1))throw new Error("nplurals not found in plural_forms string: "+e);if(r[1],!((t=(e=e.replace(n,"")).match(/plural\=(.*);/))&&t.length>1))throw new Error("`plural` expression not found: "+e);return t[1]},d.PF.parser=(p={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,"?":6,":":7,"||":8,"&&":9,"<":10,"<=":11,">":12,">=":13,"!=":14,"==":15,"%":16,"(":17,")":18,n:19,NUMBER:20,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",6:"?",7:":",8:"||",9:"&&",10:"<",11:"<=",12:">",13:">=",14:"!=",15:"==",16:"%",17:"(",18:")",19:"n",20:"NUMBER"},productions_:[0,[3,2],[4,5],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,1],[4,1]],performAction:function(e,t,n,r,i,s,o){var a=s.length-1;switch(i){case 1:return{type:"GROUP",expr:s[a-1]};case 2:this.$={type:"TERNARY",expr:s[a-4],truthy:s[a-2],falsey:s[a]};break;case 3:this.$={type:"OR",left:s[a-2],right:s[a]};break;case 4:this.$={type:"AND",left:s[a-2],right:s[a]};break;case 5:this.$={type:"LT",left:s[a-2],right:s[a]};break;case 6:this.$={type:"LTE",left:s[a-2],right:s[a]};break;case 7:this.$={type:"GT",left:s[a-2],right:s[a]};break;case 8:this.$={type:"GTE",left:s[a-2],right:s[a]};break;case 9:this.$={type:"NEQ",left:s[a-2],right:s[a]};break;case 10:this.$={type:"EQ",left:s[a-2],right:s[a]};break;case 11:this.$={type:"MOD",left:s[a-2],right:s[a]};break;case 12:this.$={type:"GROUP",expr:s[a-1]};break;case 13:this.$={type:"VAR"};break;case 14:this.$={type:"NUM",val:Number(e)}}},table:[{3:1,4:2,17:[1,3],19:[1,4],20:[1,5]},{1:[3]},{5:[1,6],6:[1,7],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16]},{4:17,17:[1,3],19:[1,4],20:[1,5]},{5:[2,13],6:[2,13],7:[2,13],8:[2,13],9:[2,13],10:[2,13],11:[2,13],12:[2,13],13:[2,13],14:[2,13],15:[2,13],16:[2,13],18:[2,13]},{5:[2,14],6:[2,14],7:[2,14],8:[2,14],9:[2,14],10:[2,14],11:[2,14],12:[2,14],13:[2,14],14:[2,14],15:[2,14],16:[2,14],18:[2,14]},{1:[2,1]},{4:18,17:[1,3],19:[1,4],20:[1,5]},{4:19,17:[1,3],19:[1,4],20:[1,5]},{4:20,17:[1,3],19:[1,4],20:[1,5]},{4:21,17:[1,3],19:[1,4],20:[1,5]},{4:22,17:[1,3],19:[1,4],20:[1,5]},{4:23,17:[1,3],19:[1,4],20:[1,5]},{4:24,17:[1,3],19:[1,4],20:[1,5]},{4:25,17:[1,3],19:[1,4],20:[1,5]},{4:26,17:[1,3],19:[1,4],20:[1,5]},{4:27,17:[1,3],19:[1,4],20:[1,5]},{6:[1,7],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[1,28]},{6:[1,7],7:[1,29],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16]},{5:[2,3],6:[2,3],7:[2,3],8:[2,3],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,3]},{5:[2,4],6:[2,4],7:[2,4],8:[2,4],9:[2,4],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,4]},{5:[2,5],6:[2,5],7:[2,5],8:[2,5],9:[2,5],10:[2,5],11:[2,5],12:[2,5],13:[2,5],14:[2,5],15:[2,5],16:[1,16],18:[2,5]},{5:[2,6],6:[2,6],7:[2,6],8:[2,6],9:[2,6],10:[2,6],11:[2,6],12:[2,6],13:[2,6],14:[2,6],15:[2,6],16:[1,16],18:[2,6]},{5:[2,7],6:[2,7],7:[2,7],8:[2,7],9:[2,7],10:[2,7],11:[2,7],12:[2,7],13:[2,7],14:[2,7],15:[2,7],16:[1,16],18:[2,7]},{5:[2,8],6:[2,8],7:[2,8],8:[2,8],9:[2,8],10:[2,8],11:[2,8],12:[2,8],13:[2,8],14:[2,8],15:[2,8],16:[1,16],18:[2,8]},{5:[2,9],6:[2,9],7:[2,9],8:[2,9],9:[2,9],10:[2,9],11:[2,9],12:[2,9],13:[2,9],14:[2,9],15:[2,9],16:[1,16],18:[2,9]},{5:[2,10],6:[2,10],7:[2,10],8:[2,10],9:[2,10],10:[2,10],11:[2,10],12:[2,10],13:[2,10],14:[2,10],15:[2,10],16:[1,16],18:[2,10]},{5:[2,11],6:[2,11],7:[2,11],8:[2,11],9:[2,11],10:[2,11],11:[2,11],12:[2,11],13:[2,11],14:[2,11],15:[2,11],16:[2,11],18:[2,11]},{5:[2,12],6:[2,12],7:[2,12],8:[2,12],9:[2,12],10:[2,12],11:[2,12],12:[2,12],13:[2,12],14:[2,12],15:[2,12],16:[2,12],18:[2,12]},{4:30,17:[1,3],19:[1,4],20:[1,5]},{5:[2,2],6:[1,7],7:[2,2],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,2]}],defaultActions:{6:[2,1]},parseError:function(e,t){throw new Error(e)},parse:function(e){var t=this,n=[0],r=[null],i=[],s=this.table,o="",a=0,c=0,u=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var l=this.lexer.yylloc;function d(){var e;return"number"!=typeof(e=t.lexer.lex()||1)&&(e=t.symbols_[e]||e),e}i.push(l),"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var h,f,p,g,m,_,v,b,y,S,w={};;){if(p=n[n.length-1],this.defaultActions[p]?g=this.defaultActions[p]:(null==h&&(h=d()),g=s[p]&&s[p][h]),void 0===g||!g.length||!g[0]){if(!u){for(_ in y=[],s[p])this.terminals_[_]&&_>2&&y.push("'"+this.terminals_[_]+"'");var x="";x=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+y.join(", ")+", got '"+this.terminals_[h]+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==h?"end of input":"'"+(this.terminals_[h]||h)+"'"),this.parseError(x,{text:this.lexer.match,token:this.terminals_[h]||h,line:this.lexer.yylineno,loc:l,expected:y})}if(3==u){if(1==h)throw new Error(x||"Parsing halted.");c=this.lexer.yyleng,o=this.lexer.yytext,a=this.lexer.yylineno,l=this.lexer.yylloc,h=d()}for(;!(2..toString()in s[p]);){if(0==p)throw new Error(x||"Parsing halted.");S=1,n.length=n.length-2*S,r.length=r.length-S,i.length=i.length-S,p=n[n.length-1]}f=h,h=2,g=s[p=n[n.length-1]]&&s[p][2],u=3}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+p+", token: "+h);switch(g[0]){case 1:n.push(h),r.push(this.lexer.yytext),i.push(this.lexer.yylloc),n.push(g[1]),h=null,f?(h=f,f=null):(c=this.lexer.yyleng,o=this.lexer.yytext,a=this.lexer.yylineno,l=this.lexer.yylloc,u>0&&u--);break;case 2:if(v=this.productions_[g[1]][1],w.$=r[r.length-v],w._$={first_line:i[i.length-(v||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(v||1)].first_column,last_column:i[i.length-1].last_column},void 0!==(m=this.performAction.call(w,o,c,a,this.yy,g[1],r,i)))return m;v&&(n=n.slice(0,-1*v*2),r=r.slice(0,-1*v),i=i.slice(0,-1*v)),n.push(this.productions_[g[1]][0]),r.push(w.$),i.push(w._$),b=s[n[n.length-2]][n[n.length-1]],n.push(b);break;case 3:return!0}}return!0}},g=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parseError)throw new Error(e);this.yy.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.match+=e,this.matched+=e,e.match(/\n/)&&this.yylineno++,this._input=this._input.slice(1),e},unput:function(e){return this._input=e+this._input,this},more:function(){return this._more=!0,this},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;var e,t;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),r=0;r<n.length;r++)if(e=this._input.match(this.rules[n[r]]))return(t=e[0].match(/\n.*/g))&&(this.yylineno+=t.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:t?t[t.length-1].length-1:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],this.performAction.call(this,this.yy,this,n[r],this.conditionStack[this.conditionStack.length-1])||void 0;if(""===this._input)return this.EOF;this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return void 0!==e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)},performAction:function(e,t,n,r){switch(n){case 0:break;case 1:return 20;case 2:return 19;case 3:return 8;case 4:return 9;case 5:return 6;case 6:return 7;case 7:return 11;case 8:return 13;case 9:return 10;case 10:return 12;case 11:return 14;case 12:return 15;case 13:return 16;case 14:return 17;case 15:return 18;case 16:return 5;case 17:return"INVALID"}},rules:[/^\s+/,/^[0-9]+(\.[0-9]+)?\b/,/^n\b/,/^\|\|/,/^&&/,/^\?/,/^:/,/^<=/,/^>=/,/^</,/^>/,/^!=/,/^==/,/^%/,/^\(/,/^\)/,/^$/,/^./],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],inclusive:!0}}};return e}(),p.lexer=g,p),e.exports&&(t=e.exports=d),t.Jed=d}()},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(235);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},function(e,t){var n=9007199254740991;e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},function(e,t,n){var r=n(6),i=Object.create,s=function(){function e(){}return function(t){if(!r(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=s},function(e,t,n){var r=n(38),i=n(40),s=4294967295;function o(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=s,this.__views__=[]}o.prototype=r(i.prototype),o.prototype.constructor=o,e.exports=o},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e){return e.placeholder}},function(e,t,n){var r=n(10)(n(4),"Map");e.exports=r},function(e,t,n){var r=n(300),i=n(307),s=n(309),o=n(310),a=n(311);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=s,c.prototype.has=o,c.prototype.set=a,e.exports=c},function(e,t,n){var r=n(30),i=n(17);e.exports=function(e,t){for(var n=0,s=(t=r(t,e)).length;null!=e&&n<s;)e=e[i(t[n++])];return n&&n==s?e:void 0}},function(e,t,n){var r=n(5),i=n(21),s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||o.test(e)||!s.test(e)||null!=t&&e in Object(t)}},function(e,t,n){var r=n(269),i=n(13);e.exports=function(e){return null==e?[]:r(e,i(e))}},function(e,t,n){var r=n(62),i=n(270),s=n(41),o=n(25),a=r(function(e,t){var n=o(t,s(a));return i(e,32,void 0,t,n)});a.placeholder={},e.exports=a},function(e,t,n){var r,i;r=[n(2)],void 0===(i=function(e){return e.noConflict()}.apply(t,r))||(e.exports=i)},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(20))},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},function(e,t,n){var r=n(244),i=n(52),s=n(5),o=n(53),a=n(15),c=n(54),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=s(e),l=!n&&i(e),d=!n&&!l&&o(e),h=!n&&!l&&!d&&c(e),f=n||l||d||h,p=f?r(e.length,String):[],g=p.length;for(var m in e)!t&&!u.call(e,m)||f&&("length"==m||d&&("offset"==m||"parent"==m)||h&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||a(m,g))||p.push(m);return p}},function(e,t,n){var r=n(245),i=n(7),s=Object.prototype,o=s.hasOwnProperty,a=s.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return i(e)&&o.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},function(e,t,n){(function(e){var r=n(4),i=n(246),s=t&&!t.nodeType&&t,o=s&&"object"==typeof e&&e&&!e.nodeType&&e,a=o&&o.exports===s?r.Buffer:void 0,c=(a?a.isBuffer:void 0)||i;e.exports=c}).call(this,n(33)(e))},function(e,t,n){var r=n(247),i=n(248),s=n(249),o=s&&s.isTypedArray,a=o?i(o):r;e.exports=a},function(e,t,n){var r=n(56),i=n(250),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))s.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){var r=n(59),i=n(23),s=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var o=e[t];s.call(e,t)&&i(o,n)&&(void 0!==n||t in e)||r(e,t,n)}},function(e,t,n){var r=n(60);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t,n){var r=n(10),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,n){var r=n(16),i=n(260),s=n(63);e.exports=function(e,t){return s(i(e,t,r),e+"")}},function(e,t,n){var r=n(261),i=n(64)(r);e.exports=i},function(e,t){var n=800,r=16,i=Date.now;e.exports=function(e){var t=0,s=0;return function(){var o=i(),a=r-(o-s);if(s=o,a>0){if(++t>=n)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,n){var r=n(51),i=n(264),s=n(12);e.exports=function(e){return s(e)?r(e,!0):i(e)}},function(e,t,n){var r=n(266),i=n(267),s=n(268);e.exports=function(e,t,n){return t==t?s(e,t,n):r(e,i,n)}},function(e,t,n){var r=n(9),i=n(5),s=n(7),o="[object String]";e.exports=function(e){return"string"==typeof e||!i(e)&&s(e)&&r(e)==o}},function(e,t,n){var r=n(16),i=n(69),s=i?function(e,t){return i.set(e,t),e}:r;e.exports=s},function(e,t,n){var r=n(70),i=r&&new r;e.exports=i},function(e,t,n){var r=n(10)(n(4),"WeakMap");e.exports=r},function(e,t,n){var r=n(72),i=n(73),s=n(273),o=n(24),a=n(74),c=n(41),u=n(284),l=n(25),d=n(4),h=1,f=2,p=8,g=16,m=128,_=512;e.exports=function e(t,n,v,b,y,S,w,x,E,A){var j=n&m,N=n&h,C=n&f,O=n&(p|g),T=n&_,R=C?void 0:o(t);return function h(){for(var f=arguments.length,p=Array(f),g=f;g--;)p[g]=arguments[g];if(O)var m=c(h),_=s(p,m);if(b&&(p=r(p,b,y,O)),S&&(p=i(p,S,w,O)),f-=_,O&&f<A){var M=l(p,m);return a(t,n,e,h.placeholder,v,p,M,x,E,A-f)}var I=N?v:this,k=C?I[t]:t;return f=p.length,x?p=u(p,x):T&&f>1&&p.reverse(),j&&E<f&&(p.length=E),this&&this!==d&&this instanceof h&&(k=R||o(k)),k.apply(I,p)}}},function(e,t){var n=Math.max;e.exports=function(e,t,r,i){for(var s=-1,o=e.length,a=r.length,c=-1,u=t.length,l=n(o-a,0),d=Array(u+l),h=!i;++c<u;)d[c]=t[c];for(;++s<a;)(h||s<o)&&(d[r[s]]=e[s]);for(;l--;)d[c++]=e[s++];return d}},function(e,t){var n=Math.max;e.exports=function(e,t,r,i){for(var s=-1,o=e.length,a=-1,c=r.length,u=-1,l=t.length,d=n(o-c,0),h=Array(d+l),f=!i;++s<d;)h[s]=e[s];for(var p=s;++u<l;)h[p+u]=t[u];for(;++a<c;)(f||s<o)&&(h[p+r[a]]=e[s++]);return h}},function(e,t,n){var r=n(274),i=n(78),s=n(79),o=1,a=2,c=4,u=8,l=32,d=64;e.exports=function(e,t,n,h,f,p,g,m,_,v){var b=t&u;t|=b?l:d,(t&=~(b?d:l))&c||(t&=~(o|a));var y=[e,t,f,b?p:void 0,b?g:void 0,b?void 0:p,b?void 0:g,m,_,v],S=n.apply(void 0,y);return r(e)&&i(S,y),S.placeholder=h,s(S,e,t)}},function(e,t,n){var r=n(69),i=n(275),s=r?function(e){return r.get(e)}:i;e.exports=s},function(e,t,n){var r=n(38),i=n(40);function s(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}s.prototype=r(i.prototype),s.prototype.constructor=s,e.exports=s},function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},function(e,t,n){var r=n(68),i=n(64)(r);e.exports=i},function(e,t,n){var r=n(280),i=n(281),s=n(63),o=n(282);e.exports=function(e,t,n){var a=t+"";return s(e,i(a,o(r(a),n)))}},function(e,t,n){var r=n(26),i=n(295),s=n(296),o=n(297),a=n(298),c=n(299);function u(e){var t=this.__data__=new r(e);this.size=t.size}u.prototype.clear=i,u.prototype.delete=s,u.prototype.get=o,u.prototype.has=a,u.prototype.set=c,e.exports=u},function(e,t,n){var r=n(312),i=n(7);e.exports=function e(t,n,s,o,a){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!=t&&n!=n:r(t,n,s,o,e,a))}},function(e,t,n){var r=n(313),i=n(316),s=n(317),o=1,a=2;e.exports=function(e,t,n,c,u,l){var d=n&o,h=e.length,f=t.length;if(h!=f&&!(d&&f>h))return!1;var p=l.get(e);if(p&&l.get(t))return p==t;var g=-1,m=!0,_=n&a?new r:void 0;for(l.set(e,t),l.set(t,e);++g<h;){var v=e[g],b=t[g];if(c)var y=d?c(b,v,g,t,e,l):c(v,b,g,e,t,l);if(void 0!==y){if(y)continue;m=!1;break}if(_){if(!i(t,function(e,t){if(!s(_,t)&&(v===e||u(v,e,n,c,l)))return _.push(t)})){m=!1;break}}else if(v!==b&&!u(v,b,n,c,l)){m=!1;break}}return l.delete(e),l.delete(t),m}},function(e,t,n){var r=n(84),i=n(5);e.exports=function(e,t,n){var s=t(e);return i(e)?s:r(s,n(e))}},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},function(e,t,n){var r=n(324),i=n(86),s=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,a=o?function(e){return null==e?[]:(e=Object(e),r(o(e),function(t){return s.call(e,t)}))}:i;e.exports=a},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(325),i=n(42),s=n(326),o=n(327),a=n(70),c=n(9),u=n(61),l=u(r),d=u(i),h=u(s),f=u(o),p=u(a),g=c;(r&&"[object DataView]"!=g(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=g(new i)||s&&"[object Promise]"!=g(s.resolve())||o&&"[object Set]"!=g(new o)||a&&"[object WeakMap]"!=g(new a))&&(g=function(e){var t=c(e),n="[object Object]"==t?e.constructor:void 0,r=n?u(n):"";if(r)switch(r){case l:return"[object DataView]";case d:return"[object Map]";case h:return"[object Promise]";case f:return"[object Set]";case p:return"[object WeakMap]"}return t}),e.exports=g},function(e,t,n){var r=n(6);e.exports=function(e){return e==e&&!r(e)}},function(e,t){e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},function(e,t,n){var r=n(334);e.exports=function(e){return null==e?"":r(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){var r=n(350),i=n(90),s=/[&<>"']/g,o=RegExp(s.source);e.exports=function(e){return(e=i(e))&&o.test(e)?e.replace(s,r):e}},function(e,t,n){e.exports=function(){"use strict";return function(e,t,n){var r=t.prototype,i=r.format;n.en.ordinal=function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"},r.format=function(e){var t=this,n=this.$locale(),r=this.$utils(),s=(e||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|gggg|Do|X|x|k{1,2}|S/g,function(e){switch(e){case"Q":return Math.ceil((t.$M+1)/3);case"Do":return n.ordinal(t.$D);case"gggg":return t.weekYear();case"wo":return n.ordinal(t.week(),"W");case"k":case"kk":return r.s(String(0===t.$H?24:t.$H),"k"===e?1:2,"0");case"X":return Math.floor(t.$d.getTime()/1e3);case"x":return t.$d.getTime();default:return e}});return i.bind(this)(s)}}}()},function(e,t,n){var r=n(234),i=n(34);e.exports=function(e,t,n){var s=null==e?0:e.length;return s?(t=n||void 0===t?1:i(t),r(e,t<0?0:t,s)):[]}},function(e,t,n){var r=n(9),i=n(7),s="[object Boolean]";e.exports=function(e){return!0===e||!1===e||i(e)&&r(e)==s}},function(e,t){e.exports=function(e){return null==e}},function(e,t,n){var r=n(37),i=n(287),s=n(340),o=n(342);e.exports=function(e,t){if(null==e)return{};var n=r(o(e),function(e){return[e]});return t=i(t),s(e,n,function(e,n){return t(e,n[0])})}},function(e,t,n){var r=n(55),i=n(87),s=n(12),o=n(67),a=n(345),c="[object Map]",u="[object Set]";e.exports=function(e){if(null==e)return 0;if(s(e))return o(e)?a(e):e.length;var t=i(e);return t==c||t==u?e.size:r(e).length}},function(e,t,n){var r={escape:n(92)};e.exports=function(e){var t="",n=r.escape;Array.prototype.join;return t+='\x3c!-- src/headless/templates/field.html --\x3e\n<field var="'+n(e.name)+'">\n',e.value.constructor===Array?(t+="\n    ",e.value.forEach(function(e){t+="<value>"+n(e)+"</value>"}),t+="\n"):t+="\n    <value>"+n(e.value)+"</value>\n",t+="</field>\n"}},function(e,t,n){"use strict";(function(t){
/**
 * filesize
 *
 * @copyright 2019 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 4.2.1
 */
!function(t){var n=/^(b|B)$/,r={iec:{bits:["b","Kib","Mib","Gib","Tib","Pib","Eib","Zib","Yib"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},i={iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]};function s(e){var t,s,o,a,c,u,l,d,h,f,p,g,m,_,v,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},y=[],S=0,w=void 0,x=void 0;if(isNaN(e))throw new TypeError("Invalid number");return s=!0===b.bits,p=!0===b.unix,t=b.base||2,f=void 0!==b.round?b.round:p?1:2,u=void 0!==b.locale?b.locale:"",l=b.localeOptions||{},g=void 0!==b.separator?b.separator:"",m=void 0!==b.spacer?b.spacer:p?"":" ",v=b.symbols||{},_=2===t&&b.standard||"jedec",h=b.output||"string",a=!0===b.fullform,c=b.fullforms instanceof Array?b.fullforms:[],w=void 0!==b.exponent?b.exponent:-1,o=t>2?1e3:1024,(d=(x=Number(e))<0)&&(x=-x),(-1===w||isNaN(w))&&(w=Math.floor(Math.log(x)/Math.log(o)))<0&&(w=0),w>8&&(w=8),"exponent"===h?w:(0===x?(y[0]=0,y[1]=p?"":r[_][s?"bits":"bytes"][w]):(S=x/(2===t?Math.pow(2,10*w):Math.pow(1e3,w)),s&&(S*=8)>=o&&w<8&&(S/=o,w++),y[0]=Number(S.toFixed(w>0?f:0)),y[0]===o&&w<8&&void 0===b.exponent&&(y[0]=1,w++),y[1]=10===t&&1===w?s?"kb":"kB":r[_][s?"bits":"bytes"][w],p&&(y[1]="jedec"===_?y[1].charAt(0):w>0?y[1].replace(/B$/,""):y[1],n.test(y[1])&&(y[0]=Math.floor(y[0]),y[1]=""))),d&&(y[0]=-y[0]),y[1]=v[y[1]]||y[1],!0===u?y[0]=y[0].toLocaleString():u.length>0?y[0]=y[0].toLocaleString(u,l):g.length>0&&(y[0]=y[0].toString().replace(".",g)),"array"===h?y:(a&&(y[1]=c[w]?c[w]:i[_][w]+(s?"bit":"byte")+(1===y[0]?"":"s")),"object"===h?{value:y[0],symbol:y[1]}:y.join(m)))}s.partial=function(e){return function(t){return s(t,e)}},e.exports=s}("undefined"!=typeof window&&window)}).call(this,n(20))},function(e,t,n){var r={escape:n(92)};e.exports=function(e){var t="",n=r.escape;return t+='\x3c!-- src/headless/templates/vcard.html --\x3e\n<vCard xmlns="vcard-temp">\n    <FN>'+n(e.fn)+"</FN>\n    <NICKNAME>"+n(e.nickname)+"</NICKNAME>\n    <URL>"+n(e.url)+"</URL>\n    <ROLE>"+n(e.role)+"</ROLE>\n    <EMAIL><INTERNET/><PREF/><USERID>"+n(e.email)+"</USERID></EMAIL>\n    <PHOTO>\n      <TYPE>"+n(e.image_type)+"</TYPE>\n      <BINVAL>"+n(e.image)+"</BINVAL>\n    </PHOTO>\n</vCard>\n"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r;void 0===(r=function(){return Object}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r={"./af/LC_MESSAGES/converse.po":[353,130],"./ar/LC_MESSAGES/converse.po":[354,131],"./bg/LC_MESSAGES/converse.po":[355,132],"./ca/LC_MESSAGES/converse.po":[356,133],"./cs/LC_MESSAGES/converse.po":[357,134],"./de/LC_MESSAGES/converse.po":[358,135],"./eo/LC_MESSAGES/converse.po":[359,136],"./es/LC_MESSAGES/converse.po":[360,137],"./eu/LC_MESSAGES/converse.po":[361,138],"./fr/LC_MESSAGES/converse.po":[362,139],"./gl/LC_MESSAGES/converse.po":[363,140],"./he/LC_MESSAGES/converse.po":[364,141],"./hi/LC_MESSAGES/converse.po":[365,142],"./hu/LC_MESSAGES/converse.po":[366,143],"./id/LC_MESSAGES/converse.po":[367,144],"./it/LC_MESSAGES/converse.po":[368,145],"./ja/LC_MESSAGES/converse.po":[369,146],"./lt/LC_MESSAGES/converse.po":[370,147],"./nb/LC_MESSAGES/converse.po":[371,148],"./nl/LC_MESSAGES/converse.po":[372,149],"./nl_BE/LC_MESSAGES/converse.po":[373,150],"./oc/LC_MESSAGES/converse.po":[374,151],"./pl/LC_MESSAGES/converse.po":[375,152],"./pt/LC_MESSAGES/converse.po":[376,153],"./pt_BR/LC_MESSAGES/converse.po":[377,154],"./ro/LC_MESSAGES/converse.po":[378,155],"./ru/LC_MESSAGES/converse.po":[379,156],"./tr/LC_MESSAGES/converse.po":[380,157],"./uk/LC_MESSAGES/converse.po":[381,158],"./vi/LC_MESSAGES/converse.po":[382,159],"./zh_CN/LC_MESSAGES/converse.po":[383,160],"./zh_TW/LC_MESSAGES/converse.po":[384,161]};function i(e){if(!n.o(r,e))return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=r[e],i=t[0];return n.e(t[1]).then(function(){return n.t(i,3)})}i.keys=function(){return Object.keys(r)},i.id=232,e.exports=i},function(e,t,n){var r={"./af":[102,0],"./af.js":[102,0],"./ar":[109,1],"./ar-dz":[103,2],"./ar-dz.js":[103,2],"./ar-kw":[104,3],"./ar-kw.js":[104,3],"./ar-ly":[105,4],"./ar-ly.js":[105,4],"./ar-ma":[106,5],"./ar-ma.js":[106,5],"./ar-sa":[107,6],"./ar-sa.js":[107,6],"./ar-tn":[108,7],"./ar-tn.js":[108,7],"./ar.js":[109,1],"./az":[110,8],"./az.js":[110,8],"./be":[111,9],"./be.js":[111,9],"./bg":[112,10],"./bg.js":[112,10],"./bm":[113,11],"./bm.js":[113,11],"./bn":[114,12],"./bn.js":[114,12],"./bo":[115,13],"./bo.js":[115,13],"./br":[116,14],"./br.js":[116,14],"./bs":[117,15],"./bs.js":[117,15],"./ca":[118,16],"./ca.js":[118,16],"./cs":[119,17],"./cs.js":[119,17],"./cv":[120,18],"./cv.js":[120,18],"./cy":[121,19],"./cy.js":[121,19],"./da":[122,20],"./da.js":[122,20],"./de":[125,21],"./de-at":[123,22],"./de-at.js":[123,22],"./de-ch":[124,23],"./de-ch.js":[124,23],"./de.js":[125,21],"./dv":[126,24],"./dv.js":[126,24],"./el":[127,25],"./el.js":[127,25],"./en":[135,26],"./en-SG":[128,27],"./en-SG.js":[128,27],"./en-au":[129,28],"./en-au.js":[129,28],"./en-ca":[130,29],"./en-ca.js":[130,29],"./en-gb":[131,30],"./en-gb.js":[131,30],"./en-ie":[132,31],"./en-ie.js":[132,31],"./en-il":[133,32],"./en-il.js":[133,32],"./en-nz":[134,33],"./en-nz.js":[134,33],"./en.js":[135,26],"./eo":[136,34],"./eo.js":[136,34],"./es":[139,35],"./es-do":[137,36],"./es-do.js":[137,36],"./es-us":[138,37],"./es-us.js":[138,37],"./es.js":[139,35],"./et":[140,38],"./et.js":[140,38],"./eu":[141,39],"./eu.js":[141,39],"./fa":[142,40],"./fa.js":[142,40],"./fi":[143,41],"./fi.js":[143,41],"./fo":[144,42],"./fo.js":[144,42],"./fr":[147,43],"./fr-ca":[145,44],"./fr-ca.js":[145,44],"./fr-ch":[146,45],"./fr-ch.js":[146,45],"./fr.js":[147,43],"./fy":[148,46],"./fy.js":[148,46],"./ga":[149,47],"./ga.js":[149,47],"./gd":[150,48],"./gd.js":[150,48],"./gl":[151,49],"./gl.js":[151,49],"./gom-latn":[152,50],"./gom-latn.js":[152,50],"./gu":[153,51],"./gu.js":[153,51],"./he":[154,52],"./he.js":[154,52],"./hi":[155,53],"./hi.js":[155,53],"./hr":[156,54],"./hr.js":[156,54],"./hu":[157,55],"./hu.js":[157,55],"./hy-am":[158,56],"./hy-am.js":[158,56],"./id":[159,57],"./id.js":[159,57],"./is":[160,58],"./is.js":[160,58],"./it":[162,59],"./it-ch":[161,60],"./it-ch.js":[161,60],"./it.js":[162,59],"./ja":[163,61],"./ja.js":[163,61],"./jv":[164,62],"./jv.js":[164,62],"./ka":[165,63],"./ka.js":[165,63],"./kk":[166,64],"./kk.js":[166,64],"./km":[167,65],"./km.js":[167,65],"./kn":[168,66],"./kn.js":[168,66],"./ko":[169,67],"./ko.js":[169,67],"./ku":[170,68],"./ku.js":[170,68],"./ky":[171,69],"./ky.js":[171,69],"./lb":[172,70],"./lb.js":[172,70],"./lo":[173,71],"./lo.js":[173,71],"./lt":[174,72],"./lt.js":[174,72],"./lv":[175,73],"./lv.js":[175,73],"./me":[176,74],"./me.js":[176,74],"./mi":[177,75],"./mi.js":[177,75],"./mk":[178,76],"./mk.js":[178,76],"./ml":[179,77],"./ml.js":[179,77],"./mn":[180,78],"./mn.js":[180,78],"./mr":[181,79],"./mr.js":[181,79],"./ms":[183,80],"./ms-my":[182,81],"./ms-my.js":[182,81],"./ms.js":[183,80],"./mt":[184,82],"./mt.js":[184,82],"./my":[185,83],"./my.js":[185,83],"./nb":[186,84],"./nb.js":[186,84],"./ne":[187,85],"./ne.js":[187,85],"./nl":[189,86],"./nl-be":[188,87],"./nl-be.js":[188,87],"./nl.js":[189,86],"./nn":[190,88],"./nn.js":[190,88],"./oc-lnc":[191,89],"./oc-lnc.js":[191,89],"./pa-in":[192,90],"./pa-in.js":[192,90],"./pl":[193,91],"./pl.js":[193,91],"./pt":[195,92],"./pt-br":[194,93],"./pt-br.js":[194,93],"./pt.js":[195,92],"./ro":[196,94],"./ro.js":[196,94],"./ru":[197,95],"./ru.js":[197,95],"./sd":[198,96],"./sd.js":[198,96],"./se":[199,97],"./se.js":[199,97],"./si":[200,98],"./si.js":[200,98],"./sk":[201,99],"./sk.js":[201,99],"./sl":[202,100],"./sl.js":[202,100],"./sq":[203,101],"./sq.js":[203,101],"./sr":[205,102],"./sr-cyrl":[204,103],"./sr-cyrl.js":[204,103],"./sr.js":[205,102],"./ss":[206,104],"./ss.js":[206,104],"./sv":[207,105],"./sv.js":[207,105],"./sw":[208,106],"./sw.js":[208,106],"./ta":[209,107],"./ta.js":[209,107],"./te":[210,108],"./te.js":[210,108],"./tet":[211,109],"./tet.js":[211,109],"./tg":[212,110],"./tg.js":[212,110],"./th":[213,111],"./th.js":[213,111],"./tl-ph":[214,112],"./tl-ph.js":[214,112],"./tlh":[215,113],"./tlh.js":[215,113],"./tr":[216,114],"./tr.js":[216,114],"./tzl":[217,115],"./tzl.js":[217,115],"./tzm":[219,116],"./tzm-latn":[218,117],"./tzm-latn.js":[218,117],"./tzm.js":[219,116],"./ug-cn":[220,118],"./ug-cn.js":[220,118],"./uk":[221,119],"./uk.js":[221,119],"./ur":[222,120],"./ur.js":[222,120],"./uz":[224,121],"./uz-latn":[223,122],"./uz-latn.js":[223,122],"./uz.js":[224,121],"./vi":[225,123],"./vi.js":[225,123],"./x-pseudo":[226,124],"./x-pseudo.js":[226,124],"./yo":[227,125],"./yo.js":[227,125],"./zh-cn":[228,126],"./zh-cn.js":[228,126],"./zh-hk":[229,127],"./zh-hk.js":[229,127],"./zh-tw":[230,128],"./zh-tw.js":[230,128]};function i(e){if(!n.o(r,e))return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=r[e],i=t[0];return n.e(t[1]).then(function(){return n.t(i,7)})}i.keys=function(){return Object.keys(r)},i.id=233,e.exports=i},function(e,t){e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var s=Array(i);++r<i;)s[r]=e[r+t];return s}},function(e,t,n){var r=n(236),i=1/0,s=17976931348623157e292;e.exports=function(e){return e?(e=r(e))===i||e===-i?(e<0?-1:1)*s:e==e?e:0:0===e?e:0}},function(e,t,n){var r=n(6),i=n(21),s=NaN,o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return s;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=c.test(e);return n||u.test(e)?l(e.slice(2),n?2:8):a.test(e)?s:+e}},function(e,t,n){var r=n(22),i=Object.prototype,s=i.hasOwnProperty,o=i.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=s.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var i=o.call(e);return r&&(t?e[a]=n:delete e[a]),i}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r=n(50),i=n(240),s=n(252),o=n(5);e.exports=function(e,t){return(o(e)?r:i)(e,s(t))}},function(e,t,n){var r=n(241),i=n(251)(r);e.exports=i},function(e,t,n){var r=n(242),i=n(13);e.exports=function(e,t){return e&&r(e,t,i)}},function(e,t,n){var r=n(243)();e.exports=r},function(e,t){e.exports=function(e){return function(t,n,r){for(var i=-1,s=Object(t),o=r(t),a=o.length;a--;){var c=o[e?a:++i];if(!1===n(s[c],c,s))break}return t}}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(9),i=n(7),s="[object Arguments]";e.exports=function(e){return i(e)&&r(e)==s}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(9),i=n(35),s=n(7),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return s(e)&&i(e.length)&&!!o[r(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var r=n(49),i=t&&!t.nodeType&&t,s=i&&"object"==typeof e&&e&&!e.nodeType&&e,o=s&&s.exports===i&&r.process,a=function(){try{var e=s&&s.require&&s.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=a}).call(this,n(33)(e))},function(e,t,n){var r=n(57)(Object.keys,Object);e.exports=r},function(e,t,n){var r=n(12);e.exports=function(e,t){return function(n,i){if(null==n)return n;if(!r(n))return e(n,i);for(var s=n.length,o=t?s:-1,a=Object(n);(t?o--:++o<s)&&!1!==i(a[o],o,a););return n}}},function(e,t,n){var r=n(16);e.exports=function(e){return"function"==typeof e?e:r}},function(e,t,n){var r=n(254),i=n(259),s=n(65),o=i(function(e,t){r(t,s(t),e)});e.exports=o},function(e,t,n){var r=n(58),i=n(59);e.exports=function(e,t,n,s){var o=!n;n||(n={});for(var a=-1,c=t.length;++a<c;){var u=t[a],l=s?s(n[u],e[u],u,n,e):void 0;void 0===l&&(l=e[u]),o?i(n,u,l):r(n,u,l)}return n}},function(e,t,n){var r=n(31),i=n(256),s=n(6),o=n(61),a=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,l=c.toString,d=u.hasOwnProperty,h=RegExp("^"+l.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!s(e)||i(e))&&(r(e)?h:a).test(o(e))}},function(e,t,n){var r,i=n(257),s=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!s&&s in e}},function(e,t,n){var r=n(4)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(62),i=n(263);e.exports=function(e){return r(function(t,n){var r=-1,s=n.length,o=s>1?n[s-1]:void 0,a=s>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(s--,o):void 0,a&&i(n[0],n[1],a)&&(o=s<3?void 0:o,s=1),t=Object(t);++r<s;){var c=n[r];c&&e(t,c,r,o)}return t})}},function(e,t,n){var r=n(36),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var s=arguments,o=-1,a=i(s.length-t,0),c=Array(a);++o<a;)c[o]=s[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=s[o];return u[t]=n(c),r(e,this,u)}}},function(e,t,n){var r=n(262),i=n(60),s=n(16),o=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:s;e.exports=o},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,n){var r=n(23),i=n(12),s=n(15),o=n(6);e.exports=function(e,t,n){if(!o(n))return!1;var a=typeof t;return!!("number"==a?i(n)&&s(t,n.length):"string"==a&&t in n)&&r(n[t],e)}},function(e,t,n){var r=n(6),i=n(56),s=n(265),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return s(e);var t=i(e),n=[];for(var a in e)("constructor"!=a||!t&&o.call(e,a))&&n.push(a);return n}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t){e.exports=function(e,t,n,r){for(var i=e.length,s=n+(r?1:-1);r?s--:++s<i;)if(t(e[s],s,e))return s;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},function(e,t,n){var r=n(37);e.exports=function(e,t){return r(t,function(t){return e[t]})}},function(e,t,n){var r=n(68),i=n(271),s=n(272),o=n(71),a=n(285),c=n(75),u=n(286),l=n(78),d=n(79),h=n(34),f="Expected a function",p=1,g=2,m=8,_=16,v=32,b=64,y=Math.max;e.exports=function(e,t,n,S,w,x,E,A){var j=t&g;if(!j&&"function"!=typeof e)throw new TypeError(f);var N=S?S.length:0;if(N||(t&=~(v|b),S=w=void 0),E=void 0===E?E:y(h(E),0),A=void 0===A?A:h(A),N-=w?w.length:0,t&b){var C=S,O=w;S=w=void 0}var T=j?void 0:c(e),R=[e,t,n,S,w,C,O,x,E,A];if(T&&u(R,T),e=R[0],t=R[1],n=R[2],S=R[3],w=R[4],!(A=R[9]=void 0===R[9]?j?0:e.length:y(R[9]-N,0))&&t&(m|_)&&(t&=~(m|_)),t&&t!=p)M=t==m||t==_?s(e,t,A):t!=v&&t!=(p|v)||w.length?o.apply(void 0,R):a(e,t,n,S);else var M=i(e,t,n);return d((T?r:l)(M,R),e,t)}},function(e,t,n){var r=n(24),i=n(4),s=1;e.exports=function(e,t,n){var o=t&s,a=r(e);return function t(){return(this&&this!==i&&this instanceof t?a:e).apply(o?n:this,arguments)}}},function(e,t,n){var r=n(36),i=n(24),s=n(71),o=n(74),a=n(41),c=n(25),u=n(4);e.exports=function(e,t,n){var l=i(e);return function i(){for(var d=arguments.length,h=Array(d),f=d,p=a(i);f--;)h[f]=arguments[f];var g=d<3&&h[0]!==p&&h[d-1]!==p?[]:c(h,p);return(d-=g.length)<n?o(e,t,s,i.placeholder,void 0,h,g,void 0,void 0,n-d):r(this&&this!==u&&this instanceof i?l:e,this,h)}}},function(e,t){e.exports=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}},function(e,t,n){var r=n(39),i=n(75),s=n(276),o=n(278);e.exports=function(e){var t=s(e),n=o[t];if("function"!=typeof n||!(t in r.prototype))return!1;if(e===n)return!0;var a=i(n);return!!a&&e===a[0]}},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(277),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",n=r[t],s=i.call(r,t)?n.length:0;s--;){var o=n[s],a=o.func;if(null==a||a==e)return o.name}return t}},function(e,t){e.exports={}},function(e,t,n){var r=n(39),i=n(76),s=n(40),o=n(5),a=n(7),c=n(279),u=Object.prototype.hasOwnProperty;function l(e){if(a(e)&&!o(e)&&!(e instanceof r)){if(e instanceof i)return e;if(u.call(e,"__wrapped__"))return c(e)}return new i(e)}l.prototype=s.prototype,l.prototype.constructor=l,e.exports=l},function(e,t,n){var r=n(39),i=n(76),s=n(77);e.exports=function(e){if(e instanceof r)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=s(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},function(e,t){var n=/\{\n\/\* \[wrapped with (.+)\] \*/,r=/,? & /;e.exports=function(e){var t=e.match(n);return t?t[1].split(r):[]}},function(e,t){var n=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var r=t.length;if(!r)return e;var i=r-1;return t[i]=(r>1?"& ":"")+t[i],t=t.join(r>2?", ":" "),e.replace(n,"{\n/* [wrapped with "+t+"] */\n")}},function(e,t,n){var r=n(50),i=n(283),s=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return r(s,function(n){var r="_."+n[0];t&n[1]&&!i(e,r)&&e.push(r)}),e.sort()}},function(e,t,n){var r=n(66);e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},function(e,t,n){var r=n(77),i=n(15),s=Math.min;e.exports=function(e,t){for(var n=e.length,o=s(t.length,n),a=r(e);o--;){var c=t[o];e[o]=i(c,n)?a[c]:void 0}return e}},function(e,t,n){var r=n(36),i=n(24),s=n(4),o=1;e.exports=function(e,t,n,a){var c=t&o,u=i(e);return function t(){for(var i=-1,o=arguments.length,l=-1,d=a.length,h=Array(d+o),f=this&&this!==s&&this instanceof t?u:e;++l<d;)h[l]=a[l];for(;o--;)h[l++]=arguments[++i];return r(f,c?n:this,h)}}},function(e,t,n){var r=n(72),i=n(73),s=n(25),o="__lodash_placeholder__",a=1,c=2,u=4,l=8,d=128,h=256,f=Math.min;e.exports=function(e,t){var n=e[1],p=t[1],g=n|p,m=g<(a|c|d),_=p==d&&n==l||p==d&&n==h&&e[7].length<=t[8]||p==(d|h)&&t[7].length<=t[8]&&n==l;if(!m&&!_)return e;p&a&&(e[2]=t[2],g|=n&a?0:u);var v=t[3];if(v){var b=e[3];e[3]=b?r(b,v,t[4]):v,e[4]=b?s(e[3],o):t[4]}return(v=t[5])&&(b=e[5],e[5]=b?i(b,v,t[6]):v,e[6]=b?s(e[5],o):t[6]),(v=t[7])&&(e[7]=v),p&d&&(e[8]=null==e[8]?t[8]:f(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=g,e}},function(e,t,n){var r=n(288),i=n(329),s=n(16),o=n(5),a=n(338);e.exports=function(e){return"function"==typeof e?e:null==e?s:"object"==typeof e?o(e)?i(e[0],e[1]):r(e):a(e)}},function(e,t,n){var r=n(289),i=n(328),s=n(89);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?s(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},function(e,t,n){var r=n(80),i=n(81),s=1,o=2;e.exports=function(e,t,n,a){var c=n.length,u=c,l=!a;if(null==e)return!u;for(e=Object(e);c--;){var d=n[c];if(l&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++c<u;){var h=(d=n[c])[0],f=e[h],p=d[1];if(l&&d[2]){if(void 0===f&&!(h in e))return!1}else{var g=new r;if(a)var m=a(f,p,h,e,t,g);if(!(void 0===m?i(p,f,s|o,a,g):m))return!1}}return!0}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(27),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():i.call(t,n,1),--this.size,0))}},function(e,t,n){var r=n(27);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(27);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(27);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},function(e,t,n){var r=n(26);e.exports=function(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(26),i=n(42),s=n(43),o=200;e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!i||a.length<o-1)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new s(a)}return n.set(e,t),this.size=n.size,this}},function(e,t,n){var r=n(301),i=n(26),s=n(42);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(s||i),string:new r}}},function(e,t,n){var r=n(302),i=n(303),s=n(304),o=n(305),a=n(306);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=s,c.prototype.has=o,c.prototype.set=a,e.exports=c},function(e,t,n){var r=n(28);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(28),i="__lodash_hash_undefined__",s=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return n===i?void 0:n}return s.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(28),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},function(e,t,n){var r=n(28),i="__lodash_hash_undefined__";e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?i:t,this}},function(e,t,n){var r=n(29);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(29);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(29);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(29);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},function(e,t,n){var r=n(80),i=n(82),s=n(318),o=n(322),a=n(87),c=n(5),u=n(53),l=n(54),d=1,h="[object Arguments]",f="[object Array]",p="[object Object]",g=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,m,_,v){var b=c(e),y=c(t),S=b?f:a(e),w=y?f:a(t),x=(S=S==h?p:S)==p,E=(w=w==h?p:w)==p,A=S==w;if(A&&u(e)){if(!u(t))return!1;b=!0,x=!1}if(A&&!x)return v||(v=new r),b||l(e)?i(e,t,n,m,_,v):s(e,t,S,n,m,_,v);if(!(n&d)){var j=x&&g.call(e,"__wrapped__"),N=E&&g.call(t,"__wrapped__");if(j||N){var C=j?e.value():e,O=N?t.value():t;return v||(v=new r),_(C,O,n,m,v)}}return!!A&&(v||(v=new r),o(e,t,n,m,_,v))}},function(e,t,n){var r=n(43),i=n(314),s=n(315);function o(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}o.prototype.add=o.prototype.push=i,o.prototype.has=s,e.exports=o},function(e,t){var n="__lodash_hash_undefined__";e.exports=function(e){return this.__data__.set(e,n),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(22),i=n(319),s=n(23),o=n(82),a=n(320),c=n(321),u=1,l=2,d="[object Boolean]",h="[object Date]",f="[object Error]",p="[object Map]",g="[object Number]",m="[object RegExp]",_="[object Set]",v="[object String]",b="[object Symbol]",y="[object ArrayBuffer]",S="[object DataView]",w=r?r.prototype:void 0,x=w?w.valueOf:void 0;e.exports=function(e,t,n,r,w,E,A){switch(n){case S:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case y:return!(e.byteLength!=t.byteLength||!E(new i(e),new i(t)));case d:case h:case g:return s(+e,+t);case f:return e.name==t.name&&e.message==t.message;case m:case v:return e==t+"";case p:var j=a;case _:var N=r&u;if(j||(j=c),e.size!=t.size&&!N)return!1;var C=A.get(e);if(C)return C==t;r|=l,A.set(e,t);var O=o(j(e),j(t),r,w,E,A);return A.delete(e),O;case b:if(x)return x.call(e)==x.call(t)}return!1}},function(e,t,n){var r=n(4).Uint8Array;e.exports=r},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},function(e,t,n){var r=n(323),i=1,s=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,a,c){var u=n&i,l=r(e),d=l.length;if(d!=r(t).length&&!u)return!1;for(var h=d;h--;){var f=l[h];if(!(u?f in t:s.call(t,f)))return!1}var p=c.get(e);if(p&&c.get(t))return p==t;var g=!0;c.set(e,t),c.set(t,e);for(var m=u;++h<d;){var _=e[f=l[h]],v=t[f];if(o)var b=u?o(v,_,f,t,e,c):o(_,v,f,e,t,c);if(!(void 0===b?_===v||a(_,v,n,o,c):b)){g=!1;break}m||(m="constructor"==f)}if(g&&!m){var y=e.constructor,S=t.constructor;y!=S&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof S&&S instanceof S)&&(g=!1)}return c.delete(e),c.delete(t),g}},function(e,t,n){var r=n(83),i=n(85),s=n(13);e.exports=function(e){return r(e,s,i)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,s=[];++n<r;){var o=e[n];t(o,n,e)&&(s[i++]=o)}return s}},function(e,t,n){var r=n(10)(n(4),"DataView");e.exports=r},function(e,t,n){var r=n(10)(n(4),"Promise");e.exports=r},function(e,t,n){var r=n(10)(n(4),"Set");e.exports=r},function(e,t,n){var r=n(88),i=n(13);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var s=t[n],o=e[s];t[n]=[s,o,r(o)]}return t}},function(e,t,n){var r=n(81),i=n(330),s=n(335),o=n(45),a=n(88),c=n(89),u=n(17),l=1,d=2;e.exports=function(e,t){return o(e)&&a(t)?c(u(e),t):function(n){var o=i(n,e);return void 0===o&&o===t?s(n,e):r(t,o,l|d)}}},function(e,t,n){var r=n(44);e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}},function(e,t,n){var r=n(332),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,o=r(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,function(e,n,r,i){t.push(r?i.replace(s,"$1"):n||e)}),t});e.exports=o},function(e,t,n){var r=n(333),i=500;e.exports=function(e){var t=r(e,function(e){return n.size===i&&n.clear(),e}),n=t.cache;return t}},function(e,t,n){var r=n(43),i="Expected a function";function s(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(i);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=e.apply(this,r);return n.cache=s.set(i,o)||s,o};return n.cache=new(s.Cache||r),n}s.Cache=r,e.exports=s},function(e,t,n){var r=n(22),i=n(37),s=n(5),o=n(21),a=1/0,c=r?r.prototype:void 0,u=c?c.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(s(t))return i(t,e)+"";if(o(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-a?"-0":n}},function(e,t,n){var r=n(336),i=n(337);e.exports=function(e,t){return null!=e&&i(e,t,r)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,n){var r=n(30),i=n(52),s=n(5),o=n(15),a=n(35),c=n(17);e.exports=function(e,t,n){for(var u=-1,l=(t=r(t,e)).length,d=!1;++u<l;){var h=c(t[u]);if(!(d=null!=e&&n(e,h)))break;e=e[h]}return d||++u!=l?d:!!(l=null==e?0:e.length)&&a(l)&&o(h,l)&&(s(e)||i(e))}},function(e,t,n){var r=n(91),i=n(339),s=n(45),o=n(17);e.exports=function(e){return s(e)?r(o(e)):i(e)}},function(e,t,n){var r=n(44);e.exports=function(e){return function(t){return r(t,e)}}},function(e,t,n){var r=n(44),i=n(341),s=n(30);e.exports=function(e,t,n){for(var o=-1,a=t.length,c={};++o<a;){var u=t[o],l=r(e,u);n(l,u)&&i(c,s(u,e),l)}return c}},function(e,t,n){var r=n(58),i=n(30),s=n(15),o=n(6),a=n(17);e.exports=function(e,t,n,c){if(!o(e))return e;for(var u=-1,l=(t=i(t,e)).length,d=l-1,h=e;null!=h&&++u<l;){var f=a(t[u]),p=n;if(u!=d){var g=h[f];void 0===(p=c?c(g,f,h):void 0)&&(p=o(g)?g:s(t[u+1])?[]:{})}r(h,f,p),h=h[f]}return e}},function(e,t,n){var r=n(83),i=n(343),s=n(65);e.exports=function(e){return r(e,s,i)}},function(e,t,n){var r=n(84),i=n(344),s=n(85),o=n(86),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,s(e)),e=i(e);return t}:o;e.exports=a},function(e,t,n){var r=n(57)(Object.getPrototypeOf,Object);e.exports=r},function(e,t,n){var r=n(346),i=n(347),s=n(348);e.exports=function(e){return i(e)?s(e):r(e)}},function(e,t,n){var r=n(91)("length");e.exports=r},function(e,t){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return n.test(e)}},function(e,t){var n="[\\ud800-\\udfff]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",s="[^\\ud800-\\udfff]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",c="(?:"+r+"|"+i+")"+"?",u="[\\ufe0e\\ufe0f]?"+c+("(?:\\u200d(?:"+[s,o,a].join("|")+")[\\ufe0e\\ufe0f]?"+c+")*"),l="(?:"+[s+r+"?",r,o,a,n].join("|")+")",d=RegExp(i+"(?="+i+")|"+l+u,"g");e.exports=function(e){for(var t=d.lastIndex=0;d.test(e);)++t;return t}},function(e,t){function n(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}"function"!=typeof window.CustomEvent&&(n.prototype=window.Event.prototype,window.CustomEvent=n),String.prototype.includes||(String.prototype.includes=function(e,t){"use strict";return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();(void 0===t||t>n.length)&&(t=n.length),t-=e.length;var r=n.indexOf(e,t);return-1!==r&&r===t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),String.prototype.splitOnce||(String.prototype.splitOnce=function(e){var t=this.split(e);return[t.shift(),t.join(e)]}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")})},function(e,t,n){var r=n(351)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});e.exports=r},function(e,t){e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r);const s=function(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n},o=function(e){if("string"!=typeof e)throw new Error("str2binl was passed a non-string");const t=[];for(let n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t},a=function(e,t,n,r,i,o){return s((a=s(s(t,e),s(r,o)))<<(c=i)|a>>>32-c,n);var a,c},c=function(e,t,n,r,i,s,o){return a(t&n|~t&r,e,t,i,s,o)},u=function(e,t,n,r,i,s,o){return a(t&r|n&~r,e,t,i,s,o)},l=function(e,t,n,r,i,s,o){return a(t^n^r,e,t,i,s,o)},d=function(e,t,n,r,i,s,o){return a(n^(t|~r),e,t,i,s,o)},h=function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let n,r,i,o,a=1732584193,h=-271733879,f=-1732584194,p=271733878;for(let t=0;t<e.length;t+=16)n=a,r=h,i=f,o=p,a=c(a,h,f,p,e[t+0],7,-680876936),p=c(p,a,h,f,e[t+1],12,-389564586),f=c(f,p,a,h,e[t+2],17,606105819),h=c(h,f,p,a,e[t+3],22,-1044525330),a=c(a,h,f,p,e[t+4],7,-176418897),p=c(p,a,h,f,e[t+5],12,1200080426),f=c(f,p,a,h,e[t+6],17,-1473231341),h=c(h,f,p,a,e[t+7],22,-45705983),a=c(a,h,f,p,e[t+8],7,1770035416),p=c(p,a,h,f,e[t+9],12,-1958414417),f=c(f,p,a,h,e[t+10],17,-42063),h=c(h,f,p,a,e[t+11],22,-1990404162),a=c(a,h,f,p,e[t+12],7,1804603682),p=c(p,a,h,f,e[t+13],12,-40341101),f=c(f,p,a,h,e[t+14],17,-1502002290),h=c(h,f,p,a,e[t+15],22,1236535329),a=u(a,h,f,p,e[t+1],5,-165796510),p=u(p,a,h,f,e[t+6],9,-1069501632),f=u(f,p,a,h,e[t+11],14,643717713),h=u(h,f,p,a,e[t+0],20,-373897302),a=u(a,h,f,p,e[t+5],5,-701558691),p=u(p,a,h,f,e[t+10],9,38016083),f=u(f,p,a,h,e[t+15],14,-660478335),h=u(h,f,p,a,e[t+4],20,-405537848),a=u(a,h,f,p,e[t+9],5,568446438),p=u(p,a,h,f,e[t+14],9,-1019803690),f=u(f,p,a,h,e[t+3],14,-187363961),h=u(h,f,p,a,e[t+8],20,1163531501),a=u(a,h,f,p,e[t+13],5,-1444681467),p=u(p,a,h,f,e[t+2],9,-51403784),f=u(f,p,a,h,e[t+7],14,1735328473),h=u(h,f,p,a,e[t+12],20,-1926607734),a=l(a,h,f,p,e[t+5],4,-378558),p=l(p,a,h,f,e[t+8],11,-2022574463),f=l(f,p,a,h,e[t+11],16,1839030562),h=l(h,f,p,a,e[t+14],23,-35309556),a=l(a,h,f,p,e[t+1],4,-1530992060),p=l(p,a,h,f,e[t+4],11,1272893353),f=l(f,p,a,h,e[t+7],16,-155497632),h=l(h,f,p,a,e[t+10],23,-1094730640),a=l(a,h,f,p,e[t+13],4,681279174),p=l(p,a,h,f,e[t+0],11,-358537222),f=l(f,p,a,h,e[t+3],16,-722521979),h=l(h,f,p,a,e[t+6],23,76029189),a=l(a,h,f,p,e[t+9],4,-640364487),p=l(p,a,h,f,e[t+12],11,-421815835),f=l(f,p,a,h,e[t+15],16,530742520),h=l(h,f,p,a,e[t+2],23,-995338651),a=d(a,h,f,p,e[t+0],6,-198630844),p=d(p,a,h,f,e[t+7],10,1126891415),f=d(f,p,a,h,e[t+14],15,-1416354905),h=d(h,f,p,a,e[t+5],21,-57434055),a=d(a,h,f,p,e[t+12],6,1700485571),p=d(p,a,h,f,e[t+3],10,-1894986606),f=d(f,p,a,h,e[t+10],15,-1051523),h=d(h,f,p,a,e[t+1],21,-2054922799),a=d(a,h,f,p,e[t+8],6,1873313359),p=d(p,a,h,f,e[t+15],10,-30611744),f=d(f,p,a,h,e[t+6],15,-1560198380),h=d(h,f,p,a,e[t+13],21,1309151649),a=d(a,h,f,p,e[t+4],6,-145523070),p=d(p,a,h,f,e[t+11],10,-1120210379),f=d(f,p,a,h,e[t+2],15,718787259),h=d(h,f,p,a,e[t+9],21,-343485551),a=s(a,n),h=s(h,r),f=s(f,i),p=s(p,o);return[a,h,f,p]},f={hexdigest:function(e){return function(e){let t="";for(let n=0;n<4*e.length;n++)t+="0123456789abcdef".charAt(e[n>>2]>>n%4*8+4&15)+"0123456789abcdef".charAt(e[n>>2]>>n%4*8&15);return t}(h(o(e),8*e.length))},hash:function(e){return function(e){let t="";for(let n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}(h(o(e),8*e.length))}};function p(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;var n,r,i,s,o,a,c,u,l=new Array(80),d=1732584193,h=-271733879,f=-1732584194,p=271733878,_=-1009589776;for(n=0;n<e.length;n+=16){for(s=d,o=h,a=f,c=p,u=_,r=0;r<80;r++)l[r]=r<16?e[n+r]:b(l[r-3]^l[r-8]^l[r-14]^l[r-16],1),i=v(v(b(d,5),g(r,h,f,p)),v(v(_,l[r]),m(r))),_=p,p=f,f=b(h,30),h=d,d=i;d=v(d,s),h=v(h,o),f=v(f,a),p=v(p,c),_=v(_,u)}return[d,h,f,p,_]}function g(e,t,n,r){return e<20?t&n|~t&r:e<40?t^n^r:e<60?t&n|t&r|n&r:t^n^r}function m(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function _(e,t){var n=y(e);n.length>16&&(n=p(n,8*e.length));for(var r=new Array(16),i=new Array(16),s=0;s<16;s++)r[s]=909522486^n[s],i[s]=1549556828^n[s];var o=p(r.concat(y(t)),512+8*t.length);return p(i.concat(o),672)}function v(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function b(e,t){return e<<t|e>>>32-t}function y(e){for(var t=[],n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t}function S(e){for(var t,n,r="",i=0;i<4*e.length;i+=3)for(t=(e[i>>2]>>8*(3-i%4)&255)<<16|(e[i+1>>2]>>8*(3-(i+1)%4)&255)<<8|e[i+2>>2]>>8*(3-(i+2)%4)&255,n=0;n<4;n++)8*i+6*n>32*e.length?r+="=":r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>6*(3-n)&63);return r}function w(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>24-n%32&255);return t}const x={b64_hmac_sha1:function(e,t){return S(_(e,t))},b64_sha1:function(e){return S(p(y(e),8*e.length))},binb2str:w,core_hmac_sha1:_,str_hmac_sha1:function(e,t){return w(_(e,t))},str_sha1:function(e){return w(p(y(e),8*e.length))}},E=function(e){var t,n,r="",i=e.length;for(t=0;t<i;t++)(n=e.charCodeAt(t))>=0&&n<=127?r+=e.charAt(t):n>2047?(r+=String.fromCharCode(224|n>>12&15),r+=String.fromCharCode(128|n>>6&63),r+=String.fromCharCode(128|n>>0&63)):(r+=String.fromCharCode(192|n>>6&31),r+=String.fromCharCode(128|n>>0&63));return r},A=function(e){e=e||{};for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let n="",r="",i="";const s=e[t],o="object"==typeof s,a=escape(unescape(o?s.value:s));o&&(n=s.expires?";expires="+s.expires:"",r=s.domain?";domain="+s.domain:"",i=s.path?";path="+s.path:""),document.cookie=t+"="+a+n+r+i}};function j(e,t){return new O.Builder(e,t)}function N(e){return new O.Builder("iq",e)}function C(e){return new O.Builder("presence",e)}const O={VERSION:"@VERSION@",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag:function(e){for(let t=0;t<O.XHTML.tags.length;t++)if(e===O.XHTML.tags[t])return!0;return!1},validAttribute:function(e,t){if(void 0!==O.XHTML.attributes[e]&&O.XHTML.attributes[e].length>0)for(let n=0;n<O.XHTML.attributes[e].length;n++)if(t===O.XHTML.attributes[e][n])return!0;return!1},validCSS:function(e){for(let t=0;t<O.XHTML.css.length;t++)if(e===O.XHTML.css[t])return!0;return!1}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8,REDIRECT:9,CONNTIMEOUT:10,BINDREQUIRED:11},ErrorCondition:{BAD_FORMAT:"bad-format",CONFLICT:"conflict",MISSING_JID_NODE:"x-strophe-bad-non-anon-jid",NO_AUTH_MECH:"no-auth-mech",UNKNOWN_REASON:"unknown"},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace:function(e,t){O.NS[e]=t},forEachChild:function(e,t,n){for(let r=0;r<e.childNodes.length;r++){const i=e.childNodes[r];i.nodeType!==O.ElementType.NORMAL||t&&!this.isTagEqual(i,t)||n(i)}},isTagEqual:function(e,t){return e.tagName===t},_xmlGenerator:null,_makeGenerator:function(){let e;return void 0===document.implementation.createDocument||document.implementation.createDocument&&document.documentMode&&document.documentMode<10?(e=this._getIEXmlDom()).appendChild(e.createElement("strophe")):e=document.implementation.createDocument("jabber:client","strophe",null),e},xmlGenerator:function(){return O._xmlGenerator||(O._xmlGenerator=O._makeGenerator()),O._xmlGenerator},_getIEXmlDom:function(){let e=null;const t=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"];for(let n=0;n<t.length&&null===e;n++)try{e=new ActiveXObject(t[n])}catch(t){e=null}return e},xmlElement:function(e){if(!e)return null;const t=O.xmlGenerator().createElement(e);for(let e=1;e<arguments.length;e++){const n=arguments[e];if(n)if("string"==typeof n||"number"==typeof n)t.appendChild(O.xmlTextNode(n));else if("object"==typeof n&&"function"==typeof n.sort)for(let e=0;e<n.length;e++){const r=n[e];"object"==typeof r&&"function"==typeof r.sort&&void 0!==r[1]&&null!==r[1]&&t.setAttribute(r[0],r[1])}else if("object"==typeof n)for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&void 0!==n[e]&&null!==n[e]&&t.setAttribute(e,n[e])}return t},xmlescape:function(e){return e=(e=(e=(e=(e=e.replace(/\&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;")},xmlunescape:function(e){return e=(e=(e=(e=(e=e.replace(/\&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')},xmlTextNode:function(e){return O.xmlGenerator().createTextNode(e)},xmlHtmlNode:function(e){let t;if(DOMParser){t=(new DOMParser).parseFromString(e,"text/xml")}else(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},getText:function(e){if(!e)return null;let t="";0===e.childNodes.length&&e.nodeType===O.ElementType.TEXT&&(t+=e.nodeValue);for(let n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType===O.ElementType.TEXT&&(t+=e.childNodes[n].nodeValue);return O.xmlescape(t)},copyElement:function(e){let t;if(e.nodeType===O.ElementType.NORMAL){t=O.xmlElement(e.tagName);for(let n=0;n<e.attributes.length;n++)t.setAttribute(e.attributes[n].nodeName,e.attributes[n].value);for(let n=0;n<e.childNodes.length;n++)t.appendChild(O.copyElement(e.childNodes[n]))}else e.nodeType===O.ElementType.TEXT&&(t=O.xmlGenerator().createTextNode(e.nodeValue));return t},createHtml:function(e){let t;if(e.nodeType===O.ElementType.NORMAL){const n=e.nodeName.toLowerCase();if(O.XHTML.validTag(n))try{t=O.xmlElement(n);for(let r=0;r<O.XHTML.attributes[n].length;r++){const i=O.XHTML.attributes[n][r];let s=e.getAttribute(i);if(null!=s&&""!==s&&!1!==s&&0!==s)if("style"===i&&"object"==typeof s&&void 0!==s.cssText&&(s=s.cssText),"style"===i){const e=[],n=s.split(";");for(let t=0;t<n.length;t++){const r=n[t].split(":"),i=r[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();if(O.XHTML.validCSS(i)){const t=r[1].replace(/^\s*/,"").replace(/\s*$/,"");e.push(i+": "+t)}}e.length>0&&(s=e.join("; "),t.setAttribute(i,s))}else t.setAttribute(i,s)}for(let n=0;n<e.childNodes.length;n++)t.appendChild(O.createHtml(e.childNodes[n]))}catch(e){t=O.xmlTextNode("")}else{t=O.xmlGenerator().createDocumentFragment();for(let n=0;n<e.childNodes.length;n++)t.appendChild(O.createHtml(e.childNodes[n]))}}else if(e.nodeType===O.ElementType.FRAGMENT){t=O.xmlGenerator().createDocumentFragment();for(let n=0;n<e.childNodes.length;n++)t.appendChild(O.createHtml(e.childNodes[n]))}else e.nodeType===O.ElementType.TEXT&&(t=O.xmlTextNode(e.nodeValue));return t},escapeNode:function(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode:function(e){return"string"!=typeof e?e:e.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid:function(e){return e.indexOf("@")<0?null:e.split("@")[0]},getDomainFromJid:function(e){const t=O.getBareJidFromJid(e);if(t.indexOf("@")<0)return t;{const e=t.split("@");return e.splice(0,1),e.join("@")}},getResourceFromJid:function(e){if(!e)return null;const t=e.split("/");return t.length<2?null:(t.splice(0,1),t.join("/"))},getBareJidFromJid:function(e){return e?e.split("/")[0]:null},_handleError:function(e){void 0!==e.stack&&O.fatal(e.stack),e.sourceURL?O.fatal("error: "+this.handler+" "+e.sourceURL+":"+e.line+" - "+e.name+": "+e.message):e.fileName?O.fatal("error: "+this.handler+" "+e.fileName+":"+e.lineNumber+" - "+e.name+": "+e.message):O.fatal("error: "+e.message)},log:function(e,t){e===this.LogLevel.FATAL&&"object"==typeof window.console&&"function"==typeof window.console.error&&window.console.error(t)},debug:function(e){this.log(this.LogLevel.DEBUG,e)},info:function(e){this.log(this.LogLevel.INFO,e)},warn:function(e){this.log(this.LogLevel.WARN,e)},error:function(e){this.log(this.LogLevel.ERROR,e)},fatal:function(e){this.log(this.LogLevel.FATAL,e)},serialize:function(e){if(!e)return null;"function"==typeof e.tree&&(e=e.tree());const t=[...Array(e.attributes.length).keys()].map(t=>e.attributes[t].nodeName);t.sort();let n=t.reduce((t,n)=>`${t} ${n}="${O.xmlescape(e.attributes.getNamedItem(n).value)}"`,`<${e.nodeName}`);if(e.childNodes.length>0){n+=">";for(let t=0;t<e.childNodes.length;t++){const r=e.childNodes[t];switch(r.nodeType){case O.ElementType.NORMAL:n+=O.serialize(r);break;case O.ElementType.TEXT:n+=O.xmlescape(r.nodeValue);break;case O.ElementType.CDATA:n+="<![CDATA["+r.nodeValue+"]]>"}}n+="</"+e.nodeName+">"}else n+="/>";return n},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(e,t){O._connectionPlugins[e]=t},Builder:function(e,t){"presence"!==e&&"message"!==e&&"iq"!==e||(t&&!t.xmlns?t.xmlns=O.NS.CLIENT:t||(t={xmlns:O.NS.CLIENT})),this.nodeTree=O.xmlElement(e,t),this.node=this.nodeTree}};O.Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return O.serialize(this.nodeTree)},up:function(){return this.node=this.node.parentNode,this},root:function(){return this.node=this.nodeTree,this},attrs:function(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(void 0===e[t]?this.node.removeAttribute(t):this.node.setAttribute(t,e[t]));return this},c:function(e,t,n){const r=O.xmlElement(e,t,n);return this.node.appendChild(r),"string"!=typeof n&&"number"!=typeof n&&(this.node=r),this},cnode:function(e){let t;const n=O.xmlGenerator();try{t=void 0!==n.importNode}catch(e){t=!1}const r=t?n.importNode(e,!0):O.copyElement(e);return this.node.appendChild(r),this.node=r,this},t:function(e){const t=O.xmlTextNode(e);return this.node.appendChild(t),this},h:function(e){const t=document.createElement("body");t.innerHTML=e;const n=O.createHtml(t);for(;n.childNodes.length>0;)this.node.appendChild(n.childNodes[0]);return this}},O.Handler=function(e,t,n,r,i,s,o){this.handler=e,this.ns=t,this.name=n,this.type=r,this.id=i,this.options=o||{matchBareFromJid:!1,ignoreNamespaceFragment:!1},this.options.matchBare&&(O.warn('The "matchBare" option is deprecated, use "matchBareFromJid" instead.'),this.options.matchBareFromJid=this.options.matchBare,delete this.options.matchBare),this.options.matchBareFromJid?this.from=s?O.getBareJidFromJid(s):null:this.from=s,this.user=!0},O.Handler.prototype={getNamespace:function(e){let t=e.getAttribute("xmlns");return t&&this.options.ignoreNamespaceFragment&&(t=t.split("#")[0]),t},namespaceMatch:function(e){let t=!1;return!this.ns||(O.forEachChild(e,null,e=>{this.getNamespace(e)===this.ns&&(t=!0)}),t||this.getNamespace(e)===this.ns)},isMatch:function(e){let t=e.getAttribute("from");this.options.matchBareFromJid&&(t=O.getBareJidFromJid(t));const n=e.getAttribute("type");return!(!this.namespaceMatch(e)||this.name&&!O.isTagEqual(e,this.name)||this.type&&(Array.isArray(this.type)?-1===this.type.indexOf(n):n!==this.type)||this.id&&e.getAttribute("id")!==this.id||this.from&&t!==this.from)},run:function(e){let t=null;try{t=this.handler(e)}catch(e){throw O._handleError(e),e}return t},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}},O.TimedHandler=function(e,t){this.period=e,this.handler=t,this.lastCalled=(new Date).getTime(),this.user=!0},O.TimedHandler.prototype={run:function(){return this.lastCalled=(new Date).getTime(),this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}},O.Connection=function(e,t){this.service=e,this.options=t||{};const n=this.options.protocol||"";0===e.indexOf("ws:")||0===e.indexOf("wss:")||0===n.indexOf("ws")?this._proto=new O.Websocket(this):this._proto=new O.Bosh(this),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.protocolErrorHandlers={HTTP:{},websocket:{}},this._idleTimeout=null,this._disconnectTimeout=null,this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.do_authentication=!0,this.paused=!1,this.restored=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout(()=>this._onIdle(),100),A(this.options.cookies),this.registerSASLMechanisms(this.options.mechanisms);for(const e in O._connectionPlugins)if(Object.prototype.hasOwnProperty.call(O._connectionPlugins,e)){const t=function(){};t.prototype=O._connectionPlugins[e],this[e]=new t,this[e].init(this)}},O.Connection.prototype={reset:function(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.restored=!1,this._data=[],this._requests=[],this._uniqueId=0},pause:function(){this.paused=!0},resume:function(){this.paused=!1},getUniqueId:function(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)});return"string"==typeof e||"number"==typeof e?t+":"+e:t+""},addProtocolErrorHandler:function(e,t,n){this.protocolErrorHandlers[e][t]=n},connect:function(e,t,n,r,i,s,o){this.jid=e,this.authzid=O.getBareJidFromJid(this.jid),this.authcid=o||O.getNodeFromJid(this.jid),this.pass=t,this.servtype="xmpp",this.connect_callback=n,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.restored=!1,this.domain=O.getDomainFromJid(this.jid),this._changeConnectStatus(O.Status.CONNECTING,null),this._proto._connect(r,i,s)},attach:function(e,t,n,r,i,s,o){if(!(this._proto instanceof O.Bosh)){const e=new Error('The "attach" method can only be used with a BOSH connection.');throw e.name="StropheSessionError",e}this._proto._attach(e,t,n,r,i,s,o)},restore:function(e,t,n,r,i){if(!this._sessionCachingSupported()){const e=new Error('The "restore" method can only be used with a BOSH connection.');throw e.name="StropheSessionError",e}this._proto._restore(e,t,n,r,i)},_sessionCachingSupported:function(){if(this._proto instanceof O.Bosh){if(!JSON)return!1;try{sessionStorage.setItem("_strophe_","_strophe_"),sessionStorage.removeItem("_strophe_")}catch(e){return!1}return!0}return!1},xmlInput:function(e){},xmlOutput:function(e){},rawInput:function(e){},rawOutput:function(e){},nextValidRid:function(e){},send:function(e){if(null!==e){if("function"==typeof e.sort)for(let t=0;t<e.length;t++)this._queueData(e[t]);else"function"==typeof e.tree?this._queueData(e.tree()):this._queueData(e);this._proto._send()}},flush:function(){clearTimeout(this._idleTimeout),this._onIdle()},sendPresence:function(e,t,n,r){let i=null;"function"==typeof e.tree&&(e=e.tree());let s=e.getAttribute("id");if(s||(s=this.getUniqueId("sendPresence"),e.setAttribute("id",s)),"function"==typeof t||"function"==typeof n){const e=this.addHandler(e=>{i&&this.deleteTimedHandler(i),"error"===e.getAttribute("type")?n&&n(e):t&&t(e)},null,"presence",null,s);r&&(i=this.addTimedHandler(r,()=>(this.deleteHandler(e),n&&n(null),!1)))}return this.send(e),s},sendIQ:function(e,t,n,r){let i=null;"function"==typeof e.tree&&(e=e.tree());let s=e.getAttribute("id");if(s||(s=this.getUniqueId("sendIQ"),e.setAttribute("id",s)),"function"==typeof t||"function"==typeof n){const e=this.addHandler(e=>{i&&this.deleteTimedHandler(i);const r=e.getAttribute("type");if("result"===r)t&&t(e);else{if("error"!==r){const e=new Error(`Got bad IQ type of ${r}`);throw e.name="StropheError",e}n&&n(e)}},null,"iq",["error","result"],s);r&&(i=this.addTimedHandler(r,()=>(this.deleteHandler(e),n&&n(null),!1)))}return this.send(e),s},_queueData:function(e){if(null===e||!e.tagName||!e.childNodes){const e=new Error("Cannot queue non-DOMElement.");throw e.name="StropheError",e}this._data.push(e)},_sendRestart:function(){this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout(()=>this._onIdle(),100)},addTimedHandler:function(e,t){const n=new O.TimedHandler(e,t);return this.addTimeds.push(n),n},deleteTimedHandler:function(e){this.removeTimeds.push(e)},addHandler:function(e,t,n,r,i,s,o){const a=new O.Handler(e,t,n,r,i,s,o);return this.addHandlers.push(a),a},deleteHandler:function(e){this.removeHandlers.push(e);const t=this.addHandlers.indexOf(e);t>=0&&this.addHandlers.splice(t,1)},registerSASLMechanisms:function(e){this.mechanisms={},(e=e||[O.SASLAnonymous,O.SASLExternal,O.SASLMD5,O.SASLOAuthBearer,O.SASLXOAuth2,O.SASLPlain,O.SASLSHA1]).forEach(this.registerSASLMechanism.bind(this))},registerSASLMechanism:function(e){this.mechanisms[e.prototype.name]=e},disconnect:function(e){if(this._changeConnectStatus(O.Status.DISCONNECTING,e),O.warn("Disconnect was called because: "+e),this.connected){let e=!1;this.disconnecting=!0,this.authenticated&&(e=C({xmlns:O.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(3e3,this._onDisconnectTimeout.bind(this)),this._proto._disconnect(e)}else O.warn("Disconnect was called before Strophe connected to the server"),this._proto._abortAllRequests(),this._doDisconnect()},_changeConnectStatus:function(e,t,n){for(const n in O._connectionPlugins)if(Object.prototype.hasOwnProperty.call(O._connectionPlugins,n)){const r=this[n];if(r.statusChanged)try{r.statusChanged(e,t)}catch(e){O.error(`${n} plugin caused an exception changing status: ${e}`)}}if(this.connect_callback)try{this.connect_callback(e,t,n)}catch(e){O._handleError(e),O.error(`User connection callback caused an exception: ${e}`)}},_doDisconnect:function(e){"number"==typeof this._idleTimeout&&clearTimeout(this._idleTimeout),null!==this._disconnectTimeout&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),O.debug("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.restored=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(O.Status.DISCONNECTED,e),this.connected=!1},_dataRecv:function(e,t){O.debug("_dataRecv called");const n=this._proto._reqToData(e);if(null===n)return;for(this.xmlInput!==O.Connection.prototype.xmlInput&&(n.nodeName===this._proto.strip&&n.childNodes.length?this.xmlInput(n.childNodes[0]):this.xmlInput(n)),this.rawInput!==O.Connection.prototype.rawInput&&(t?this.rawInput(t):this.rawInput(O.serialize(n)));this.removeHandlers.length>0;){const e=this.removeHandlers.pop(),t=this.handlers.indexOf(e);t>=0&&this.handlers.splice(t,1)}for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue())return void this._doDisconnect();const r=n.getAttribute("type");if(null!==r&&"terminate"===r){if(this.disconnecting)return;let e=n.getAttribute("condition");const t=n.getElementsByTagName("conflict");return null!==e?("remote-stream-error"===e&&t.length>0&&(e="conflict"),this._changeConnectStatus(O.Status.CONNFAIL,e)):this._changeConnectStatus(O.Status.CONNFAIL,O.ErrorCondition.UNKOWN_REASON),void this._doDisconnect(e)}O.forEachChild(n,null,e=>{const t=this.handlers;this.handlers=[];for(let n=0;n<t.length;n++){const r=t[n];try{!r.isMatch(e)||!this.authenticated&&r.user?this.handlers.push(r):r.run(e)&&this.handlers.push(r)}catch(e){O.warn("Removing Strophe handlers due to uncaught exception: "+e.message)}}})},mechanisms:{},_connect_cb:function(e,t,n){let r;O.debug("_connect_cb was called"),this.connected=!0;try{r=this._proto._reqToData(e)}catch(e){if(e.name!==O.ErrorCondition.BAD_FORMAT)throw e;this._changeConnectStatus(O.Status.CONNFAIL,O.ErrorCondition.BAD_FORMAT),this._doDisconnect(O.ErrorCondition.BAD_FORMAT)}if(!r)return;if(this.xmlInput!==O.Connection.prototype.xmlInput&&(r.nodeName===this._proto.strip&&r.childNodes.length?this.xmlInput(r.childNodes[0]):this.xmlInput(r)),this.rawInput!==O.Connection.prototype.rawInput&&(n?this.rawInput(n):this.rawInput(O.serialize(r))),this._proto._connect_cb(r)===O.Status.CONNFAIL)return;let i;if(!(i=r.getElementsByTagNameNS?r.getElementsByTagNameNS(O.NS.STREAM,"features").length>0:r.getElementsByTagName("stream:features").length>0||r.getElementsByTagName("features").length>0))return void this._proto._no_auth_received(t);const s=[],o=r.getElementsByTagName("mechanism");if(o.length>0)for(let e=0;e<o.length;e++){const t=O.getText(o[e]);this.mechanisms[t]&&s.push(this.mechanisms[t])}0!==s.length||0!==r.getElementsByTagName("auth").length?!1!==this.do_authentication&&this.authenticate(s):this._proto._no_auth_received(t)},sortMechanismsByPriority:function(e){for(let t=0;t<e.length-1;++t){let n=t;for(let r=t+1;r<e.length;++r)e[r].prototype.priority>e[n].prototype.priority&&(n=r);if(n!==t){const r=e[t];e[t]=e[n],e[n]=r}}return e},authenticate:function(e){this._attemptSASLAuth(e)||this._attemptLegacyAuth()},_attemptSASLAuth:function(e){e=this.sortMechanismsByPriority(e||[]);let t=!1;for(let n=0;n<e.length;++n){if(!e[n].prototype.test(this))continue;this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null),this._sasl_mechanism=new e[n],this._sasl_mechanism.onStart(this);const r=j("auth",{xmlns:O.NS.SASL,mechanism:this._sasl_mechanism.name});if(this._sasl_mechanism.isClientFirst){const e=this._sasl_mechanism.onChallenge(this,null);r.t(btoa(e))}this.send(r.tree()),t=!0;break}return t},_sasl_challenge_cb:function(e){const t=atob(O.getText(e)),n=this._sasl_mechanism.onChallenge(this,t),r=j("response",{xmlns:O.NS.SASL});return""!==n&&r.t(btoa(n)),this.send(r.tree()),!0},_attemptLegacyAuth:function(){null===O.getNodeFromJid(this.jid)?(this._changeConnectStatus(O.Status.CONNFAIL,O.ErrorCondition.MISSING_JID_NODE),this.disconnect(O.ErrorCondition.MISSING_JID_NODE)):(this._changeConnectStatus(O.Status.AUTHENTICATING,null),this._addSysHandler(this._onLegacyAuthIQResult.bind(this),null,null,null,"_auth_1"),this.send(N({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:O.NS.AUTH}).c("username",{}).t(O.getNodeFromJid(this.jid)).tree()))},_onLegacyAuthIQResult:function(e){const t=N({type:"set",id:"_auth_2"}).c("query",{xmlns:O.NS.AUTH}).c("username",{}).t(O.getNodeFromJid(this.jid)).up().c("password").t(this.pass);return O.getResourceFromJid(this.jid)||(this.jid=O.getBareJidFromJid(this.jid)+"/strophe"),t.up().c("resource",{}).t(O.getResourceFromJid(this.jid)),this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2"),this.send(t.tree()),!1},_sasl_success_cb:function(e){if(this._sasl_data["server-signature"]){let t;const n=/([a-z]+)=([^,]+)(,|$)/,r=atob(O.getText(e)).match(n);if("v"===r[1]&&(t=r[2]),t!==this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}O.info("SASL authentication succeeded."),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null);const t=[],n=(e,t)=>{for(;e.length;)this.deleteHandler(e.pop());return this._onStreamFeaturesAfterSASL(t),!1};return t.push(this._addSysHandler(e=>n(t,e),null,"stream:features",null,null)),t.push(this._addSysHandler(e=>n(t,e),O.NS.STREAM,"features",null,null)),this._sendRestart(),!1},_onStreamFeaturesAfterSASL:function(e){this.features=e;for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];"bind"===n.nodeName&&(this.do_bind=!0),"session"===n.nodeName&&(this.do_session=!0)}return this.do_bind?(this.options.explicitResourceBinding?this._changeConnectStatus(O.Status.BINDREQUIRED,null):this.bind(),!1):(this._changeConnectStatus(O.Status.AUTHFAIL,null),!1)},bind:function(){if(!this.do_bind)return void O.log(O.LogLevel.INFO,'Strophe.Connection.prototype.bind called but "do_bind" is false');this._addSysHandler(this._onResourceBindResultIQ.bind(this),null,null,null,"_bind_auth_2");const e=O.getResourceFromJid(this.jid);e?this.send(N({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:O.NS.BIND}).c("resource",{}).t(e).tree()):this.send(N({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:O.NS.BIND}).tree())},_onResourceBindResultIQ:function(e){if("error"===e.getAttribute("type")){let t;return O.warn("Resource binding failed."),e.getElementsByTagName("conflict").length>0&&(t=O.ErrorCondition.CONFLICT),this._changeConnectStatus(O.Status.AUTHFAIL,t,e),!1}const t=e.getElementsByTagName("bind");if(!(t.length>0))return O.warn("Resource binding failed."),this._changeConnectStatus(O.Status.AUTHFAIL,null,e),!1;{const e=t[0].getElementsByTagName("jid");e.length>0&&(this.jid=O.getText(e[0]),this.do_session?this._establishSession():(this.authenticated=!0,this._changeConnectStatus(O.Status.CONNECTED,null)))}},_establishSession:function(){if(!this.do_session)throw new Error("Strophe.Connection.prototype._establishSession "+`called but apparently ${O.NS.SESSION} wasn't advertised by the server`);this._addSysHandler(this._onSessionResultIQ.bind(this),null,null,null,"_session_auth_2"),this.send(N({type:"set",id:"_session_auth_2"}).c("session",{xmlns:O.NS.SESSION}).tree())},_onSessionResultIQ:function(e){if("result"===e.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(O.Status.CONNECTED,null);else if("error"===e.getAttribute("type"))return O.warn("Session creation failed."),this._changeConnectStatus(O.Status.AUTHFAIL,null,e),!1;return!1},_sasl_failure_cb:function(e){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(O.Status.AUTHFAIL,null,e),!1},_auth2_cb:function(e){return"result"===e.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(O.Status.CONNECTED,null)):"error"===e.getAttribute("type")&&(this._changeConnectStatus(O.Status.AUTHFAIL,null,e),this.disconnect("authentication failed")),!1},_addSysTimedHandler:function(e,t){const n=new O.TimedHandler(e,t);return n.user=!1,this.addTimeds.push(n),n},_addSysHandler:function(e,t,n,r,i){const s=new O.Handler(e,t,n,r,i);return s.user=!1,this.addHandlers.push(s),s},_onDisconnectTimeout:function(){return O.debug("_onDisconnectTimeout was called"),this._changeConnectStatus(O.Status.CONNTIMEOUT,null),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1},_onIdle:function(){for(;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;){const e=this.removeTimeds.pop(),t=this.timedHandlers.indexOf(e);t>=0&&this.timedHandlers.splice(t,1)}const e=(new Date).getTime(),t=[];for(let n=0;n<this.timedHandlers.length;n++){const r=this.timedHandlers[n];if(this.authenticated||!r.user){r.lastCalled+r.period-e<=0?r.run()&&t.push(r):t.push(r)}}this.timedHandlers=t,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout(()=>this._onIdle(),100))}},O.SASLMechanism=function(e,t,n){this.name=e,this.isClientFirst=t,this.priority=n},O.SASLMechanism.prototype={test:function(e){return!0},onStart:function(e){this._connection=e},onChallenge:function(e,t){throw new Error("You should implement challenge handling!")},onFailure:function(){this._connection=null},onSuccess:function(){this._connection=null}},O.SASLAnonymous=function(){},O.SASLAnonymous.prototype=new O.SASLMechanism("ANONYMOUS",!1,20),O.SASLAnonymous.prototype.test=function(e){return null===e.authcid},O.SASLPlain=function(){},O.SASLPlain.prototype=new O.SASLMechanism("PLAIN",!0,50),O.SASLPlain.prototype.test=function(e){return null!==e.authcid},O.SASLPlain.prototype.onChallenge=function(e){let t=e.authzid;return t+="\0",t+=e.authcid,t+="\0",t+=e.pass,E(t)},O.SASLSHA1=function(){},O.SASLSHA1.prototype=new O.SASLMechanism("SCRAM-SHA-1",!0,70),O.SASLSHA1.prototype.test=function(e){return null!==e.authcid},O.SASLSHA1.prototype.onChallenge=function(e,t,n){const r=n||f.hexdigest(""+1234567890*Math.random());let i="n="+E(e.authcid);return i+=",r=",i+=r,e._sasl_data.cnonce=r,e._sasl_data["client-first-message-bare"]=i,i="n,,"+i,this.onChallenge=(e,t)=>{let n,r,i,s,o,a,c,u,l="c=biws,",d=`${e._sasl_data["client-first-message-bare"]},${t},`;const h=e._sasl_data.cnonce,f=/([a-z]+)=([^,]+)(,|$)/;for(;t.match(f);){const e=t.match(f);switch(t=t.replace(e[0],""),e[1]){case"r":n=e[2];break;case"s":r=e[2];break;case"i":i=e[2]}}if(n.substr(0,h.length)!==h)return e._sasl_data={},e._sasl_failure_cb();d+=l+="r="+n,r=atob(r),r+="\0\0\0";const p=E(e.pass);for(s=a=x.core_hmac_sha1(p,r),c=1;c<i;c++){for(o=x.core_hmac_sha1(p,x.binb2str(a)),u=0;u<5;u++)s[u]^=o[u];a=o}s=x.binb2str(s);const g=x.core_hmac_sha1(s,"Client Key"),m=x.str_hmac_sha1(s,"Server Key"),_=x.core_hmac_sha1(x.str_sha1(x.binb2str(g)),d);for(e._sasl_data["server-signature"]=x.b64_hmac_sha1(m,d),u=0;u<5;u++)g[u]^=_[u];return l+=",p="+btoa(x.binb2str(g))},i},O.SASLMD5=function(){},O.SASLMD5.prototype=new O.SASLMechanism("DIGEST-MD5",!1,60),O.SASLMD5.prototype.test=function(e){return null!==e.authcid},O.SASLMD5.prototype._quote=function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},O.SASLMD5.prototype.onChallenge=function(e,t,n){const r=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,i=n||f.hexdigest(""+1234567890*Math.random());let s="",o=null,a="",c="";for(;t.match(r);){const e=t.match(r);switch(t=t.replace(e[0],""),e[2]=e[2].replace(/^"(.+)"$/,"$1"),e[1]){case"realm":s=e[2];break;case"nonce":a=e[2];break;case"qop":c=e[2];break;case"host":o=e[2]}}let u=e.servtype+"/"+e.domain;null!==o&&(u=u+"/"+o);const l=E(e.authcid+":"+s+":"+this._connection.pass),d=f.hash(l)+":"+a+":"+i,h="AUTHENTICATE:"+u;let p="";return p+="charset=utf-8,",p+="username="+this._quote(E(e.authcid))+",",p+="realm="+this._quote(s)+",",p+="nonce="+this._quote(a)+",",p+="nc=00000001,",p+="cnonce="+this._quote(i)+",",p+="digest-uri="+this._quote(u)+",",p+="response="+f.hexdigest(f.hexdigest(d)+":"+a+":00000001:"+i+":auth:"+f.hexdigest(h))+",",p+="qop=auth",this.onChallenge=()=>"",p},O.SASLOAuthBearer=function(){},O.SASLOAuthBearer.prototype=new O.SASLMechanism("OAUTHBEARER",!0,40),O.SASLOAuthBearer.prototype.test=function(e){return null!==e.pass},O.SASLOAuthBearer.prototype.onChallenge=function(e){let t="n,";return null!==e.authcid&&(t=t+"a="+e.authzid),t+=",",t+="",t+="auth=Bearer ",t+=e.pass,t+="",E(t+="")},O.SASLExternal=function(){},O.SASLExternal.prototype=new O.SASLMechanism("EXTERNAL",!0,10),O.SASLExternal.prototype.onChallenge=function(e){return e.authcid===e.authzid?"":e.authzid},O.SASLXOAuth2=function(){},O.SASLXOAuth2.prototype=new O.SASLMechanism("X-OAUTH2",!0,30),O.SASLXOAuth2.prototype.test=function(e){return null!==e.pass},O.SASLXOAuth2.prototype.onChallenge=function(e){let t="\0";return null!==e.authcid&&(t+=e.authzid),t+="\0",t+=e.pass,E(t)};var T={Strophe:O,$build:j,$iq:N,$msg:function(e){return new O.Builder("message",e)},$pres:C,SHA1:x,MD5:f,b64_hmac_sha1:x.b64_hmac_sha1,b64_sha1:x.b64_sha1,str_hmac_sha1:x.str_hmac_sha1,str_sha1:x.str_sha1};const R=T.Strophe,M=T.$build;R.Websocket=function(e){this._conn=e,this.strip="wrapper";const t=e.service;if(0!==t.indexOf("ws:")&&0!==t.indexOf("wss:")){let n="";"ws"===e.options.protocol&&"https:"!==window.location.protocol?n+="ws":n+="wss",n+="://"+window.location.host,0!==t.indexOf("/")?n+=window.location.pathname+t:n+=t,e.service=n}},R.Websocket.prototype={_buildStream:function(){return M("open",{xmlns:R.NS.FRAMING,to:this._conn.domain,version:"1.0"})},_check_streamerror:function(e,t){let n;if(0===(n=e.getElementsByTagNameNS?e.getElementsByTagNameNS(R.NS.STREAM,"error"):e.getElementsByTagName("stream:error")).length)return!1;const r=n[0];let i="",s="";for(let e=0;e<r.childNodes.length;e++){const t=r.childNodes[e];if("urn:ietf:params:xml:ns:xmpp-streams"!==t.getAttribute("xmlns"))break;"text"===t.nodeName?s=t.textContent:i=t.nodeName}let o="WebSocket stream error: ";return o+=i||"unknown",s&&(o+=" - "+s),R.error(o),this._conn._changeConnectStatus(t,i),this._conn._doDisconnect(),!0},_reset:function(){},_connect:function(){this._closeSocket(),this.socket=new WebSocket(this._conn.service,"xmpp"),this.socket.onopen=this._onOpen.bind(this),this.socket.onerror=this._onError.bind(this),this.socket.onclose=this._onClose.bind(this),this.socket.onmessage=this._connect_cb_wrapper.bind(this)},_connect_cb:function(e){if(this._check_streamerror(e,R.Status.CONNFAIL))return R.Status.CONNFAIL},_handleStreamStart:function(e){let t=!1;const n=e.getAttribute("xmlns");"string"!=typeof n?t="Missing xmlns in <open />":n!==R.NS.FRAMING&&(t="Wrong xmlns in <open />: "+n);const r=e.getAttribute("version");return"string"!=typeof r?t="Missing version in <open />":"1.0"!==r&&(t="Wrong version in <open />: "+r),!t||(this._conn._changeConnectStatus(R.Status.CONNFAIL,t),this._conn._doDisconnect(),!1)},_connect_cb_wrapper:function(e){if(0===e.data.indexOf("<open ")||0===e.data.indexOf("<?xml")){const t=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(""===t)return;const n=(new DOMParser).parseFromString(t,"text/xml").documentElement;this._conn.xmlInput(n),this._conn.rawInput(e.data),this._handleStreamStart(n)&&this._connect_cb(n)}else if(0===e.data.indexOf("<close ")){const t=(new DOMParser).parseFromString(e.data,"text/xml").documentElement;this._conn.xmlInput(t),this._conn.rawInput(e.data);const n=t.getAttribute("see-other-uri");if(n){const e=this._conn.service;(e.indexOf("wss:")>=0&&n.indexOf("wss:")>=0||e.indexOf("ws:")>=0)&&(this._conn._changeConnectStatus(R.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=n,this._connect())}else this._conn._changeConnectStatus(R.Status.CONNFAIL,"Received closing stream"),this._conn._doDisconnect()}else{const t=this._streamWrap(e.data),n=(new DOMParser).parseFromString(t,"text/xml").documentElement;this.socket.onmessage=this._onMessage.bind(this),this._conn._connect_cb(n,null,e.data)}},_disconnect:function(e){if(this.socket&&this.socket.readyState!==WebSocket.CLOSED){e&&this._conn.send(e);const t=M("close",{xmlns:R.NS.FRAMING});this._conn.xmlOutput(t.tree());const n=R.serialize(t);this._conn.rawOutput(n);try{this.socket.send(n)}catch(e){R.warn("Couldn't send <close /> tag.")}}this._conn._doDisconnect()},_doDisconnect:function(){R.debug("WebSockets _doDisconnect was called"),this._closeSocket()},_streamWrap:function(e){return"<wrapper>"+e+"</wrapper>"},_closeSocket:function(){if(this.socket)try{this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null,this.socket.close()}catch(e){R.debug(e.message)}this.socket=null},_emptyQueue:function(){return!0},_onClose:function(e){this._conn.connected&&!this._conn.disconnecting?(R.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):e&&1006===e.code&&!this._conn.connected&&this.socket?(R.error("Websocket closed unexcectedly"),this._conn._changeConnectStatus(R.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._conn._doDisconnect()):R.debug("Websocket closed")},_no_auth_received:function(e){R.error("Server did not offer a supported authentication mechanism"),this._conn._changeConnectStatus(R.Status.CONNFAIL,R.ErrorCondition.NO_AUTH_MECH),e&&e.call(this._conn),this._conn._doDisconnect()},_onDisconnectTimeout:function(){},_abortAllRequests:function(){},_onError:function(e){R.error("Websocket error "+e),this._conn._changeConnectStatus(R.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._disconnect()},_onIdle:function(){const e=this._conn._data;if(e.length>0&&!this._conn.paused){for(let t=0;t<e.length;t++)if(null!==e[t]){let n;n="restart"===e[t]?this._buildStream().tree():e[t];const r=R.serialize(n);this._conn.xmlOutput(n),this._conn.rawOutput(r),this.socket.send(r)}this._conn._data=[]}},_onMessage:function(e){let t;const n='<close xmlns="urn:ietf:params:xml:ns:xmpp-framing" />';if(e.data===n)return this._conn.rawInput(n),this._conn.xmlInput(e),void(this._conn.disconnecting||this._conn._doDisconnect());if(0===e.data.search("<open ")){if(t=(new DOMParser).parseFromString(e.data,"text/xml").documentElement,!this._handleStreamStart(t))return}else{const n=this._streamWrap(e.data);t=(new DOMParser).parseFromString(n,"text/xml").documentElement}return this._check_streamerror(t,R.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===t.firstChild.nodeName&&"unavailable"===t.firstChild.getAttribute("type")?(this._conn.xmlInput(t),void this._conn.rawInput(R.serialize(t))):void this._conn._dataRecv(t,e.data)},_onOpen:function(){R.debug("Websocket open");const e=this._buildStream();this._conn.xmlOutput(e.tree());const t=R.serialize(e);this._conn.rawOutput(t),this.socket.send(t)},_reqToData:function(e){return e},_send:function(){this._conn.flush()},_sendRestart:function(){clearTimeout(this._conn._idleTimeout),this._conn._onIdle.bind(this._conn)()}};var I=n(8),k=n.n(I),L=n(0),D=n.n(L),F=n(93),P=n.n(F),U=n(11),z=n.n(U),B=n(32),H=n.n(B);function q(e,t){return"string"==typeof e&&t.includes(e)}function $(e,t){return"string"!=typeof e||"en"!==e&&!t(e)?function(e){var t,n;if(window.navigator.userLanguage&&(t=G(window.navigator.userLanguage,e)),window.navigator.languages&&!t)for(n=0;n<window.navigator.languages.length&&!t;n++)t=G(window.navigator.languages[n],e);return window.navigator.browserLanguage&&!t&&(t=G(window.navigator.browserLanguage,e)),window.navigator.language&&!t&&(t=G(window.navigator.language,e)),window.navigator.systemLanguage&&!t&&(t=G(window.navigator.systemLanguage,e)),t||"en"}(t)||"en":e}function G(e,t){if(t(e))return e;var n=e.split("-")[0];return n!==e&&t(n)?n:void 0}let W;var J={getLocale:(e,t)=>$(e,e=>q(e,t)),translate(e){if(!W)return H.a.sprintf.apply(H.a,arguments);const t=W.translate(e);return arguments.length>1?t.fetch.apply(t,[].slice.call(arguments,1)):t.fetch()},async fetchTranslations(e){const t=e.locale;if(!q(t,e.locales)||"en"===t)return;const{default:r}=await n(232)("./".concat(t,"/LC_MESSAGES/converse.po"));await n(233)("./".concat(t.toLowerCase().replace("_","-"))),z.a.locale($(e.locale,e=>z.a.locale(e))),W=new H.a(r)}},Y=n(94),X=n.n(Y),V=n(18),Q=n.n(V),Z=n(19),K=n.n(Z),ee=n(14),te=n.n(ee),ne=n(95),re=n.n(ne),ie=n(31),se=n.n(ie),oe=n(96),ae=n.n(oe),ce=n(13),ue=n.n(ce),le=n(47),de=n.n(le),he=n(97),fe=n.n(he),pe=n(98),ge=n.n(pe),me=n(46),_e=n.n(me);function ve(e,t){this.name=t,this.plugged=e,void 0===this.plugged.__super__?this.plugged.__super__={}:"string"==typeof this.plugged.__super__&&(this.plugged.__super__={__string__:this.plugged.__super__}),this.plugged.__super__[t]=this.plugged,this.plugins={},this.initialized_plugins=[]}K()(ve.prototype,{wrappedOverride:function(e,t,n,r){return"function"==typeof n&&(void 0===this.__super__&&(this.__super__=r),this.__super__[e]=n.bind(this)),t.apply(this,X()(arguments,4))},_overrideAttribute:function(e,t){let n=t.overrides[e];if("function"==typeof n){let t={};t[this.name]=this.plugged;let r=de()(this.wrappedOverride,e,n,this.plugged[e],t);this.plugged[e]=r}else this.plugged[e]=n},_extendObject:function(e,t){e.prototype.__super__||(e.prototype.__super__={},e.prototype.__super__[this.name]=this.plugged);let n=this;Q()(t,function(t,r){if("events"===r)e.prototype[r]=K()(t,e.prototype[r]);else if("function"==typeof t){let i={};i[n.name]=n.plugged;let s=de()(n.wrappedOverride,r,t,e.prototype[r],i);e.prototype[r]=s}else e.prototype[r]=t})},loadPluginDependencies:function(e){Q()(e.dependencies,t=>{let n=this.plugins[t];if(n){if(te()(n.dependencies,e.__name__))throw'Found a circular dependency between the plugins "'+e.__name__+'" and "'+t+'"';this.initializePlugin(n)}else this.throwUndefinedDependencyError('Could not find dependency "'+t+'" for the plugin "'+e.__name__+"\". If it's needed, make sure it's loaded by require.js")})},throwUndefinedDependencyError:function(e){if(this.plugged.strict_plugin_dependencies)throw e;console.warn?console.warn(e):console.log(e)},applyOverrides:function(e){Q()(Object.keys(e.overrides||{}),t=>{let n=e.overrides[t];"object"==typeof n?void 0===this.plugged[t]?this.throwUndefinedDependencyError(`Plugin "${e.__name__}" tried to override "${t}" but it's not found.`):this._extendObject(this.plugged[t],n):this._overrideAttribute(t,e)})},initializePlugin:function(e){te()(ue()(this.allowed_plugins),e.__name__)&&(te()(this.initialized_plugins,e.__name__)||(re()(e.enabled)&&e.enabled||se()(e.enabled)&&e.enabled(this.plugged)||ae()(e.enabled))&&(K()(e,this.properties),e.dependencies&&this.loadPluginDependencies(e),this.applyOverrides(e),"function"==typeof e.initialize&&e.initialize.bind(e)(this),this.initialized_plugins.push(e.__name__)))},registerPlugin:function(e,t){if(e in this.plugins)throw new Error("Error: Plugin name "+e+" is already taken");t.__name__=e,this.plugins[e]=t},initializePlugins:function(e={},t=[],n=[]){ge()(this.plugins)&&(this.properties=e,this.allowed_plugins=fe()(this.plugins,function(e,r){return(!t.length||t.length&&te()(t,r))&&!te()(n,r)}),Q()(_e()(this.allowed_plugins),this.initializePlugin.bind(this)))}});var be={enable:function(e,t,n){void 0===n&&(n="pluginSocket"),void 0===t&&(t="plugged");let r={};return r[n]=new ve(e,t),K()(e,r)}},ye=(n(349),n(3)),Se=n.n(ye);const we=T.Strophe,xe={};xe.logger=Object.assign({debug:D.a.get(console,"log")?console.log.bind(console):function(){},error:D.a.get(console,"log")?console.log.bind(console):function(){},info:D.a.get(console,"log")?console.log.bind(console):function(){},warn:D.a.get(console,"log")?console.log.bind(console):function(){}},console),xe.isTagEqual=function(e,t){if(e.nodeTree)return xe.isTagEqual(e.nodeTree,t);if(e instanceof Element)return we.isTagEqual(e,t);throw Error("isTagEqual called with value which isn't an element or Strophe.Builder instance")};const Ee=new DOMParser,Ae=Ee.parseFromString("invalid","text/xml").getElementsByTagName("parsererror")[0].namespaceURI;
/**
 * Clears the specified timeout and interval.
 * @method u#clearTimers
 * @param {number} timeout - Id if the timeout to clear.
 * @param {number} interval - Id of the interval to clear.
 * @private
 * @copyright Simen Bekkhus 2016
 * @license MIT
 */
function je(e,t){clearTimeout(e),clearInterval(t)}
/**
 * Creates a {@link Promise} that resolves if the passed in function returns a truthy value.
 * Rejects if it throws or does not return truthy within the given max_wait.
 * @method u#waitUntil
 * @param {Function} func - The function called every check_delay,
 *  and the result of which is the resolved value of the promise.
 * @param {number} [max_wait=300] - The time to wait before rejecting the promise.
 * @param {number} [check_delay=3] - The time to wait before each invocation of {func}.
 * @returns {Promise} A promise resolved with the value of func,
 *  or rejected with the exception thrown by it or it times out.
 * @copyright Simen Bekkhus 2016
 * @license MIT
 */xe.toStanza=function(e){const t=Ee.parseFromString(e,"text/xml");if(t.getElementsByTagNameNS(Ae,"parsererror").length)throw new Error("Parser Error: ".concat(e));return t.firstElementChild},xe.isMAMMessage=function(e){return Se()('message > result[xmlns="'.concat(we.NS.MAM,'"]'),e).length>0},xe.isCarbonMessage=function(e){const t=we.NS.CARBONS;return Se()('message > received[xmlns="'.concat(t,'"]'),e).length>0||Se()('message > sent[xmlns="'.concat(t,'"]'),e).length>0},xe.getLongestSubstring=function(e,t){return t.reduce(function(t,n){return e.startsWith(n)&&n.length>t.length?n:t},"")},xe.prefixMentions=function(e){let t=e.get("message");return(e.get("references")||[]).sort((e,t)=>t.begin-e.begin).forEach(e=>{t="".concat(t.slice(0,e.begin),"@").concat(t.slice(e.begin))}),t},xe.isValidJID=function(e){return!!D.a.isString(e)&&(2===D.a.compact(e.split("@")).length&&!e.startsWith("@")&&!e.endsWith("@"))},xe.isValidMUCJID=function(e){return!e.startsWith("@")&&!e.endsWith("@")},xe.isSameBareJID=function(e,t){return!(!D.a.isString(e)||!D.a.isString(t))&&we.getBareJidFromJid(e).toLowerCase()===we.getBareJidFromJid(t).toLowerCase()},xe.isNewMessage=function(e){return e instanceof Element?!(Se()('result[xmlns="'.concat(we.NS.MAM,'"]'),e).length&&Se()('delay[xmlns="'.concat(we.NS.DELAY,'"]'),e).length):(e instanceof k.a.Model&&(e=e.attributes),!(e.is_delayed&&e.is_archived))},xe.isEmptyMessage=function(e){return e instanceof k.a.Model&&(e=e.attributes),!(e.oob_url||e.file||e.is_encrypted&&e.plaintext||e.message)},xe.isOnlyChatStateNotification=function(e){return e instanceof Element?null===e.querySelector("body")&&(null!==e.querySelector("active")||null!==e.querySelector("composing")||null!==e.querySelector("inactive")||null!==e.querySelector("paused")||null!==e.querySelector("gone")):(e instanceof k.a.Model&&(e=e.attributes),e.chat_state&&xe.isEmptyMessage(e))},xe.isOnlyMessageDeliveryReceipt=function(e){return e instanceof Element?null===e.querySelector("body")&&null!==e.querySelector("received"):(e instanceof k.a.Model&&(e=e.attributes),e.received&&xe.isEmptyMessage(e))},xe.isHeadlineMessage=function(e,t){const n=t.getAttribute("from");if("headline"===t.getAttribute("type"))return!0;const r=e.chatboxes.get(we.getBareJidFromJid(n));return(!r||r.get("type")!==e.CHATROOMS_TYPE)&&!("error"===t.getAttribute("type")||!n||D.a.includes(n,"@"))},xe.isErrorObject=function(e){return e instanceof Error},xe.isErrorStanza=function(e){return!!D.a.isElement(e)&&"error"===e.getAttribute("type")},xe.isForbiddenError=function(e){return!!D.a.isElement(e)&&Se()('error[type="auth"] forbidden[xmlns="'.concat(we.NS.STANZAS,'"]'),e).length>0},xe.isServiceUnavailableError=function(e){return!!D.a.isElement(e)&&Se()('error[type="cancel"] service-unavailable[xmlns="'.concat(we.NS.STANZAS,'"]'),e).length>0},xe.merge=function e(t,n){for(var r in n)D.a.isObject(t[r])?e(t[r],n[r]):t[r]=n[r]},xe.applyUserSettings=function e(t,n,r){for(var i in n)void 0!==r[i]&&(D.a.isObject(n[i])&&!Array.isArray(n[i])?e(t[i],n[i],r[i]):t[i]=r[i])},xe.stringToNode=function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild},xe.getOuterWidth=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.offsetWidth;if(!t)return n;const r=window.getComputedStyle(e);return n+=parseInt(r.marginLeft?r.marginLeft:0,10)+parseInt(r.marginRight?r.marginRight:0,10)},xe.stringToElement=function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild},xe.matchesSelector=function(e,t){const n=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector;return!!n&&n.call(e,t)},xe.queryChildren=function(e,t){return Array.from(e.childNodes).filter(e=>xe.matchesSelector(e,t))},xe.contains=function(e,t){return function(n){if("object"==typeof e){var r=!1;return D.a.forEach(e,function(e){r=r||D.a.includes(n.get(e).toLowerCase(),t.toLowerCase())}),r}if("string"==typeof e)return D.a.includes(n.get(e).toLowerCase(),t.toLowerCase());throw new TypeError("contains: wrong attribute type. Must be string or array.")}},xe.isOfType=function(e,t){return t.get("type")==e},xe.isInstance=function(e,t){return t instanceof e},xe.getAttribute=function(e,t){return t.get(e)},xe.contains.not=function(e,t){return function(n){return!xe.contains(e,t)(n)}},xe.rootContains=function(e,t){return e!==document||e.contains?e.contains?e.contains(t):window.HTMLElement.prototype.contains.call(e,t):document.head.contains(t)||document.body.contains(t)},xe.createFragmentFromText=function(e){var t,n=document.createDocumentFragment(),r=document.createElement("body");for(r.innerHTML=e;t=r.firstChild;)n.appendChild(t);return n},xe.isPersistableModel=function(e){return e.collection&&e.collection.browserStorage},xe.getResolveablePromise=function(){const e={isResolved:!1,isPending:!0,isRejected:!1},t=new Promise((t,n)=>{e.resolve=t,e.reject=n});return D.a.assign(t,e),t.then(function(e){return t.isResolved=!0,t.isPending=!1,t.isRejected=!1,e},function(e){throw t.isResolved=!1,t.isPending=!1,t.isRejected=!0,e}),t},xe.interpolate=function(e,t){return e.replace(/{{{([^{}]*)}}}/g,(e,n)=>{var r=t[n];return"string"==typeof r||"number"==typeof r?r:e})},xe.onMultipleEvents=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=[];function r(r){n.push(r),e.length===n.length&&(t(n),n=[])}e.forEach(e=>e.object.on(e.event,r))},xe.safeSave=function(e,t){xe.isPersistableModel(e)?e.save(t):e.set(t)},xe.siblingIndex=function(e){for(var t=0;e=e.previousElementSibling;t++);return t},xe.getCurrentWord=function(e,t,n){t||(t=e.selectionEnd||void 0);let[r]=e.value.slice(0,t).split(" ").slice(-1);return n&&([r]=r.split(n).slice(-1)),r},xe.replaceCurrentWord=function(e,t){const n=e.selectionEnd||void 0,r=D.a.last(e.value.slice(0,n).split(" ")),i=e.value;e.value=i.slice(0,n-r.length)+"".concat(t," ")+i.slice(n),e.selectionEnd=n-r.length+t.length+1},xe.triggerEvent=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Event",r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const s=document.createEvent(n);s.initEvent(t,r,i),e.dispatchEvent(s)},xe.geoUriToHttp=function(e,t){return e.replace(/geo:([\-0-9.]+),([\-0-9.]+)(?:,([\-0-9.]+))?(?:\?(.*))?/g,t)},xe.httpToGeoUri=function(e,t){return e.replace(t.geouri_regex,"geo:$1,$2")},xe.getSelectValues=function(e){const t=[],n=e&&e.options;for(var r=0,i=n.length;r<i;r++){const e=n[r];e.selected&&t.push(e.value||e.text)}return t},xe.formatFingerprint=function(e){e=e.replace(/^05/,"");for(let t=1;t<8;t++){const n=8*t+t-1;e=e.slice(0,n)+" "+e.slice(n)}return e},xe.appendArrayBuffer=function(e,t){const n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},xe.arrayBufferToHex=function(e){return Array.prototype.map.call(new Uint8Array(e),e=>("00"+e.toString(16)).slice(-2)).join("")},xe.arrayBufferToString=function(e){return new TextDecoder("utf-8").decode(e)},xe.stringToArrayBuffer=function(e){return new TextEncoder("utf-8").encode(e).buffer},xe.arrayBufferToBase64=function(e){return btoa(new Uint8Array(e).reduce((e,t)=>e+String.fromCharCode(t),""))},xe.base64ToArrayBuffer=function(e){const t=window.atob(e),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return r.buffer},xe.getRandomInt=function(e){return Math.floor(Math.random()*Math.floor(e))},xe.placeCaretAtEnd=function(e){e!==document.activeElement&&e.focus();const t=2*e.value.length;setTimeout(()=>e.setSelectionRange(t,t),1),this.scrollTop=999999},xe.getUniqueId=function(){return"xxxxxxxx-xxxx".replace(/[x]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},xe.waitUntil=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;try{const t=e();if(t)return Promise.resolve(t)}catch(e){return Promise.reject(e)}const r=xe.getResolveablePromise();function i(){try{const t=e();t&&(je(o,s),r.resolve(t))}catch(e){je(o,s),r.reject(e)}}const s=setInterval(i,n),o=setTimeout(()=>{je(o,s);const e="Wait until promise timed out";xe.logger.error(e),r.reject(new Error(e))},t);return r};var Ne=xe;const Ce=T.Strophe,Oe=T.$build,Te=T.$iq,Re=T.$msg,Me=T.$pres;Backbone=k.a.noConflict(),z.a.extend(P.a),Ce.addNamespace("CARBONS","urn:xmpp:carbons:2"),Ce.addNamespace("CHATSTATES","http://jabber.org/protocol/chatstates"),Ce.addNamespace("CSI","urn:xmpp:csi:0"),Ce.addNamespace("DELAY","urn:xmpp:delay"),Ce.addNamespace("FORWARD","urn:xmpp:forward:0"),Ce.addNamespace("HINTS","urn:xmpp:hints"),Ce.addNamespace("HTTPUPLOAD","urn:xmpp:http:upload:0"),Ce.addNamespace("IDLE","urn:xmpp:idle:1"),Ce.addNamespace("MAM","urn:xmpp:mam:2"),Ce.addNamespace("NICK","http://jabber.org/protocol/nick"),Ce.addNamespace("OMEMO","eu.siacs.conversations.axolotl"),Ce.addNamespace("OUTOFBAND","jabber:x:oob"),Ce.addNamespace("PUBSUB","http://jabber.org/protocol/pubsub"),Ce.addNamespace("REGISTER","jabber:iq:register"),Ce.addNamespace("ROSTERX","http://jabber.org/protocol/rosterx"),Ce.addNamespace("RSM","http://jabber.org/protocol/rsm"),Ce.addNamespace("SID","urn:xmpp:sid:0"),Ce.addNamespace("SPOILER","urn:xmpp:spoiler:0"),Ce.addNamespace("STANZAS","urn:ietf:params:xml:ns:xmpp-stanzas"),Ce.addNamespace("VCARD","vcard-temp"),Ce.addNamespace("VCARDUPDATE","vcard-temp:x:update"),Ce.addNamespace("XFORM","jabber:x:data"),D.a.templateSettings={escape:/\{\{\{([\s\S]+?)\}\}\}/g,evaluate:/\{\[([\s\S]+?)\]\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g,imports:{_:D.a}};const Ie=59,ke=["converse-bookmarks","converse-bosh","converse-caps","converse-chatboxes","converse-disco","converse-emoji","converse-mam","converse-muc","converse-ping","converse-pubsub","converse-roster","converse-rsm","converse-smacks","converse-vcard"],Le={templates:{},promises:{},VERSION_NAME:"v5.0.4"};Object.assign(Le,Backbone.Events),Le.Collection=Backbone.Collection.extend({clearSession(e){Array.from(this.models).forEach(t=>t.destroy(e)),this.browserStorage._clear(),this.reset()}});Le.TimeoutError=class extends Error{},be.enable(Le,"_converse","pluggable"),Le.keycodes={TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,UP_ARROW:38,DOWN_ARROW:40,FORWARD_SLASH:47,AT:50,META:91,META_RIGHT:93},Le.STATUS_WEIGHTS={offline:6,unavailable:5,xa:4,away:3,dnd:2,chat:1,online:1},Le.PRETTY_CHAT_STATUS={offline:"Offline",unavailable:"Unavailable",xa:"Extended Away",away:"Away",dnd:"Do not disturb",chat:"Chattty",online:"Online"},Le.ANONYMOUS="anonymous",Le.CLOSED="closed",Le.EXTERNAL="external",Le.LOGIN="login",Le.LOGOUT="logout",Le.OPENED="opened",Le.PREBIND="prebind",Le.IQ_TIMEOUT=2e4,Le.CONNECTION_STATUS={0:"ERROR",1:"CONNECTING",2:"CONNFAIL",3:"AUTHENTICATING",4:"AUTHFAIL",5:"CONNECTED",6:"DISCONNECTED",7:"DISCONNECTING",8:"ATTACHED",9:"REDIRECT",10:"RECONNECTING"},Le.SUCCESS="success",Le.FAILURE="failure",Le.DEFAULT_IMAGE_TYPE="image/svg+xml",Le.DEFAULT_IMAGE="PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCI+CiA8cmVjdCB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgZmlsbD0iIzU1NSIvPgogPGNpcmNsZSBjeD0iNjQiIGN5PSI0MSIgcj0iMjQiIGZpbGw9IiNmZmYiLz4KIDxwYXRoIGQ9Im0yOC41IDExMiB2LTEyIGMwLTEyIDEwLTI0IDI0LTI0IGgyMyBjMTQgMCAyNCAxMiAyNCAyNCB2MTIiIGZpbGw9IiNmZmYiLz4KPC9zdmc+Cg==",Le.TIMEOUTS={PAUSED:1e4,INACTIVE:9e4},Le.INACTIVE="inactive",Le.ACTIVE="active",Le.COMPOSING="composing",Le.PAUSED="paused",Le.GONE="gone",Le.PRIVATE_CHAT_TYPE="chatbox",Le.CHATROOMS_TYPE="chatroom",Le.HEADLINES_TYPE="headline",Le.CONTROLBOX_TYPE="controlbox",Le.default_connection_options={explicitResourceBinding:!0},Le.default_settings={allow_non_roster_messaging:!1,authentication:"login",auto_away:0,auto_login:!1,auto_reconnect:!0,auto_xa:0,blacklisted_plugins:[],connection_options:{},credentials_url:null,csi_waiting_time:0,debug:!1,default_state:"online",geouri_regex:/https\:\/\/www.openstreetmap.org\/.*#map=[0-9]+\/([\-0-9.]+)\/([\-0-9.]+)\S*/g,geouri_replacement:"https://www.openstreetmap.org/?mlat=$1&mlon=$2#map=18/$1/$2",idle_presence_timeout:300,jid:void 0,keepalive:!0,locales:["af","ar","bg","ca","cs","de","eo","es","eu","en","fr","gl","he","hi","hu","id","it","ja","nb","nl","oc","pl","pt","pt_BR","ro","ru","tr","uk","vi","zh_CN","zh_TW"],message_carbons:!0,nickname:void 0,password:void 0,priority:0,rid:void 0,root:window.document,sid:void 0,singleton:!1,strict_plugin_dependencies:!1,trusted:!0,view_mode:"overlayed",websocket_url:void 0,whitelisted_plugins:[]},Le.log=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";t!==Ce.LogLevel.ERROR&&t!==Ce.LogLevel.FATAL||(n=n||"color: maroon"),e instanceof Error?e=e.stack:D.a.isElement(e)&&(e=e.outerHTML);const r=n?"%c":"";t===Ce.LogLevel.ERROR?Ne.logger.error("".concat(r," ERROR: ").concat(e),n):t===Ce.LogLevel.WARN?Ne.logger.warn("".concat(r," ").concat((new Date).toISOString()," WARNING: ").concat(e),n):t===Ce.LogLevel.FATAL?Ne.logger.error("".concat(r," FATAL: ").concat(e),n):Le.debug&&(t===Ce.LogLevel.DEBUG?Ne.logger.debug("".concat(r," ").concat((new Date).toISOString()," DEBUG: ").concat(e),n):Ne.logger.info("".concat(r," ").concat((new Date).toISOString()," INFO: ").concat(e),n))},Ce.log=function(e,t){Le.log(e+" "+t,e)},Ce.error=function(e){Le.log(e,Ce.LogLevel.ERROR)},Le.__=function(e){return void 0===J?e:J.translate.apply(J,arguments)};const De=Le.__,Fe=["afterResourceBinding","connectionInitialized","initialized","pluginsInitialized","statusInitialized"];function Pe(e){Le.promises[e]=Ne.getResolveablePromise()}function Ue(){return Le.api.trigger("beforeTearDown"),window.removeEventListener("click",Le.onUserActivity),window.removeEventListener("focus",Le.onUserActivity),window.removeEventListener("keypress",Le.onUserActivity),window.removeEventListener("mousemove",Le.onUserActivity),window.removeEventListener(Le.unloadevent,Le.onUserActivity),window.clearInterval(Le.everySecondTrigger),Le.api.trigger("afterTearDown"),Le}async function ze(e,t){if(Le.authentication===Le.LOGIN)if(e)Be(e);else if(Le.credentials_url)Be(await async function(){let e,t=0;for(;!e;){try{e=await Ve(t)}catch(e){Le.log("Could not fetch login credentials",Ce.LogLevel.ERROR),Le.log(e,Ce.LogLevel.ERROR)}t=2e3}return e}());else if(Le.jid&&(Le.password||Le.connection.pass))Be();else{if(Le.isTestEnv()||!window.PasswordCredential)throw new Error("attemptNonPreboundSession: Could not find any credentials to log you in with!");Be(await async function(){const e=await navigator.credentials.get({password:!0});if(e&&"password"==e.type&&Ne.isValidJID(e.id))return await Ge(e.id),{jid:e.id,password:e.password}}())}else![Le.ANONYMOUS,Le.EXTERNAL].includes(Le.authentication)||t&&!Le.auto_login||Be()}function Be(e){if([Le.ANONYMOUS,Le.EXTERNAL].includes(Le.authentication)){if(!Le.jid)throw new Error("Config Error: when using anonymous login you need to provide the server's domain via the 'jid' option. Either when calling converse.initialize, or when calling _converse.api.user.login.");Le.connection.reconnecting||Le.connection.reset(),Le.connection.connect(Le.jid.toLowerCase(),null,Le.onConnectStatusChanged,Ie)}else if(Le.authentication===Le.LOGIN){const t=e?e.password:Le.connection.pass||Le.password;if(!t){if(Le.auto_login)throw new Error("autoLogin: If you use auto_login and authentication='login' then you also need to provide a password.");return Le.setDisconnectionCause(Ce.Status.AUTHFAIL,void 0,!0),void Le.api.connection.disconnect()}Le.connection.reconnecting||Le.connection.reset(),Le.connection.connect(Le.jid,t,Le.onConnectStatusChanged,Ie)}}function He(){return Le.log("RECONNECTING: the connection has dropped, attempting to reconnect."),Le.setConnectionStatus(Ce.Status.RECONNECTING,De("The connection has dropped, attempting to reconnect.")),Le.api.trigger("will-reconnect"),Le.connection.reconnecting=!0,Ue(),Le.api.user.login()}Le.isTestEnv=function(){return"jasmine tests"===D.a.get(Le.connection,"service")},Le.haveResumed=function(){return Le.api.connection.isType("bosh")?Le.connfeedback.get("connection_status")===Ce.Status.ATTACHED:!Le.connection.do_bind},Le.isUniView=function(){return D.a.includes(["mobile","fullscreen","embedded"],Le.view_mode)},Le.router=new Backbone.Router;const qe=D.a.debounce(He,2e3);function $e(){void 0!==Le.session&&(Le.session.destroy(),Le.session.browserStorage._clear(),delete Le.session),Le.shouldClearCache()&&Le.xmppstatus&&(Le.xmppstatus.destroy(),Le.xmppstatus.browserStorage._clear(),delete Le.xmppstatus),Le.api.trigger("clearSession")}async function Ge(e){const t=Ce.getBareJidFromJid(e).toLowerCase(),n="converse.session-".concat(t);return Le.session&&Le.session.get("id")===n?We(e):(Le.session=new Backbone.Model({id:n}),Le.session.browserStorage=new i.a.session(n),await new Promise(e=>Le.session.fetch({success:e,error:e})),Le.session.get("active")&&(Le.session.clear(),Le.session.save({id:n})),We(e),Le.api.trigger("userSessionInitialized")),Le.api.trigger("setUserJID"),e}function We(e){e=Le.session.get("jid")||e,Le.authentication===Le.ANONYMOUS||Ce.getResourceFromJid(e)||(e=e.toLowerCase()+Le.generateResource()),Le.connection.jid=e,Le.jid=e,Le.bare_jid=Ce.getBareJidFromJid(e),Le.resource=Ce.getResourceFromJid(e),Le.domain=Ce.getDomainFromJid(e),Le.session.save({jid:e,bare_jid:Le.bare_jid,resource:Le.resource,domain:Le.domain,active:!0})}async function Je(e){delete Le.connection.reconnecting,Le.connection.flush(),await Ge(Le.connection.jid),await Le.api.trigger("afterResourceBinding",{synchronous:!0}),Le.enableCarbons(),Le.initStatus(e)}async function Ye(){!function(){const e="converse.client-config";Le.config=new Backbone.Model({id:e,trusted:!!Le.trusted,storage:Le.trusted?"local":"session"}),Le.config.browserStorage=new i.a.session(e),Le.config.fetch(),Le.api.trigger("clientConfigInitialized")}(),function(){Le.pluggable.initialized_plugins=[];const e=ke.concat(Le.whitelisted_plugins);Le.singleton&&["converse-bookmarks","converse-controlbox","converse-headline","converse-register"].forEach(e=>Le.blacklisted_plugins.push(e)),Le.pluggable.initializePlugins({_converse:Le},e,Le.blacklisted_plugins),Le.api.trigger("pluginsInitialized")}(),await Le.initConnection(),Le.registerGlobalEventHandlers(),Backbone.history.started||Backbone.history.start(),Le.idle_presence_timeout>0&&Le.api.listen.on("addClientFeatures",()=>{Le.api.disco.own.features.add(Ce.NS.IDLE)})}function Xe(){Le.log("DISCONNECTED"),delete Le.connection.reconnecting,Le.connection.reset(),Ue(),$e(),Le.api.trigger("disconnected")}function Ve(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(D.a.debounce((e,t)=>{const n=new XMLHttpRequest;n.open("GET",Le.credentials_url,!0),n.setRequestHeader("Accept","application/json, text/javascript"),n.onload=()=>{if(n.status>=200&&n.status<400){const t=JSON.parse(n.responseText);Ge(t.jid).then(()=>{e({jid:t.jid,password:t.password})})}else t(new Error("".concat(n.status,": ").concat(n.responseText)))},n.onerror=t,n.send()},e))}function Qe(){Backbone.history.stop(),document.removeEventListener("visibilitychange",Le.saveWindowState),Le.api.trigger("unregisteredGlobalEventHandlers"),delete Le.controlboxtoggle,Le.chatboxviews&&delete Le.chatboxviews,Le.stopListening(),Le.off()}Le.shouldClearCache=function(){return!Le.config.get("trusted")||Le.isTestEnv()},Le.initConnection=async function(){if(!Le.connection){if(!Le.bosh_service_url&&!Le.websocket_url)throw new Error("initConnection: you must supply a value for either the bosh_service_url or websocket_url or both.");if(("WebSocket"in window||"MozWebSocket"in window)&&Le.websocket_url)Le.connection=new Ce.Connection(Le.websocket_url,Object.assign(Le.default_connection_options,Le.connection_options));else{if(!Le.bosh_service_url)throw new Error("initConnection: this browser does not support websockets and bosh_service_url wasn't specified.");Le.connection=new Ce.Connection(Le.bosh_service_url,Object.assign(Le.default_connection_options,Le.connection_options,{keepalive:Le.keepalive}))}(Le.auto_login||Le.keepalive)&&await Le.api.user.login(null,null,!0)}Ce.log=function(e,t){Le.log(t,e)},Le.connection.xmlInput=function(e){Le.debug&&Le.log(e.outerHTML,Ce.LogLevel.DEBUG,"color: darkgoldenrod")},Le.connection.xmlOutput=function(e){Le.debug&&Le.log(e.outerHTML,Ce.LogLevel.DEBUG,"color: darkcyan")},Le.api.trigger("connectionInitialized")},Le.initialize=async function(e,t){e=void 0!==e?e:{};const n=Ne.getResolveablePromise();if(Fe.forEach(Pe),void 0!==Le.connection&&Qe(),"onpagehide"in window?Le.unloadevent="pagehide":"onbeforeunload"in window?Le.unloadevent="beforeunload":"onunload"in window&&(Le.unloadevent="unload"),D.a.assignIn(this,this.default_settings),D.a.assignIn(this,D.a.pick(e,Object.keys(this.default_settings))),this.settings={},D.a.assignIn(this.settings,D.a.pick(e,Object.keys(this.default_settings))),this.authentication===Le.ANONYMOUS&&this.auto_login&&!this.jid)throw new Error("Config Error: you need to provide the server's domain via the 'jid' option when using anonymous authentication with auto_login.");if(Le.router.route(/^converse\?debug=(true|false)$/,"debug",e=>{Le.debug="true"===e}),void 0===J||Le.isTestEnv())Le.locale="en";else try{Le.locale=J.getLocale(e.i18n,Le.locales),await J.fetchTranslations(Le)}catch(e){Le.log(e.message,Ce.LogLevel.FATAL)}return this.callback=t||function(){},this.send_initial_presence=!0,this.msg_counter=0,this.user_settings=e,this.generateResource=()=>"/converse.js-".concat(Math.floor(139749528*Math.random()).toString()),this.sendCSI=function(e){Le.api.send(Oe(e,{xmlns:Ce.NS.CSI})),Le.inactive=e===Le.INACTIVE},this.onUserActivity=function(){Le.idle_seconds>0&&(Le.idle_seconds=0),Le.connection.authenticated&&(Le.inactive&&Le.sendCSI(Le.ACTIVE),Le.idle&&(Le.idle=!1,Le.xmppstatus.sendPresence()),!0===Le.auto_changed_status&&(Le.auto_changed_status=!1,Le.xmppstatus.set("status",Le.default_state)))},this.onEverySecond=function(){if(!Le.connection.authenticated)return;const e=Le.xmppstatus.get("status");Le.idle_seconds++,Le.csi_waiting_time>0&&Le.idle_seconds>Le.csi_waiting_time&&!Le.inactive&&Le.sendCSI(Le.INACTIVE),Le.idle_presence_timeout>0&&Le.idle_seconds>Le.idle_presence_timeout&&!Le.idle&&(Le.idle=!0,Le.xmppstatus.sendPresence()),Le.auto_away>0&&Le.idle_seconds>Le.auto_away&&"away"!==e&&"xa"!==e&&"dnd"!==e?(Le.auto_changed_status=!0,Le.xmppstatus.set("status","away")):Le.auto_xa>0&&Le.idle_seconds>Le.auto_xa&&"xa"!==e&&"dnd"!==e&&(Le.auto_changed_status=!0,Le.xmppstatus.set("status","xa"))},this.registerIntervalHandler=function(){if(Le.auto_away<1&&Le.auto_xa<1&&Le.csi_waiting_time<1&&Le.idle_presence_timeout<1)return;Le.idle_seconds=0,Le.auto_changed_status=!1,window.addEventListener("click",Le.onUserActivity),window.addEventListener("focus",Le.onUserActivity),window.addEventListener("keypress",Le.onUserActivity),window.addEventListener("mousemove",Le.onUserActivity);window.addEventListener(Le.unloadevent,Le.onUserActivity,{once:!0,passive:!0}),window.addEventListener(Le.unloadevent,()=>{Le.session&&Le.session.save("active",!1)}),Le.everySecondTrigger=window.setInterval(Le.onEverySecond,1e3)},this.setConnectionStatus=function(e,t){Le.connfeedback.set({connection_status:e,message:t})},this.rejectPresenceSubscription=function(e,t){const n=Me({to:e,type:"unsubscribed"});t&&""!==t&&n.c("status").t(t),Le.api.send(n)},this.onDisconnected=function(){const e=Le.disconnection_reason;return Le.disconnection_cause===Ce.Status.AUTHFAIL?Le.auto_reconnect&&(Le.credentials_url||Le.authentication===Le.ANONYMOUS)?Le.api.connection.reconnect():Xe():Le.disconnection_cause===Le.LOGOUT||void 0!==e&&e===D.a.get(Ce,"ErrorCondition.NO_AUTH_MECH")||"host-unknown"===e||"remote-connection-failed"===e||!Le.auto_reconnect?Xe():void Le.api.connection.reconnect()},this.setDisconnectionCause=function(e,t,n){void 0===e?(delete Le.disconnection_cause,delete Le.disconnection_reason):(void 0===Le.disconnection_cause||n)&&(Le.disconnection_cause=e,Le.disconnection_reason=t)},this.onConnectStatusChanged=function(e,t){if(Le.log("Status changed to: ".concat(Le.CONNECTION_STATUS[e])),e===Ce.Status.CONNECTED||e===Ce.Status.ATTACHED)Le.setConnectionStatus(e),Le.send_initial_presence=!0,Le.setDisconnectionCause(),Le.connection.reconnecting?(Le.log(e===Ce.Status.CONNECTED?"Reconnected":"Reattached"),Je(!0)):(Le.log(e===Ce.Status.CONNECTED?"Connected":"Attached"),Le.connection.restored&&(Le.send_initial_presence=!1),Je());else if(e===Ce.Status.DISCONNECTED)Le.setDisconnectionCause(e,t),Le.onDisconnected();else if(e===Ce.Status.BINDREQUIRED)Le.bindResource();else if(e===Ce.Status.ERROR)Le.setConnectionStatus(e,De("An error occurred while connecting to the chat server."));else if(e===Ce.Status.CONNECTING)Le.setConnectionStatus(e);else if(e===Ce.Status.AUTHENTICATING)Le.setConnectionStatus(e);else if(e===Ce.Status.AUTHFAIL)t||(t=De("Your Jabber ID and/or password is incorrect. Please try again.")),Le.setConnectionStatus(e,t),Le.setDisconnectionCause(e,t,!0),Le.onDisconnected();else if(e===Ce.Status.CONNFAIL){let n=t;"host-unknown"===t||"remote-connection-failed"==t?n=De("Sorry, we could not connect to the XMPP host with domain: %1$s",'"'.concat(Ce.getDomainFromJid(Le.connection.jid),'"')):void 0!==t&&t===D.a.get(Ce,"ErrorCondition.NO_AUTH_MECH")&&(n=De("The XMPP server did not offer a supported authentication mechanism")),Le.setConnectionStatus(e,n),Le.setDisconnectionCause(e,t)}else e===Ce.Status.DISCONNECTING&&Le.setDisconnectionCause(e,t)},this.incrementMsgCounter=function(){this.msg_counter+=1;const e=this.msg_counter;let t=document.title;t&&(t=-1===t.search(/^Messages \(\d+\) /)?"Messages (".concat(e,") ").concat(t):t.replace(/^Messages \(\d+\) /,"Messages (".concat(e,")")))},this.clearMsgCounter=function(){this.msg_counter=0;let e=document.title;e&&-1!==e.search(/^Messages \(\d+\) /)&&(e=e.replace(/^Messages \(\d+\) /,""))},this.initStatus=e=>{if(e=void 0!==Le.xmppstatus&&e)Le.onStatusInitialized(e);else{const t="converse.xmppstatus-".concat(Le.bare_jid);Le.xmppstatus=new this.XMPPStatus({id:t}),Le.xmppstatus.browserStorage=new i.a.session(t),Le.xmppstatus.fetch({success:()=>Le.onStatusInitialized(e),error:()=>Le.onStatusInitialized(e),silent:!0})}},this.saveWindowState=function(e){let t;const n={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};"visible"===(t=(e=e||document.createEvent("Events")).type in n?n[e.type]:document.hidden?"hidden":"visible")&&Le.clearMsgCounter(),Le.windowState=t,Le.api.trigger("windowStateChanged",{state:t})},this.registerGlobalEventHandlers=function(){document.addEventListener("visibilitychange",Le.saveWindowState),Le.saveWindowState({type:document.hidden?"blur":"focus"}),Le.api.trigger("registeredGlobalEventHandlers")},this.enableCarbons=function(){if(!this.message_carbons||!this.session||this.session.get("carbons_enabled"))return;const e=new Ce.Builder("iq",{from:this.connection.jid,id:"enablecarbons",type:"set"}).c("enable",{xmlns:Ce.NS.CARBONS});this.connection.addHandler(e=>{e.querySelectorAll("error").length>0?Le.log("An error occurred while trying to enable message carbons.",Ce.LogLevel.WARN):(this.session.save({carbons_enabled:!0}),Le.log("Message carbons have been enabled."))},null,"iq",null,"enablecarbons"),this.connection.send(e)},this.sendInitialPresence=function(){Le.send_initial_presence&&Le.xmppstatus.sendPresence()},this.onStatusInitialized=function(e){Le.api.trigger("statusInitialized",e),e?Le.api.trigger("reconnected"):(n.resolve(),Le.api.trigger("initialized"),Le.api.trigger("connected"))},this.bindResource=async function(){await Le.api.trigger("beforeResourceBinding",{synchronous:!0}),Le.connection.bind()},this.ConnectionFeedback=Backbone.Model.extend({defaults:{connection_status:Ce.Status.DISCONNECTED,message:""},initialize(){this.on("change",()=>Le.api.trigger("connfeedback",Le.connfeedback))}}),this.connfeedback=new this.ConnectionFeedback,this.XMPPStatus=Backbone.Model.extend({defaults:{status:Le.default_state},initialize(){this.on("change",e=>{D.a.isObject(e.changed)&&("status"in e.changed||"status_message"in e.changed)&&this.sendPresence(this.get("status"),this.get("status_message"))})},getNickname:()=>Le.nickname,getFullname:()=>"",constructPresence(e,t){let n;if(e=D.a.isString(e)?e:this.get("status")||Le.default_state,t=D.a.isString(t)?t:this.get("status_message"),n="unavailable"===e||"probe"===e||"error"===e||"unsubscribe"===e||"unsubscribed"===e||"subscribe"===e||"subscribed"===e?Me({type:e}):"offline"===e?Me({type:"unavailable"}):"online"===e?Me():Me().c("show").t(e).up(),t&&n.c("status").t(t).up(),n.c("priority").t(D.a.isNaN(Number(Le.priority))?0:Le.priority).up(),Le.idle){const e=new Date;e.setSeconds(e.getSeconds()-Le.idle_seconds),n.c("idle",{xmlns:Ce.NS.IDLE,since:e.toISOString()})}return n},sendPresence(e,t){Le.api.send(this.constructPresence(e,t))}}),e.connection&&(this.connection=e.connection),await Ye(),Le.isTestEnv()?Le:n},Le.api={connection:{connected:()=>Le.connection&&Le.connection.connected||!1,disconnect(){Le.connection&&Le.connection.disconnect()},async reconnect(){const e=Le.connfeedback.get("connection_status");if(Le.authentication===Le.ANONYMOUS&&(Ue(),$e()),e===Ce.Status.CONNFAIL&&(Le.api.connection.isType("websocket")&&Le.bosh_service_url?(await Ge(Le.bare_jid),Le.connection._proto._doDisconnect(),Le.connection._proto=new Ce.Bosh(Le.connection),Le.connection.service=Le.bosh_service_url):Le.api.connection.isType("bosh")&&Le.websocket_url&&(Le.authentication===Le.ANONYMOUS?await Ge(Le.settings.jid):await Ge(Le.bare_jid),Le.connection._proto._doDisconnect(),Le.connection._proto=new Ce.Websocket(Le.connection),Le.connection.service=Le.websocket_url)),e===Ce.Status.AUTHFAIL&&Le.authentication===Le.ANONYMOUS&&await Ge(Le.settings.jid),!Le.connection.reconnecting)return He();qe()},isType:e=>"websocket"===e.toLowerCase()?Le.connection._proto instanceof Ce.Websocket:"bosh"===e.toLowerCase()?Le.connection._proto instanceof Ce.Bosh:void 0},async trigger(e){const t=Array.from(arguments),n=t.pop();if(n&&n.synchronous){const n=Le._events[e]||[];await Promise.all(n.map(e=>e.callback.call(e.ctx,t)))}else Le.trigger.apply(Le,arguments);const r=Le.promises[e];void 0!==r&&r.resolve()},user:{jid:()=>Le.connection.jid,async login(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Le.api.connection.isType("bosh")){if(await Le.restoreBOSHSession())return;if(Le.authentication===Le.PREBIND&&(!n||Le.auto_login))return Le.startNewPreboundBOSHSession()}else if(Le.authentication===Le.PREBIND)throw new Error("authentication is set to 'prebind' but we don't have a BOSH connection");(e||Le.jid)&&(e=await Ge(e||Le.jid)),t=t||Le.password,ze(e&&t?{jid:e,password:t}:null,n)},logout(){Le.setDisconnectionCause(Le.LOGOUT,void 0,!0),void 0!==Le.connection&&Le.connection.disconnect(),Object.keys(Le.promises).forEach(Pe),Le.api.trigger("logout")},status:{get:()=>Le.xmppstatus.get("status"),set(e,t){const n={status:e};if(!D.a.includes(Object.keys(Le.STATUS_WEIGHTS),e))throw new Error("Invalid availability value. See https://xmpp.org/rfcs/rfc3921.html#rfc.section.2.2.2.1");D.a.isString(t)&&(n.status_message=t),Le.xmppstatus.sendPresence(e),Le.xmppstatus.save(n)},message:{get:()=>Le.xmppstatus.get("status_message"),set(e){Le.xmppstatus.save({status_message:e})}}}},settings:{update(e){Ne.merge(Le.default_settings,e),Ne.merge(Le,e),Ne.applyUserSettings(Le,e,Le.user_settings)},get(e){if(D.a.includes(Object.keys(Le.default_settings),e))return Le[e]},set(e,t){const n={};D.a.isObject(e)?D.a.assignIn(Le,D.a.pick(e,Object.keys(Le.default_settings))):D.a.isString("string")&&(n[e]=t,D.a.assignIn(Le,D.a.pick(n,Object.keys(Le.default_settings))))}},promises:{add(e){(e=Array.isArray(e)?e:[e]).forEach(Pe)}},listen:{once:Le.once.bind(Le),on:Le.on.bind(Le),not:Le.off.bind(Le),stanza(e,t,n){D.a.isFunction(t)?(n=t,t={}):t=t||{},Le.connection.addHandler(n,t.ns,e,t.type,t.id,t.from,t)}},waitUntil(e){if(D.a.isFunction(e))return Ne.waitUntil(e);{const t=Le.promises[e];return void 0===t?null:t}},send(e){if(D.a.isString(e)&&(e=Ne.toStanza(e)),"iq"===e.tagName)return Le.api.sendIQ(e);Le.connection.send(e),Le.api.trigger("send",e)},sendIQ(e,t){let n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t=t||Le.IQ_TIMEOUT,n=r?new Promise((n,r)=>Le.connection.sendIQ(e,n,r,t)):new Promise((n,r)=>Le.connection.sendIQ(e,n,n,t)),Le.api.trigger("send",e),n}},Object.assign(window.converse,{initialize:(e,t)=>Le.initialize(e,t),plugins:{add(e,t){if(t.__name__=e,void 0!==Le.pluggable.plugins[e])throw new TypeError('Error: plugin with name "'.concat(e,'" has already been ')+"registered!");Le.pluggable.plugins[e]=t}},env:{$build:Oe,$iq:Te,$msg:Re,$pres:Me,Backbone:Backbone,Promise:Promise,Strophe:Ce,_:D.a,dayjs:z.a,sizzle:Se.a,utils:Ne}}),window.dispatchEvent(new CustomEvent("converse-loaded"));var Ze=converse;const{Backbone:Ke,Strophe:et,$iq:tt,utils:nt,_:rt}=Ze.env;Ze.plugins.add("converse-disco",{initialize(){const{_converse:e}=this;function t(){const t=et.getBareJidFromJid(e.jid),n="converse.stream-features-".concat(t);e.stream_features&&e.stream_features.browserStorage.id===n||(e.stream_features=new e.Collection,e.stream_features.browserStorage=new i.a.session(n),e.stream_features.fetch({success(t){0===t.length&&e.connection.features&&Array.from(e.connection.features.childNodes).forEach(t=>{e.stream_features.create({name:t.nodeName,xmlns:t.getAttribute("xmlns")})}),e.api.trigger("streamFeaturesAdded")}}))}e.api.promises.add("discoInitialized"),e.api.promises.add("streamFeaturesAdded"),e.DiscoEntity=Ke.Model.extend({idAttribute:"jid",initialize(t,n){this.waitUntilFeaturesDiscovered=nt.getResolveablePromise(),this.dataforms=new e.Collection,this.dataforms.browserStorage=new i.a.session("converse.dataforms-".concat(this.get("jid"))),this.features=new e.Collection,this.features.browserStorage=new i.a.session("converse.features-".concat(this.get("jid"))),this.listenTo(this.features,"add",this.onFeatureAdded),this.fields=new e.Collection,this.fields.browserStorage=new i.a.session("converse.fields-".concat(this.get("jid"))),this.listenTo(this.fields,"add",this.onFieldAdded),this.identities=new e.Collection,this.identities.browserStorage=new i.a.session("converse.identities-".concat(this.get("jid"))),this.fetchFeatures(n),this.items=new e.DiscoEntities,this.items.browserStorage=new i.a.session("converse.disco-items-".concat(this.get("jid"))),this.items.fetch()},async getIdentity(e,t){return await this.waitUntilFeaturesDiscovered,this.identities.findWhere({category:e,type:t})},async hasFeature(e){if(await this.waitUntilFeaturesDiscovered,this.features.findWhere({var:e}))return this},onFeatureAdded(t){t.entity=this,e.api.trigger("serviceDiscovered",t)},onFieldAdded(t){t.entity=this,e.api.trigger("discoExtensionFieldDiscovered",t)},fetchFeatures(e){e.ignore_cache||0===this.features.browserStorage.records.length?this.queryInfo():(this.features.fetch({add:!0,success:()=>{this.waitUntilFeaturesDiscovered.resolve(this),this.trigger("featuresDiscovered")}}),this.identities.fetch({add:!0}))},async queryInfo(){let t;try{t=await e.api.disco.info(this.get("jid"),null)}catch(t){return e.log(t,et.LogLevel.ERROR),void this.waitUntilFeaturesDiscovered.resolve(this)}this.onInfo(t)},onDiscoItems(t){Se()('query[xmlns="'.concat(et.NS.DISCO_ITEMS,'"] item'),t).forEach(t=>{if(t.getAttribute("node"))return;const n=t.getAttribute("jid");if(void 0===this.items.get(n)){const t=e.disco_entities.get(n);t?this.items.add(t):this.items.create({jid:n})}})},async queryForItems(){if(rt.isEmpty(this.identities.where({category:"server"})))return;const t=await e.api.disco.items(this.get("jid"));this.onDiscoItems(t)},onInfo(e){Array.from(e.querySelectorAll("identity")).forEach(e=>{this.identities.create({category:e.getAttribute("category"),type:e.getAttribute("type"),name:e.getAttribute("name")})}),Se()('x[type="result"][xmlns="'.concat(et.NS.XFORM,'"]'),e).forEach(e=>{const t={};Se()("field",e).forEach(e=>{t[e.getAttribute("var")]={value:rt.get(e.querySelector("value"),"textContent"),type:e.getAttribute("type")}}),this.dataforms.create(t)}),e.querySelector('feature[var="'.concat(et.NS.DISCO_ITEMS,'"]'))&&this.queryForItems(),rt.forEach(e.querySelectorAll("feature"),t=>{this.features.create({var:t.getAttribute("var"),from:e.getAttribute("from")})}),Se()('x[type="result"][xmlns="jabber:x:data"] field',e).forEach(t=>{this.fields.create({var:t.getAttribute("var"),value:rt.get(t.querySelector("value"),"textContent"),from:e.getAttribute("from")})}),this.waitUntilFeaturesDiscovered.resolve(this),this.trigger("featuresDiscovered")}}),e.DiscoEntities=e.Collection.extend({model:e.DiscoEntity,fetchEntities(){return new Promise((e,t)=>{this.fetch({add:!0,success:e,error(){t(new Error("Could not fetch disco entities"))}})})}});const n=this;function r(t){const r=t.getElementsByTagName("query")[0].getAttribute("node"),i={xmlns:et.NS.DISCO_INFO};r&&(i.node=r);const s=tt({type:"result",id:t.getAttribute("id")}),o=t.getAttribute("from");return null!==o&&s.attrs({to:o}),s.c("query",i),n._identities.forEach(e=>{const t={category:e.category,type:e.type};e.name&&(t.name=e.name),e.lang&&(t["xml:lang"]=e.lang),s.c("identity",t).up()}),n._features.forEach(e=>s.c("feature",{var:e}).up()),e.api.send(s.tree()),!0}async function s(){e.api.disco.own.identities.add("client","web","Converse"),e.api.disco.own.features.add(et.NS.CHATSTATES),e.api.disco.own.features.add(et.NS.DISCO_INFO),e.api.disco.own.features.add(et.NS.ROSTERX),e.message_carbons&&e.api.disco.own.features.add(et.NS.CARBONS),e.api.trigger("addClientFeatures"),e.connection.addHandler(r,et.NS.DISCO_INFO,"iq","get",null,null),e.disco_entities=new e.DiscoEntities,e.disco_entities.browserStorage=new i.a.session("converse.disco-entities-".concat(e.bare_jid));const t=await e.disco_entities.fetchEntities();0!==t.length&&t.get(e.domain)||e.disco_entities.create({jid:e.domain}),e.api.trigger("discoInitialized")}n._identities=[],n._features=[],e.api.listen.on("userSessionInitialized",t),e.api.listen.on("beforeResourceBinding",t),e.api.listen.on("reconnected",s),e.api.listen.on("connected",s),e.api.listen.on("beforeTearDown",()=>{e.stream_features&&(e.stream_features.clearSession(),delete e.stream_features)}),e.api.listen.on("clearSession",()=>{e.shouldClearCache()&&e.disco_entities&&(Array.from(e.disco_entities.models).forEach(e=>e.features.clearSession()),Array.from(e.disco_entities.models).forEach(e=>e.identities.clearSession()),Array.from(e.disco_entities.models).forEach(e=>e.dataforms.clearSession()),Array.from(e.disco_entities.models).forEach(e=>e.fields.clearSession()),e.disco_entities.clearSession(),delete e.disco_entities)}),Object.assign(e.api,{disco:{stream:{async getFeature(t,n){if(await e.api.waitUntil("streamFeaturesAdded"),!t||!n)throw new Error("name and xmlns need to be provided when calling disco.stream.getFeature");if(void 0!==e.stream_features||e.api.connection.connected())return e.stream_features.findWhere({name:t,xmlns:n});{const r="Tried to get feature ".concat(t," ").concat(n," but _converse.stream_features has been torn down");e.log(r,et.LogLevel.WARN)}}},own:{identities:{add(e,t,r,i){for(var s=0;s<n._identities.length;s++)if(n._identities[s].category==e&&n._identities[s].type==t&&n._identities[s].name==r&&n._identities[s].lang==i)return!1;n._identities.push({category:e,type:t,name:r,lang:i})},clear(){n._identities=[]},get:()=>n._identities},features:{add(e){for(var t=0;t<n._features.length;t++)if(n._features[t]==e)return!1;n._features.push(e)},clear(){n._features=[]},get:()=>n._features}},info(t,n){const r={xmlns:et.NS.DISCO_INFO};n&&(r.node=n);const i=tt({from:e.connection.jid,to:t,type:"get"}).c("query",r);return e.api.sendIQ(i)},items(t,n){const r={xmlns:et.NS.DISCO_ITEMS};return n&&(r.node=n),e.api.sendIQ(tt({from:e.connection.jid,to:t,type:"get"}).c("query",r))},entities:{async get(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(await e.api.waitUntil("discoInitialized"),!t)return e.disco_entities;if(void 0===e.disco_entities&&!e.api.connection.connected()){const n="Tried to look up entity ".concat(t," but _converse.disco_entities has been torn down");return void e.log(n,et.LogLevel.WARN)}const r=e.disco_entities.get(t);return r||!n?r:e.api.disco.entities.create(t)},create:(t,n)=>e.disco_entities.create({jid:t},n)},features:{async get(t,n){if(!n)throw new TypeError("You need to provide an entity JID");await e.api.waitUntil("discoInitialized");let r=await e.api.disco.entities.get(n,!0);if(void 0===e.disco_entities&&!e.api.connection.connected()){const r="Tried to get feature ".concat(t," for ").concat(n," but _converse.disco_entities has been torn down");return void e.log(r,et.LogLevel.WARN)}r=await r.waitUntilFeaturesDiscovered;const i=rt.concat(r.items.map(e=>e.hasFeature(t)),r.hasFeature(t)),s=await Promise.all(i);return rt.filter(s,rt.isObject)}},supports:async(t,n)=>(await e.api.disco.features.get(t,n)).length>0,async refreshFeatures(t){if(!t)throw new TypeError("api.disco.refreshFeatures: You need to provide an entity JID");await e.api.waitUntil("discoInitialized");let n=await e.api.disco.entities.get(t);return n?(n.features.reset(),n.fields.reset(),n.identities.reset(),n.waitUntilFeaturesDiscovered.isPending||(n.waitUntilFeaturesDiscovered=nt.getResolveablePromise()),n.queryInfo()):n=await e.api.disco.entities.create(t,{ignore_cache:!0}),n.waitUntilFeaturesDiscovered},async getFeatures(t){if(!t)throw new TypeError("api.disco.getFeatures: You need to provide an entity JID");await e.api.waitUntil("discoInitialized");let n=await e.api.disco.entities.get(t,!0);return(n=await n.waitUntilFeaturesDiscovered).features},async getFields(t){if(!t)throw new TypeError("api.disco.getFields: You need to provide an entity JID");await e.api.waitUntil("discoInitialized");let n=await e.api.disco.entities.get(t,!0);return(n=await n.waitUntilFeaturesDiscovered).fields},async getIdentity(t,n,r){const i=await e.api.disco.entities.get(r,!0);if(void 0!==i||e.api.connection.connected())return i.getIdentity(t,n);{const n="Tried to look up category ".concat(t," for ").concat(r," but _converse.disco_entities has been torn down");e.log(n,et.LogLevel.WARN)}}}})}});
/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */
var it=function(){var e={base:"https://twemoji.maxcdn.com/v/12.1.4/",ext:".png",size:"72x72",className:"emoji",convert:{fromCodePoint:function(e){var t="string"==typeof e?parseInt(e,16):e;if(t<65536)return a(t);return a(55296+((t-=65536)>>10),56320+(1023&t))},toCodePoint:p},onerror:function(){this.parentNode&&this.parentNode.replaceChild(c(this.alt,!1),this)},parse:function(t,r){r&&"function"!=typeof r||(r={callback:r});return("string"==typeof t?function(e,t){return f(e,function(e){var n,r,i=e,o=l(e),a=t.callback(o,t);if(o&&a){for(r in i="<img ".concat('class="',t.className,'" ','draggable="false" ','alt="',e,'"',' src="',a,'"'),n=t.attributes(e,o))n.hasOwnProperty(r)&&0!==r.indexOf("on")&&-1===i.indexOf(" "+r+"=")&&(i=i.concat(" ",r,'="',n[r].replace(s,d),'"'));i=i.concat("/>")}return i})}:function(e,t){var r,i,s,a,u,d,h,f,p,g,m,_,v,b=function e(t,n){var r,i,s=t.childNodes,a=s.length;for(;a--;)r=s[a],3===(i=r.nodeType)?n.push(r):1!==i||"ownerSVGElement"in r||o.test(r.nodeName.toLowerCase())||e(r,n);return n}(e,[]),y=b.length;for(;y--;){for(s=!1,a=document.createDocumentFragment(),u=b[y],d=u.nodeValue,f=0;h=n.exec(d);){if((p=h.index)!==f&&a.appendChild(c(d.slice(f,p),!0)),m=h[0],_=l(m),f=p+m.length,v=t.callback(_,t),_&&v){for(i in(g=new Image).onerror=t.onerror,g.setAttribute("draggable","false"),r=t.attributes(m,_))r.hasOwnProperty(i)&&0!==i.indexOf("on")&&!g.hasAttribute(i)&&g.setAttribute(i,r[i]);g.className=t.className,g.alt=m,g.src=v,s=!0,a.appendChild(g)}g||a.appendChild(c(m,!1)),g=null}s&&(f<d.length&&a.appendChild(c(d.slice(f),!0)),u.parentNode.replaceChild(a,u))}return e})(t,{callback:r.callback||u,attributes:"function"==typeof r.attributes?r.attributes:h,base:"string"==typeof r.base?r.base:e.base,ext:r.ext||e.ext,size:r.folder||(i=r.size||e.size,"number"==typeof i?i+"x"+i:i),className:r.className||e.className,onerror:r.onerror||e.onerror});var i},replace:f,test:function(e){n.lastIndex=0;var t=n.test(e);return n.lastIndex=0,t}},t={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},n=/(?:\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69])(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f)|[#*0-9]\ufe0f?\u20e3|(?:[©®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5\udeeb\udeec\udef4-\udefa\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd71\udd73-\udd76\udd7a-\udda2\udda5-\uddaa\uddae-\uddb4\uddb7\uddba\uddbc-\uddca\uddd0\uddde-\uddff\ude70-\ude73\ude78-\ude7a\ude80-\ude82\ude90-\ude95]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,r=/\uFE0F/g,i=String.fromCharCode(8205),s=/[&<>'"]/g,o=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,a=String.fromCharCode;return e;function c(e,t){return document.createTextNode(t?e.replace(r,""):e)}function u(e,t){return"".concat(t.base,t.size,"/",e,t.ext)}function l(e){return p(e.indexOf(i)<0?e.replace(r,""):e)}function d(e){return t[e]}function h(){return null}function f(e,t){return String(e).replace(n,t)}function p(e,t){for(var n=[],r=0,i=0,s=0;s<e.length;)r=e.charCodeAt(s++),i?(n.push((65536+(i-55296<<10)+(r-56320)).toString(16)),i=0):55296<=r&&r<=56319?i=r:n.push(r.toString(16));return n.join(t||"-")}}();const{Backbone:st,Strophe:ot}=Ze.env,at=Ze.env.utils,ct={"*\\0/*":"1f646","*\\O/*":"1f646","-___-":"1f611",":'-)":"1f602","':-)":"1f605","':-D":"1f605",">:-)":"1f606","':-(":"1f613",">:-(":"1f620",":'-(":"1f622","O:-)":"1f607","0:-3":"1f607","0:-)":"1f607","0;^)":"1f607","O;-)":"1f607","0;-)":"1f607","O:-3":"1f607","-__-":"1f611",":-Þ":"1f61b","</3":"1f494",":')":"1f602",":-D":"1f603","':)":"1f605","'=)":"1f605","':D":"1f605","'=D":"1f605",">:)":"1f606",">;)":"1f606",">=)":"1f606",";-)":"1f609","*-)":"1f609",";-]":"1f609",";^)":"1f609","':(":"1f613","'=(":"1f613",":-*":"1f618",":^*":"1f618",">:P":"1f61c","X-P":"1f61c",">:[":"1f61e",":-(":"1f61e",":-[":"1f61e",">:(":"1f620",":'(":"1f622",";-(":"1f622",">.<":"1f623","#-)":"1f635","%-)":"1f635","X-)":"1f635","\\0/":"1f646","\\O/":"1f646","0:3":"1f607","0:)":"1f607","O:)":"1f607","O=)":"1f607","O:3":"1f607","B-)":"1f60e","8-)":"1f60e","B-D":"1f60e","8-D":"1f60e","-_-":"1f611",">:\\":"1f615",">:/":"1f615",":-/":"1f615",":-.":"1f615",":-P":"1f61b",":Þ":"1f61b",":-b":"1f61b",":-O":"1f62e",O_O:"1f62e",">:O":"1f62e",":-X":"1f636",":-#":"1f636",":-)":"1f642","(y)":"1f44d","<3":"2764",":D":"1f603","=D":"1f603",";)":"1f609","*)":"1f609",";]":"1f609",";D":"1f609",":*":"1f618","=*":"1f618",":(":"1f61e",":[":"1f61e","=(":"1f61e",":@":"1f620",";(":"1f622","D:":"1f628",":$":"1f633","=$":"1f633","#)":"1f635","%)":"1f635","X)":"1f635","B)":"1f60e","8)":"1f60e",":/":"1f615",":\\":"1f615","=/":"1f615","=\\":"1f615",":L":"1f615","=L":"1f615",":P":"1f61b","=P":"1f61b",":b":"1f61b",":O":"1f62e",":X":"1f636",":#":"1f636","=X":"1f636","=#":"1f636",":)":"1f642","=]":"1f642","=)":"1f642",":]":"1f642"},ut=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|((\\s|^)(\\*\\\\0\\/\\*|\\*\\\\O\\/\\*|\\-___\\-|\\:'\\-\\)|'\\:\\-\\)|'\\:\\-D|\\>\\:\\-\\)|>\\:\\-\\)|'\\:\\-\\(|\\>\\:\\-\\(|>\\:\\-\\(|\\:'\\-\\(|O\\:\\-\\)|0\\:\\-3|0\\:\\-\\)|0;\\^\\)|O;\\-\\)|0;\\-\\)|O\\:\\-3|\\-__\\-|\\:\\-Þ|\\:\\-Þ|\\<\\/3|<\\/3|\\:'\\)|\\:\\-D|'\\:\\)|'\\=\\)|'\\:D|'\\=D|\\>\\:\\)|>\\:\\)|\\>;\\)|>;\\)|\\>\\=\\)|>\\=\\)|;\\-\\)|\\*\\-\\)|;\\-\\]|;\\^\\)|'\\:\\(|'\\=\\(|\\:\\-\\*|\\:\\^\\*|\\>\\:P|>\\:P|X\\-P|\\>\\:\\[|>\\:\\[|\\:\\-\\(|\\:\\-\\[|\\>\\:\\(|>\\:\\(|\\:'\\(|;\\-\\(|\\>\\.\\<|>\\.<|#\\-\\)|%\\-\\)|X\\-\\)|\\\\0\\/|\\\\O\\/|0\\:3|0\\:\\)|O\\:\\)|O\\=\\)|O\\:3|B\\-\\)|8\\-\\)|B\\-D|8\\-D|\\-_\\-|\\>\\:\\\\|>\\:\\\\|\\>\\:\\/|>\\:\\/|\\:\\-\\/|\\:\\-\\.|\\:\\-P|\\:Þ|\\:Þ|\\:\\-b|\\:\\-O|O_O|\\>\\:O|>\\:O|\\:\\-X|\\:\\-#|\\:\\-\\)|\\(y\\)|\\<3|<3|\\:D|\\=D|;\\)|\\*\\)|;\\]|;D|\\:\\*|\\=\\*|\\:\\(|\\:\\[|\\=\\(|\\:@|;\\(|D\\:|\\:\\$|\\=\\$|#\\)|%\\)|X\\)|B\\)|8\\)|\\:\\/|\\:\\\\|\\=\\/|\\=\\\\|\\:L|\\=L|\\:P|\\=P|\\:b|\\:O|\\:X|\\:#|\\=X|\\=#|\\:\\)|\\=\\]|\\=\\)|\\:\\])(?=\\s|$|[!,.?]))","gi");function lt(e){if(e.indexOf("-")>-1){const t=[],n=e.split("-");for(let e=0;e<n.length;e++){let r=parseInt(n[e],16);if(r>=65536&&r<=1114111){const e=Math.floor((r-65536)/1024)+55296,t=(r-65536)%1024+56320;r=String.fromCharCode(e)+String.fromCharCode(t)}else r=String.fromCharCode(r);t.push(r)}return t.join("")}return it.convert.fromCodePoint(e)}Ze.plugins.add("converse-emoji",{async initialize(){const{_converse:e}=this,{__:t}=e;e.api.settings.update({emoji_image_path:it.base,emoji_categories:{smileys:":grinning:",people:":thumbsup:",activity:":soccer:",travel:":motorcycle:",objects:":bomb:",nature:":rainbow:",food:":hotdog:",symbols:":musical_note:",flags:":flag_ac:"}}),e.api.promises.add(["emojisInitialized"]),it.base=e.emoji_image_path,e.emoji_category_labels={smileys:t("Smileys and emotions"),people:t("People"),activity:t("Activities"),travel:t("Travel"),objects:t("Objects"),nature:t("Animals and nature"),food:t("Food and drink"),symbols:t("Symbols"),flags:t("Flags")},e.EmojiPicker=st.Model.extend({defaults:{current_category:"smileys",current_skintone:"",scroll_position:0}}),e.emojis={};const r={};Object.assign(at,{addEmoji:e=>at.getEmojiRenderer()(e),getEmojiRenderer(){const t={attributes:(e,t)=>{const n=it.convert.toCodePoint(e);return{title:"".concat(at.getEmojisByAtrribute("cp")[n].sn," ").concat(e)}}},n=at.shortnameToUnicode;return e.use_system_emojis?n:e=>it.parse(n(e),t)},shortnameToUnicode:t=>t=(t=t.replace(e.emojis.shortnames_regex,t=>{if(void 0===t||""===t||!e.emoji_shortnames.includes(t))return t;return lt(e.emojis_map[t].cp.toUpperCase())})).replace(ut,(e,t,n,r)=>{if(void 0===r||""===r||!(at.unescapeHTML(r)in ct))return e;return r=at.unescapeHTML(r),n+lt(ct[r].toUpperCase())}),isSingleEmoji(e){if(!(e=e.trim())||e.length>2&&!e.startsWith(":"))return;const t=it.parse(at.shortnameToUnicode(e)).match(/<img class="emoji" draggable="false" alt=".*?" src=".*?\.png"\/>/);return t&&1===t.length},getEmojisByAtrribute(t){if(r[t])return r[t];if("category"===t)return e.emojis.json;const n=e.emojis_list.map(e=>e[t]).filter((e,t,n)=>n.indexOf(e)==t);return r[t]={},n.forEach(n=>r[t][n]=D.a.find(e.emojis_list,e=>e[t]===n)),r[t]}});const{default:i}=await n.e(129).then(n.t.bind(null,385,3));e.emojis.json=i,e.emojis.categories=Object.keys(e.emojis.json),e.emojis_map=e.emojis.categories.reduce((t,n)=>Object.assign(t,e.emojis.json[n]),{}),e.emojis_list=Object.values(e.emojis_map),e.emojis_list.sort((e,t)=>e.sn<t.sn?-1:e.sn>t.sn?1:0),e.emoji_shortnames=e.emojis_list.map(e=>e.sn);e.emojis.shortnames_regex=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|("+(()=>e.emoji_shortnames.map(e=>e.replace(/[+]/g,"\\$&")).join("|"))()+")","gi"),e.emojis.toned=(e.toned_emojis||(e.toned_emojis=D.a.uniq(Object.values(e.emojis.json.people).filter(e=>e.sn.includes("_tone")).map(e=>e.sn.replace(/_tone[1-5]/,"")))),e.toned_emojis),e.api.trigger("emojisInitialized"),e.api.listen.on("clearSession",()=>{e.emojipicker&&(e.emojipicker.browserStorage._clear(),e.emojipicker.destroy(),delete e.emojipicker)})}});const{Strophe:dt,sizzle:ht,_:ft}=Ze.env;Ne.computeAffiliationsDelta=function(e,t,n,r){const i=n.map(e=>e.jid),s=r.map(e=>e.jid);let o=ft.map(ft.difference(i,s),e=>n[ft.indexOf(i,e)]);return e||(o=o.concat(ft.filter(n,function(e){const t=ft.indexOf(s,e.jid);return t>=0&&e.affiliation!==r[t].affiliation}))),t&&(o=o.concat(ft.map(ft.difference(s,i),e=>({jid:e,affiliation:"none"})))),o},Ne.parseMemberListIQ=function(e){return ht('query[xmlns="'.concat(dt.NS.MUC_ADMIN,'"] item'),e).map(e=>{const t={affiliation:e.getAttribute("affiliation")},n=e.getAttribute("jid");Ne.isValidJID(n)?t.jid=n:t.nick=n;const r=e.getAttribute("nick");return r&&(t.nick=r),e.getAttribute("role")&&(t.role=r),t})};var pt=n(99),gt=n.n(pt);Ne.webForm2xForm=function(e){let t;return t="checkbox"===e.getAttribute("type")?e.checked?1:0:"TEXTAREA"==e.tagName?D.a.filter(e.value.split("\n"),D.a.trim):"SELECT"==e.tagName?Ne.getSelectValues(e):e.value,Ne.stringToNode(gt()({name:e.getAttribute("name"),value:t}))};var mt=Ne;const _t={moderator:1,participant:2,visitor:3,none:2},{Strophe:vt,Backbone:bt,$iq:yt,$build:St,$msg:wt,$pres:xt,sizzle:Et,_:At}=Ze.env;vt.addNamespace("MUC_ADMIN",vt.NS.MUC+"#admin"),vt.addNamespace("MUC_OWNER",vt.NS.MUC+"#owner"),vt.addNamespace("MUC_REGISTER","jabber:iq:register"),vt.addNamespace("MUC_ROOMCONF",vt.NS.MUC+"#roomconfig"),vt.addNamespace("MUC_USER",vt.NS.MUC+"#user"),Ze.MUC_NICK_CHANGED_CODE="303",Ze.ROOM_FEATURES=["passwordprotected","unsecured","hidden","publicroom","membersonly","open","persistent","temporary","nonanonymous","semianonymous","moderated","unmoderated","mam_enabled"],Ze.ROOMSTATUS={CONNECTED:0,CONNECTING:1,NICKNAME_REQUIRED:2,PASSWORD_REQUIRED:3,DISCONNECTED:4,ENTERED:5,DESTROYED:6},Ze.plugins.add("converse-muc",{dependencies:["converse-chatboxes","converse-disco","converse-controlbox"],overrides:{ChatBoxes:{model(e,t){const{_converse:n}=this.__super__;return e.type==n.CHATROOMS_TYPE?new n.ChatRoom(e,t):this.__super__.model.apply(this,arguments)}}},initialize(){const{_converse:e}=this,{__:t}=e;if(e.api.settings.update({allow_muc:!0,allow_muc_invitations:!0,auto_join_on_invite:!1,auto_join_rooms:[],auto_register_muc_nickname:!1,locked_muc_domain:!1,muc_domain:void 0,muc_fetch_members:!0,muc_history_max_stanzas:void 0,muc_instant_rooms:!0,muc_nickname_from_jid:!1}),e.api.promises.add(["roomsAutoJoined"]),e.locked_muc_domain&&!At.isString(e.muc_domain))throw new Error("Config Error: it makes no sense to set locked_muc_domain to true when muc_domain is not set");function n(e){return e}if(e.muc={info_messages:{100:t("This groupchat is not anonymous"),102:t("This groupchat now shows unavailable members"),103:t("This groupchat does not show unavailable members"),104:t("The groupchat configuration has changed"),170:t("Groupchat logging is now enabled"),171:t("Groupchat logging is now disabled"),172:t("This groupchat is now no longer anonymous"),173:t("This groupchat is now semi-anonymous"),174:t("This groupchat is now fully-anonymous"),201:t("A new groupchat has been created")},new_nickname_messages:{210:n("Your nickname has been automatically set to %1$s"),303:n("Your nickname has been changed to %1$s")},disconnect_messages:{301:t("You have been banned from this groupchat"),307:t("You have been kicked from this groupchat"),321:t("You have been removed from this groupchat because of an affiliation change"),322:t("You have been removed from this groupchat because the groupchat has changed to members-only and you're not a member"),332:t("You have been removed from this groupchat because the service hosting it is being shut down")},action_info_messages:{301:n("%1$s has been banned"),303:n("%1$s's nickname has changed"),307:n("%1$s has been kicked out"),321:n("%1$s has been removed because of an affiliation change"),322:n("%1$s has been removed for not being a member")}},e.router.route("converse/room?jid=:jid",async function(t){if(!mt.isValidMUCJID(t))return e.log('Invalid JID "'.concat(t,'" provided in URL fragment'),vt.LogLevel.WARN);await e.api.waitUntil("roomsAutoJoined"),e.allow_bookmarks&&await e.api.waitUntil("bookmarksInitialized"),e.api.rooms.open(t)}),e.getDefaultMUCNickname=function(){if(!e.xmppstatus)throw new Error("Can't call _converse.getDefaultMUCNickname before the statusInitialized has been fired.");const t=e.xmppstatus.getNickname();return t||(e.muc_nickname_from_jid?vt.unescapeNode(vt.getNodeFromJid(e.bare_jid)):void 0)},e.ChatRoomMessage=e.Message.extend({initialize(){this.get("file")&&this.on("change:put",this.uploadFile,this),this.isEphemeral()?window.setTimeout(this.safeDestroy.bind(this),1e4):(this.setOccupant(),this.setVCard())},onOccupantRemoved(t){this.stopListening(this.occupant),delete this.occupant;const n=At.get(this,"collection.chatbox");if(!n)return e.log("Could not get collection.chatbox for message: ".concat(JSON.stringify(this.toJSON())),vt.LogLevel.ERROR);this.listenTo(n.occupants,"add",this.onOccupantAdded)},onOccupantAdded(t){if(t.get("nick")===vt.getResourceFromJid(this.get("from"))){this.occupant=t,this.listenTo(this.occupant,"destroy",this.onOccupantRemoved);const n=At.get(this,"collection.chatbox");if(!n)return e.log("Could not get collection.chatbox for message: ".concat(JSON.stringify(this.toJSON())),vt.LogLevel.ERROR);this.stopListening(n.occupants,"add",this.onOccupantAdded)}},setOccupant(){if("groupchat"!==this.get("type"))return;const t=At.get(this,"collection.chatbox");if(!t)return e.log("Could not get collection.chatbox for message: ".concat(JSON.stringify(this.toJSON())),vt.LogLevel.ERROR);const n=vt.getResourceFromJid(this.get("from"));this.occupant=t.occupants.findWhere({nick:n}),this.occupant?this.listenTo(this.occupant,"destroy",this.onOccupantRemoved):this.listenTo(t.occupants,"add",this.onOccupantAdded)},getVCardForChatroomOccupant(){const t=At.get(this,"collection.chatbox"),n=vt.getResourceFromJid(this.get("from"));if(t&&t.get("nick")===n)return e.xmppstatus.vcard;{let t;if(this.get("vcard_jid")&&(t=e.vcards.findWhere({jid:this.get("vcard_jid")})),!t){let n;if(this.occupant&&this.occupant.get("jid")?(n=this.occupant.get("jid"),this.save({vcard_jid:n},{silent:!0})):n=this.get("from"),!n)return void e.log("Could not assign VCard for message because no JID found! msgid: ".concat(this.get("msgid")),vt.LogLevel.ERROR);t=e.vcards.findWhere({jid:n})||e.vcards.create({jid:n})}return t}},setVCard(){e.vcards&&(["error","info"].includes(this.get("type"))||(this.vcard=this.getVCardForChatroomOccupant()))}}),e.ChatRoomMessages=e.Collection.extend({model:e.ChatRoomMessage,comparator:"time"}),e.ChatRoom=e.ChatBox.extend({messagesCollection:e.ChatRoomMessages,defaults(){return{num_unread_general:0,bookmarked:!1,chat_state:void 0,connection_status:Ze.ROOMSTATUS.DISCONNECTED,description:"",hidden:["mobile","fullscreen"].includes(e.view_mode),message_type:"groupchat",name:"",num_unread:0,roomconfig:{},time_sent:new Date(0).toISOString(),time_opened:this.get("time_opened")||(new Date).getTime(),type:e.CHATROOMS_TYPE}},async initialize(){e.vcards&&(this.vcard=e.vcards.findWhere({jid:this.get("jid")})||e.vcards.create({jid:this.get("jid")})),this.set("box_id","box-".concat(btoa(this.get("jid")))),this.initFeatures(),this.on("change:chat_state",this.sendChatState,this),this.on("change:connection_status",this.onConnectionStatusChanged,this),this.initMessages(),this.registerHandlers(),await this.initOccupants(),await this.fetchMessages(),this.enterRoom()},async enterRoom(){const t=this.get("connection_status");if(e.log("".concat(this.get("jid")," initialized with connection_status ").concat(t),vt.LogLevel.DEBUG),t!==Ze.ROOMSTATUS.ENTERED){if(this.removeNonMembers(),await this.refreshRoomFeatures(),e.clear_messages_on_reconnection&&this.clearMessages(),!mt.isPersistableModel(this))return;this.join()}else await this.rejoinIfNecessary()||this.features.fetch()},async onConnectionStatusChanged(){this.get("connection_status")===Ze.ROOMSTATUS.ENTERED&&(e.muc_fetch_members&&await this.occupants.fetchMembers(),e.api.trigger("enteredNewRoom",this),e.auto_register_muc_nickname&&await e.api.disco.supports(vt.NS.MUC_REGISTER,this.get("jid"))&&this.registerNickname())},removeNonMembers(){const e=this.occupants.filter(e=>!e.isMember());e.length&&e.forEach(e=>e.destroy())},async onReconnection(){this.save("connection_status",Ze.ROOMSTATUS.DISCONNECTED),this.registerHandlers(),await this.enterRoom(),this.announceReconnection()},initFeatures(){e.config.get("storage");const t="converse.muc-features-".concat(e.bare_jid,"-").concat(this.get("jid"));this.features=new bt.Model(At.assign({id:t},At.zipObject(Ze.ROOM_FEATURES,Ze.ROOM_FEATURES.map(At.stubFalse)))),this.features.browserStorage=new i.a.session(t)},initOccupants(){return this.occupants=new e.ChatRoomOccupants,this.occupants.browserStorage=new i.a.session("converse.occupants-".concat(e.bare_jid).concat(this.get("jid"))),this.occupants.chatroom=this,this.occupants.fetched=new Promise(e=>{this.occupants.fetch({add:!0,silent:!0,success:e,error:e})}),this.occupants.fetched},registerHandlers(){const t=this.get("jid");this.removeHandlers(),this.presence_handler=e.connection.addHandler(e=>(this.onPresence(e),!0),null,"presence",null,null,t,{ignoreNamespaceFragment:!0,matchBareFromJid:!0}),this.message_handler=e.connection.addHandler(t=>Et('message > result[xmlns="'.concat(vt.NS.MAM,'"]'),t).pop()?(e.log('Received a MAM message with type "chat".',vt.LogLevel.WARN),!0):(this.onMessage(t),!0),null,"message","groupchat",null,t,{matchBareFromJid:!0})},removeHandlers(){return this.message_handler&&(e.connection.deleteHandler(this.message_handler),delete this.message_handler),this.presence_handler&&(e.connection.deleteHandler(this.presence_handler),delete this.presence_handler),this},getDisplayName(){const t=this.get("name");return t||("hidden"===e.locked_muc_domain?vt.getNodeFromJid(this.get("jid")):this.get("jid"))},async join(t,n){if(this.get("connection_status")===Ze.ROOMSTATUS.ENTERED)return this;if(!(t=await this.getAndPersistNickname(t)))return mt.safeSave(this,{connection_status:Ze.ROOMSTATUS.NICKNAME_REQUIRED}),this;const r=xt({from:e.connection.jid,to:this.getRoomJIDAndNick()}).c("x",{xmlns:vt.NS.MUC}).c("history",{maxstanzas:this.features.get("mam_enabled")?0:e.muc_history_max_stanzas}).up();return n&&r.cnode(vt.xmlElement("password",[],n)),this.save("connection_status",Ze.ROOMSTATUS.CONNECTING),e.api.send(r),this},sendDestroyIQ(t,n){const r=St("destroy");n&&r.attrs({jid:n});const i=yt({to:this.get("jid"),type:"set"}).c("query",{xmlns:vt.NS.MUC_OWNER}).cnode(r.node);return t&&t.length>0&&i.c("reason",t),e.api.sendIQ(i)},leave(t){if(this.features.destroy(),this.occupants.browserStorage._clear(),this.occupants.reset(),e.disco_entities){const t=e.disco_entities.get(this.get("jid"));t&&t.destroy()}e.connection.connected&&this.sendUnavailablePresence(t),mt.safeSave(this,{connection_status:Ze.ROOMSTATUS.DISCONNECTED}),this.removeHandlers()},close(){try{this.features.destroy(),this.features.browserStorage._clear()}catch(t){e.log(t,vt.LogLevel.ERROR)}return e.ChatBox.prototype.close.call(this)},sendUnavailablePresence(t){const n=xt({type:"unavailable",from:e.connection.jid,to:this.getRoomJIDAndNick()});null!==t&&n.c("status",t),e.connection.sendPresence(n)},getReferenceForMention(e,t){const n=mt.getLongestSubstring(e,this.occupants.map(e=>e.getDisplayName()));if(!n)return null;if((e[n.length]||"").match(/[A-Za-zäëïöüâêîôûáéíóúàèìòùÄËÏÖÜÂÊÎÔÛÁÉÍÓÚÀÈÌÒÙ0-9]/i))return null;const r=this.occupants.findOccupant({nick:n})||this.occupants.findOccupant({jid:n});if(!r)return null;const i={begin:t,end:t+n.length,value:n,type:"mention"};return r.get("jid")?i.uri="xmpp:".concat(r.get("jid")):i.uri="xmpp:".concat(this.get("jid"),"/").concat(r.get("nick")),i},extractReference(e,t){for(let n=t;n<e.length;n++)if("@"===e[n]&&(0===n||" "===e[n-1])){const t=e.slice(n+1),r=this.getReferenceForMention(t,n);if(r)return[e.slice(0,n)+t,r,n]}},parseTextForReferences(e){const t=[];let n=0;for(;n<(e||"").length;){const r=this.extractReference(e,n);if(!r)break;e=r[0],t.push(r[1]),n=r[2]}return[e,t]},getOutgoingMessageAttributes(t,n){const r=this.get("composing_spoiler");var i;[t,i]=this.parseTextForReferences(t);const s=e.connection.getUniqueId();return{id:s,msgid:s,origin_id:s,from:"".concat(this.get("jid"),"/").concat(this.get("nick")),fullname:this.get("nick"),is_single_emoji:!!t&&mt.isSingleEmoji(t),is_spoiler:r,message:t?mt.httpToGeoUri(mt.shortnameToUnicode(t),e):void 0,nick:this.get("nick"),references:i,sender:"me",spoiler_hint:r?n:void 0,type:"groupchat"}},getRoomJIDAndNick(){const e=this.get("nick");return vt.getBareJidFromJid(this.get("jid"))+(null!==e?"/".concat(e):"")},sendChatState(){if(!e.send_chat_state_notifications||!this.get("chat_state")||this.get("connection_status")!==Ze.ROOMSTATUS.ENTERED||this.features.get("moderated")&&"visitor"===this.getOwnRole())return;const t=e.send_chat_state_notifications;if(Array.isArray(t)&&!t.includes(this.get("chat_state")))return;const n=this.get("chat_state");n!==e.GONE&&e.api.send(wt({to:this.get("jid"),type:"groupchat"}).c(n,{xmlns:vt.NS.CHATSTATES}).up().c("no-store",{xmlns:vt.NS.HINTS}).up().c("no-permanent-store",{xmlns:vt.NS.HINTS}))},directInvite(t,n){this.features.get("membersonly")&&this.updateMemberLists([{jid:t,affiliation:"member",reason:n}]);const r={xmlns:"jabber:x:conference",jid:this.get("jid")};null!==n&&(r.reason=n),this.get("password")&&(r.password=this.get("password"));const i=wt({from:e.connection.jid,to:t,id:e.connection.getUniqueId()}).c("x",r);e.api.send(i),e.api.trigger("roomInviteSent",{room:this,recipient:t,reason:n})},async refreshRoomFeatures(){return await e.api.disco.refreshFeatures(this.get("jid")),this.getRoomFeatures()},async getRoomFeatures(){let t;try{t=await e.api.disco.getIdentity("conference","text",this.get("jid"))}catch(t){return e.log(t,vt.LogLevel.ERROR)}const n=await e.api.disco.getFields(this.get("jid"));this.save({name:t&&t.get("name"),description:At.get(n.findWhere({var:"muc#roominfo_description"}),"attributes.value")});const r=await e.api.disco.getFeatures(this.get("jid")),i=Object.assign(At.zipObject(Ze.ROOM_FEATURES,Ze.ROOM_FEATURES.map(At.stubFalse)),{fetched:(new Date).toISOString()});r.each(e=>{const t=e.get("var");t.startsWith("muc_")?i[t.replace("muc_","")]=!0:t===vt.NS.MAM&&(i.mam_enabled=!0)}),this.features.save(i)},setAffiliation(e,t){return t=t.filter(t=>void 0===t.affiliation||t.affiliation===e),Promise.all(t.map(t=>this.sendAffiliationIQ(e,t)))},saveConfiguration(e){const t=(e?Et(":input:not([type=button]):not([type=submit])",e):[]).map(mt.webForm2xForm);return this.sendConfiguration(t)},addFieldValue(e){const t=e.getAttribute("type");if("fixed"===t)return e;const n=e.getAttribute("var").replace("muc#roomconfig_",""),r=this.get("roomconfig");if(n in r){let i;switch(t){case"boolean":i=[r[n]?1:0];break;case"list-multi":i=r[n];break;default:i=[r[n]]}e.innerHTML=i.map(e=>St("value").t(e)).join("")}return e},async autoConfigureChatRoom(){const e=await this.fetchRoomConfiguration(),t=Et("field",e).map(e=>this.addFieldValue(e));if(t.length)return this.sendConfiguration(t)},fetchRoomConfiguration(){return e.api.sendIQ(yt({to:this.get("jid"),type:"get"}).c("query",{xmlns:vt.NS.MUC_OWNER}))},sendConfiguration(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const n=yt({to:this.get("jid"),type:"set"}).c("query",{xmlns:vt.NS.MUC_OWNER}).c("x",{xmlns:vt.NS.XFORM,type:"submit"});return t.forEach(e=>n.cnode(e).up()),e.api.sendIQ(n)},getOwnRole(){return At.get(this.getOwnOccupant(),"attributes.role")},getOwnAffiliation(){return At.get(this.getOwnOccupant(),"attributes.affiliation")},getOwnOccupant(){return this.occupants.findWhere({jid:e.bare_jid})},saveAffiliationAndRole(e){const t=Et('x[xmlns="'.concat(vt.NS.MUC_USER,'"] item'),e).pop();if(null!==e.querySelector("status[code='110']")&&t){const e=t.getAttribute("affiliation"),n=t.getAttribute("role"),r={};e&&(r.affiliation=e),n&&(r.role=n),At.isEmpty(r)||this.getOwnOccupant().save(r)}},sendAffiliationIQ(t,n){const r=yt({to:this.get("jid"),type:"set"}).c("query",{xmlns:vt.NS.MUC_ADMIN}).c("item",{affiliation:n.affiliation||t,nick:n.nick,jid:n.jid});return void 0!==n.reason&&r.c("reason",n.reason),e.api.sendIQ(r)},setAffiliations(e){const t=At.uniq(e.map(e=>e.affiliation));return Promise.all(t.map(t=>this.setAffiliation(t,e)))},setRole(t,n,r,i,s){const o=St("item",{nick:t.get("nick"),role:n}),a=yt({to:this.get("jid"),type:"set"}).c("query",{xmlns:vt.NS.MUC_ADMIN}).cnode(o.node);return null!==r&&a.c("reason",r),e.api.sendIQ(a).then(i).catch(s)},getOccupant(e){return mt.isValidJID(e)&&this.occupants.findWhere({jid:e})||this.occupants.findWhere({nick:e})},async getAffiliationList(t){const n=yt({to:this.get("jid"),type:"get"}).c("query",{xmlns:vt.NS.MUC_ADMIN}).c("item",{affiliation:t}),r=await e.api.sendIQ(n,null,!1);if(null===r){const n="Error: timeout while fetching ".concat(t," list for MUC ").concat(this.get("jid")),i=new Error(n);return e.log(n,vt.LogLevel.WARN),e.log(r,vt.LogLevel.WARN),i}if(mt.isErrorStanza(r)){const n="Error: not allowed to fetch ".concat(t," list for MUC ").concat(this.get("jid")),i=new Error(n);return e.log(n,vt.LogLevel.WARN),e.log(r,vt.LogLevel.WARN),i}return mt.parseMemberListIQ(r).filter(e=>e)},async updateMemberLists(t){const n=["member","admin","owner"],r=await Promise.all(n.map(e=>this.getAffiliationList(e))),i=(n.filter(e=>!mt.isErrorObject(r[n.indexOf(e)])),r.reduce((e,t)=>mt.isErrorObject(t)?e:[...t,...e],[]));if(await this.setAffiliations(mt.computeAffiliationsDelta(!0,!1,t,i)),e.muc_fetch_members)return this.occupants.fetchMembers()},async getAndPersistNickname(t){return(t=t||this.get("nick")||await this.getReservedNick()||e.getDefaultMUCNickname())&&this.save({nick:t},{silent:!0}),t},async getReservedNick(){const t=yt({to:this.get("jid"),from:e.connection.jid,type:"get"}).c("query",{xmlns:vt.NS.DISCO_INFO,node:"x-roomuser-item"}),n=await e.api.sendIQ(t,null,!1);if(mt.isErrorObject(n))throw n;const r=n.querySelector('query[node="x-roomuser-item"] identity');return r?r.getAttribute("name"):null},async registerNickname(){const n=this.get("nick"),r=this.get("jid");let i,s;try{i=await e.api.sendIQ(yt({to:r,from:e.connection.jid,type:"get"}).c("query",{xmlns:vt.NS.MUC_REGISTER}))}catch(n){return Et('not-allowed[xmlns="'.concat(vt.NS.STANZAS,'"]'),n).length?s=t("You're not allowed to register yourself in this groupchat."):Et('registration-required[xmlns="'.concat(vt.NS.STANZAS,'"]'),n).length&&(s=t("You're not allowed to register in this groupchat because it's members-only.")),e.log(n,vt.LogLevel.ERROR),s}const o=Et("field required",i).map(e=>e.parentElement);if(o.length>1&&"muc#register_roomnick"!==o[0].getAttribute("var"))return e.log("Can't register the user register in the groupchat ".concat(r," due to the required fields"));try{await e.api.sendIQ(yt({to:r,from:e.connection.jid,type:"set"}).c("query",{xmlns:vt.NS.MUC_REGISTER}).c("x",{xmlns:vt.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#register").up().up().c("field",{var:"muc#register_roomnick"}).c("value").t(n))}catch(n){return Et('service-unavailable[xmlns="'.concat(vt.NS.STANZAS,'"]'),n).length?s=t("Can't register your nickname in this groupchat, it doesn't support registration."):Et('bad-request[xmlns="'.concat(vt.NS.STANZAS,'"]'),n).length&&(s=t("Can't register your nickname in this groupchat, invalid data form supplied.")),e.log(s),e.log(n,vt.LogLevel.ERROR),s}},updateOccupantsOnPresence(e){const t=this.parsePresence(e);if("error"===t.type||!t.jid&&!t.nick)return!0;const n=this.occupants.findOccupant(t);if("unavailable"===t.type&&n&&!t.states.includes(Ze.MUC_NICK_CHANGED_CODE)&&!n.isMember())return n.set(t),void n.destroy();const r=t.jid||"",i=Object.assign(t,{jid:vt.getBareJidFromJid(r)||At.get(n,"attributes.jid"),resource:vt.getResourceFromJid(r)||At.get(n,"attributes.resource")});n?n.save(i):this.occupants.create(i)},parsePresence(e){const t=e.getAttribute("from"),n=e.getAttribute("type"),r={from:t,nick:vt.getResourceFromJid(t),type:n,states:[],show:"unavailable"!==n?"online":"offline"};return e.childNodes.forEach(e=>{switch(e.nodeName){case"status":r.status=e.textContent||null;break;case"show":r.show=e.textContent||"online";break;case"x":e.getAttribute("xmlns")===vt.NS.MUC_USER?e.childNodes.forEach(e=>{switch(e.nodeName){case"item":r.affiliation=e.getAttribute("affiliation"),r.role=e.getAttribute("role"),r.jid=e.getAttribute("jid"),r.nick=e.getAttribute("nick")||r.nick;break;case"status":e.getAttribute("code")&&r.states.push(e.getAttribute("code"))}}):e.getAttribute("xmlns")===vt.NS.VCARDUPDATE&&(r.image_hash=At.get(e.querySelector("photo"),"textContent"))}}),r},fetchFeaturesIfConfigurationChanged(e){const t=["104","170","171","172","173","174"];Et("status",e).filter(e=>t.includes(e.getAttribute("status"))).length&&this.refreshRoomFeatures()},isReceipt:e=>Et('received[xmlns="'.concat(vt.NS.RECEIPTS,'"]'),e).length>0,isChatMarker:e=>Et('received[xmlns="'.concat(vt.NS.MARKERS,'"],\n                     displayed[xmlns="').concat(vt.NS.MARKERS,'"],\n                     acknowledged[xmlns="').concat(vt.NS.MARKERS,'"]'),e).length>0,subjectChangeHandled(e){return!(!e.subject||e.thread||e.message)&&(mt.safeSave(this,{subject:{author:e.nick,text:e.subject||""}}),!0)},setSubject(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e.api.send(wt({to:this.get("jid"),from:e.connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(t).tree())},ignorableCSN(e){return mt.isOnlyChatStateNotification(e)&&(e.is_delayed||this.isOwnMessage(e))},isOwnMessage(t){let n;return n=At.isElement(t)?t.getAttribute("from"):t instanceof e.Message?t.get("from"):t.from,vt.getResourceFromJid(n)==this.get("nick")},getUpdatedMessageAttributes(t,n){const r=e.ChatBox.prototype.getUpdatedMessageAttributes.call(this,t,n);if(this.isOwnMessage(t)){const e=Et('stanza-id[xmlns="'.concat(vt.NS.SID,'"]'),n).pop(),i=e?e.getAttribute("by"):void 0;if(i){r["stanza_id ".concat(i)]=e.getAttribute("id")}t.get("received")||(r.received=(new Date).toISOString())}return r},async isJoined(){const t=yt({to:"".concat(this.get("jid"),"/").concat(this.get("nick")),type:"get"}).c("ping",{xmlns:vt.NS.PING});try{await e.api.sendIQ(t)}catch(e){const t='error not-acceptable[xmlns="'.concat(vt.NS.STANZAS,'"]');if(At.isElement(e)&&Et(t,e).length)return!1}return!0},async rejoinIfNecessary(){if(!await this.isJoined())return this.save("connection_status",Ze.ROOMSTATUS.DISCONNECTED),this.enterRoom(),!0},async shouldShowErrorMessage(t){return(!Et('not-acceptable[xmlns="'.concat(vt.NS.STANZAS,'"]'),t).length||!await this.rejoinIfNecessary())&&e.ChatBox.prototype.shouldShowErrorMessage.call(this,t)},getErrorMessage(n){return Et('forbidden[xmlns="'.concat(vt.NS.STANZAS,'"]'),n).length?t("Your message was not delivered because you're not allowed to send messages in this groupchat."):Et('not-acceptable[xmlns="'.concat(vt.NS.STANZAS,'"]'),n).length?t("Your message was not delivered because you're not present in the groupchat."):e.ChatBox.prototype.getErrorMessage.call(this,n)},async onMessage(t){const n=t;if(Et('message > forwarded[xmlns="'.concat(vt.NS.FORWARD,'"]'),t).length)return e.log("onMessage: Ignoring unencapsulated forwarded groupchat message",vt.LogLevel.WARN);if(mt.isCarbonMessage(t))return e.log('onMessage: Ignoring XEP-0280 "groupchat" message carbon, according to the XEP groupchat messages SHOULD NOT be carbon copied',vt.LogLevel.WARN);if(mt.isMAMMessage(t)){if(n.getAttribute("from")!==this.get("jid"))return e.log("onMessage: Ignoring alleged MAM groupchat message from ".concat(t.getAttribute("from")),vt.LogLevel.WARN);{const e='[xmlns="'.concat(vt.NS.MAM,'"] > forwarded[xmlns="').concat(vt.NS.FORWARD,'"] > message');t=Et(e,t).pop()}}this.createInfoMessages(t),this.fetchFeaturesIfConfigurationChanged(t);const r=await this.getDuplicateMessage(n);if(r&&this.updateMessage(r,n),r||this.isReceipt(t)||this.isChatMarker(t))return e.api.trigger("message",{stanza:n});const i=await this.getMessageAttributesFromStanza(t,n);if(this.setEditable(i,i.time),i.nick&&!this.subjectChangeHandled(i)&&!this.ignorableCSN(i)&&(i.chat_state||!mt.isEmptyMessage(i))){const e=this.correctMessage(i)||this.messages.create(i);this.incrementUnreadMsgCounter(e)}e.api.trigger("message",{stanza:n,chatbox:this})},handleModifyError(e){const t=At.get(e.querySelector("error text"),"textContent");if(t)if(this.get("connection_status")===Ze.ROOMSTATUS.CONNECTING)this.setDisconnectionMessage(t);else{const e={type:"error",message:t,ephemeral:!0};this.messages.create(e)}},handleDisconnection(t){const n=null!==t.querySelector("status[code='110']"),r=Et('x[xmlns="'.concat(vt.NS.MUC_USER,'"]'),t).pop();if(!r)return;const i=Et("status",r).map(e=>e.getAttribute("code")),s=At.intersection(i,Object.keys(e.muc.disconnect_messages));if(!(n&&s.length>0))return;const o=r.querySelector("item"),a=o?At.get(o.querySelector("reason"),"textContent"):void 0,c=o?At.invoke(o.querySelector("actor"),"getAttribute","nick"):void 0,u=e.muc.disconnect_messages[s[0]];this.setDisconnectionMessage(u,a,c)},createInfoMessages(n){const r=null!==n.querySelector("status[code='110']"),i=Et('x[xmlns="'.concat(vt.NS.MUC_USER,'"]'),n).pop();i&&Et("status",i).map(e=>e.getAttribute("code")).forEach(s=>{let o;if("110"!==s&&("100"!==s||r)){if(s in e.muc.info_messages)o=e.muc.info_messages[s];else if(!r&&s in e.muc.action_info_messages){const r=vt.getResourceFromJid(n.getAttribute("from"));o=t(e.muc.action_info_messages[s],r);const a=i.querySelector("item"),c=a?At.get(a.querySelector("reason"),"textContent"):void 0,u=a?At.invoke(a.querySelector("actor"),"getAttribute","nick"):void 0;u&&(o+="\n"+t("This action was done by %1$s.",u)),c&&(o+="\n"+t('The reason given is: "%1$s".',c))}else if(r&&s in e.muc.new_nickname_messages){let i;r&&"210"===s?i=vt.getResourceFromJid(n.getAttribute("from")):r&&"303"===s&&(i=n.querySelector("x item").getAttribute("nick")),this.save("nick",i),o=t(e.muc.new_nickname_messages[s],i)}o&&this.messages.create({type:"info",message:o})}})},setDisconnectionMessage(e,t,n){this.save({connection_status:Ze.ROOMSTATUS.DISCONNECTED,disconnection_message:e,disconnection_reason:t,disconnection_actor:n})},onNicknameClash(n){if(e.muc_nickname_from_jid){const t=n.getAttribute("from").split("/")[1];if(t===e.getDefaultMUCNickname())this.join(t+"-2");else{const e=t.lastIndexOf("-"),n=t.substring(e+1,t.length);this.join(t.substring(0,e+1)+String(Number(n)+1))}}else this.save({nickname_validation_message:t("The nickname you chose is reserved or currently in use, please choose a different one."),connection_status:Ze.ROOMSTATUS.NICKNAME_REQUIRED})},onErrorPresence(e){const n=e.querySelector("error"),r=n.getAttribute("type"),i=At.get(Et('text[xmlns="'.concat(vt.NS.STANZAS,'"]'),n).pop(),"textContent");if("modify"===r)this.handleModifyError(e);else if("auth"===r){if(Et('not-authorized[xmlns="'.concat(vt.NS.STANZAS,'"]'),n).length&&this.save({password_validation_message:i||t("Password incorrect"),connection_status:Ze.ROOMSTATUS.PASSWORD_REQUIRED}),n.querySelector("registration-required")){const e=t("You are not on the member list of this groupchat.");this.setDisconnectionMessage(e,i)}else if(n.querySelector("forbidden")){const e=t("You have been banned from this groupchat.");this.setDisconnectionMessage(e,i)}}else if("cancel"===r)if(n.querySelector("not-allowed")){const e=t("You are not allowed to create new groupchats.");this.setDisconnectionMessage(e,i)}else if(n.querySelector("not-acceptable")){const e=t("Your nickname doesn't conform to this groupchat's policies.");this.setDisconnectionMessage(e,i)}else if(Et('gone[xmlns="'.concat(vt.NS.STANZAS,'"]'),n).length){const e=At.get(Et('gone[xmlns="'.concat(vt.NS.STANZAS,'"]'),n).pop(),"textContent").replace(/^xmpp:/,"").replace(/\?join$/,"");this.save({connection_status:Ze.ROOMSTATUS.DESTROYED,destroyed_reason:i,moved_jid:e})}else if(n.querySelector("conflict"))this.onNicknameClash(e);else if(n.querySelector("item-not-found")){const e=t("This groupchat does not (yet) exist.");this.setDisconnectionMessage(e,i)}else if(n.querySelector("service-unavailable")){const e=t("This groupchat has reached its maximum number of participants.");this.setDisconnectionMessage(e,i)}else if(n.querySelector("remote-server-not-found")){const e=t("Remote server not found"),n=i?t('The explanation given is: "%1$s".',i):void 0;this.setDisconnectionMessage(e,n)}},onPresence(e){if("error"===e.getAttribute("type"))return this.onErrorPresence(e);this.createInfoMessages(e),e.querySelector("status[code='110']")?(this.onOwnPresence(e),"none"!==this.getOwnRole()&&this.get("connection_status")===Ze.ROOMSTATUS.CONNECTING&&this.save("connection_status",Ze.ROOMSTATUS.CONNECTED)):this.updateOccupantsOnPresence(e)},onOwnPresence(t){if("unavailable"!==t.getAttribute("type")&&this.save("connection_status",Ze.ROOMSTATUS.ENTERED),this.updateOccupantsOnPresence(t),this.saveAffiliationAndRole(t),"unavailable"===t.getAttribute("type"))this.handleDisconnection(t);else{if(t.querySelector("status[code='201']"))if(this.get("auto_configure"))this.autoConfigureChatRoom().then(()=>this.refreshRoomFeatures());else{if(!e.muc_instant_rooms)return void this.trigger("configurationNeeded");this.saveConfiguration().then(()=>this.refreshRoomFeatures())}else this.features.get("fetched")||("owner"===this.getOwnAffiliation()&&this.get("auto_configure")?this.autoConfigureChatRoom().then(()=>this.refreshRoomFeatures()):this.getRoomFeatures())}},isUserMentioned(e){const t=this.get("nick");if(e.get("references").length){return e.get("references").filter(e=>"mention"===e.type).map(e=>e.value).includes(t)}return new RegExp("\\b".concat(t,"\\b")).test(e.get("message"))},incrementUnreadMsgCounter(t){if(!t)return;if(t.get("message")&&mt.isNewMessage(t)&&this.isHidden()){const n={num_unread_general:this.get("num_unread_general")+1};this.isUserMentioned(t)&&(n.num_unread=this.get("num_unread")+1,e.incrementMsgCounter()),this.save(n)}},clearUnreadMsgCounter(){mt.safeSave(this,{num_unread:0,num_unread_general:0})}}),e.ChatRoomOccupant=bt.Model.extend({defaults:{show:"offline",states:[]},initialize(t){this.set(Object.assign({id:e.connection.getUniqueId()},t)),this.on("change:image_hash",this.onAvatarChanged,this)},onAvatarChanged(){const t=this.get("image_hash"),n=[];this.get("jid")&&n.push(e.vcards.findWhere({jid:this.get("jid")})),n.push(e.vcards.findWhere({jid:this.get("from")})),n.filter(e=>e).forEach(n=>{t&&n.get("image_hash")!==t&&e.api.vcard.update(n,!0)})},getDisplayName(){return this.get("nick")||this.get("jid")},isMember(){return["admin","owner","member"].includes(this.get("affiliation"))},isModerator(){return["admin","owner"].includes(this.get("affiliation"))||"moderator"===this.get("role")},isSelf(){return this.get("states").includes("110")}}),e.ChatRoomOccupants=e.Collection.extend({model:e.ChatRoomOccupant,comparator(e,t){const n=e.get("role")||"none",r=t.get("role")||"none";if(_t[n]===_t[r]){const n=e.getDisplayName().toLowerCase(),r=t.getDisplayName().toLowerCase();return n<r?-1:n>r?1:0}return _t[n]<_t[r]?-1:1},async fetchMembers(){const t=["member","admin","owner"],n=await Promise.all(t.map(e=>this.chatroom.getAffiliationList(e))),r=n.reduce((e,t)=>mt.isErrorObject(t)?e:[...t,...e],[]),i=t.filter(e=>!mt.isErrorObject(n[t.indexOf(e)])),s=r.map(e=>e.jid).filter(e=>void 0!==e),o=r.map(e=>!e.jid&&e.nick||void 0).filter(e=>void 0!==e);this.filter(e=>i.includes(e.get("affiliation"))&&!o.includes(e.get("nick"))&&!s.includes(e.get("jid"))).forEach(t=>{t.get("jid")!==e.bare_jid&&("offline"===t.get("show")?t.destroy():t.save("affiliation",null))}),r.forEach(e=>{const t=e.jid?this.findOccupant({jid:e.jid}):this.findOccupant({nick:e.nick});t?t.save(e):this.create(e)})},findOccupant(e){const t=vt.getBareJidFromJid(e.jid);return null!==t?this.findWhere({jid:t}):this.findWhere({nick:e.nick})}}),e.RoomsPanelModel=bt.Model.extend({defaults:function(){return{muc_domain:e.muc_domain,nick:e.getDefaultMUCNickname()}},setDomain(t){e.locked_muc_domain||this.save("muc_domain",vt.getDomainFromJid(t))}}),e.onDirectMUCInvitation=function(n){const r=Et('x[xmlns="jabber:x:conference"]',n).pop(),i=vt.getBareJidFromJid(n.getAttribute("from")),s=r.getAttribute("jid"),o=r.getAttribute("reason");let a,c=e.roster.get(i);if(e.auto_join_on_invite?a=!0:(c=c?c.getDisplayName():vt.getNodeFromJid(i),a=o?confirm(t('%1$s has invited you to join a groupchat: %2$s, and left the following reason: "%3$s"',c,s,o)):confirm(t("%1$s has invited you to join a groupchat: %2$s",c,s))),!0===a){(function(t,n){n.type=e.CHATROOMS_TYPE,n.id=t;const r=e.chatboxes.getChatBox(t,n,!0);return r.maybeShow(!0),r})(s,{password:r.getAttribute("password")}).get("connection_status")===Ze.ROOMSTATUS.DISCONNECTED&&e.chatboxes.get(s).join()}},e.allow_muc_invitations){const t=function(){e.connection.addHandler(t=>(e.onDirectMUCInvitation(t),!0),"jabber:x:conference","message")};e.api.listen.on("connected",t),e.api.listen.on("reconnected",t)}const r=function(t,n,r){return t=t.toLowerCase(),n.type=e.CHATROOMS_TYPE,n.id=t,e.chatboxes.getChatBox(t,n,r)},s=function(e,t){return e.startsWith("xmpp:")&&e.endsWith("?join")&&(e=e.replace(/^xmpp:/,"").replace(/\?join$/,"")),r(e,t,!0)};function o(){return e.chatboxes.filter(t=>t.get("type")===e.CHATROOMS_TYPE).forEach(e=>e.save("connection_status",Ze.ROOMSTATUS.DISCONNECTED))}e.api.listen.on("beforeTearDown",()=>{e.chatboxes.where({type:e.CHATROOMS_TYPE}).forEach(e=>mt.safeSave(e,{connection_status:Ze.ROOMSTATUS.DISCONNECTED}))}),e.api.listen.on("addClientFeatures",()=>{e.allow_muc&&e.api.disco.own.features.add(vt.NS.MUC),e.allow_muc_invitations&&e.api.disco.own.features.add("jabber:x:conference")}),e.api.listen.on("chatBoxesFetched",function(){e.auto_join_rooms.forEach(t=>{if(At.isString(t)){if(e.chatboxes.where({jid:t}).length)return;e.api.rooms.open(t)}else At.isObject(t)?e.api.rooms.open(t.jid,At.clone(t)):e.log('Invalid groupchat criteria specified for "auto_join_rooms"',vt.LogLevel.ERROR)}),e.api.trigger("roomsAutoJoined")}),e.api.listen.on("disconnected",o),e.api.listen.on("statusInitialized",()=>{window.addEventListener(e.unloadevent,()=>{!e.api.connection.isType("websocket")||e.enable_smacks&&e.session.get("smacks_stream_id")||o()})}),Object.assign(e.api,{rooms:{create(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(n=At.isString(n)?{nick:n}:n||{}).nick&&e.muc_nickname_from_jid&&(n.nick=vt.getNodeFromJid(e.bare_jid)),void 0===t)throw new TypeError("rooms.create: You need to provide at least one JID");return At.isString(t)?s(t,n):t.map(e=>s(e,n))},async open(t,n){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(await e.api.waitUntil("chatBoxesFetched"),void 0===t){const t="rooms.open: You need to provide at least one JID";throw e.log(t,vt.LogLevel.ERROR),new TypeError(t)}if(At.isString(t)){const i=e.api.rooms.create(t,n);return i&&i.maybeShow(r),i}return t.map(t=>e.api.rooms.create(t,n).maybeShow(r))},get(t,n,i){if(At.isString(n)?n={nick:n}:void 0===n&&(n={}),void 0===t){const t=[];return e.chatboxes.each(function(n){n.get("type")===e.CHATROOMS_TYPE&&t.push(n)}),t}return n.nick||(n.nick=vt.getNodeFromJid(e.bare_jid)),At.isString(t)?r(t,n):t.map(e=>r(e,n))}}})}});const{Backbone:jt,Strophe:Nt,$iq:Ct,sizzle:Ot,_:Tt}=Ze.env,Rt=Ze.env.utils;Ze.plugins.add("converse-bookmarks",{dependencies:["converse-chatboxes","converse-muc"],overrides:{ChatRoom:{getDisplayName(){const{_converse:e}=this.__super__;if(this.get("bookmarked")&&e.bookmarks){const t=e.bookmarks.findWhere({jid:this.get("jid")});if(t)return t.get("name")}return this.__super__.getDisplayName.apply(this,arguments)},getAndPersistNickname(e){const{_converse:t}=this.__super__;return e=e||t.getNicknameFromBookmark(this.get("jid")),this.__super__.getAndPersistNickname.call(this,e)}}},initialize(){const{_converse:e}=this,{__:t}=e;e.api.settings.update({allow_bookmarks:!0,allow_public_bookmarks:!1}),e.api.promises.add("bookmarksInitialized"),e.getNicknameFromBookmark=function(t){if(!e.bookmarks||!e.allow_bookmarks)return null;const n=e.bookmarks.findWhere({jid:t});return n?n.get("nick"):void 0},e.Bookmark=jt.Model,e.Bookmarks=e.Collection.extend({model:e.Bookmark,comparator:e=>e.get("name").toLowerCase(),initialize(){this.on("add",Tt.flow(this.openBookmarkedRoom,this.markRoomAsBookmarked)),this.on("remove",this.markRoomAsUnbookmarked,this),this.on("remove",this.sendBookmarkStanza,this);const t=e.config.get("storage"),n="converse.room-bookmarks".concat(e.bare_jid);this.fetched_flag=n+"fetched",this.browserStorage=new i.a[t](n)},openBookmarkedRoom(t){if(e.muc_respect_autojoin&&t.get("autojoin")){e.api.rooms.create(t.get("jid"),t.get("nick")).maybeShow()}return t},fetchBookmarks(){const e=Rt.getResolveablePromise();return this.browserStorage.records.length>0?this.fetch({success:()=>e.resolve(),error:()=>e.resolve()}):window.sessionStorage.getItem(this.fetched_flag)?e.resolve():this.fetchBookmarksFromServer(e),e},createBookmark(e){this.create(e),this.sendBookmarkStanza().catch(t=>this.onBookmarkError(t,e))},sendBookmarkStanza(){const t=Ct({type:"set",from:e.connection.jid}).c("pubsub",{xmlns:Nt.NS.PUBSUB}).c("publish",{node:"storage:bookmarks"}).c("item",{id:"current"}).c("storage",{xmlns:"storage:bookmarks"});return this.forEach(e=>{t.c("conference",{name:e.get("name"),autojoin:e.get("autojoin"),jid:e.get("jid")}).c("nick").t(e.get("nick")).up().up()}),t.up().up().up(),t.c("publish-options").c("x",{xmlns:Nt.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t("http://jabber.org/protocol/pubsub#publish-options").up().up().c("field",{var:"pubsub#persist_items"}).c("value").t("true").up().up().c("field",{var:"pubsub#access_model"}).c("value").t("whitelist"),e.api.sendIQ(t)},onBookmarkError(n,r){e.log("Error while trying to add bookmark",Nt.LogLevel.ERROR),e.log(n),e.api.alert.show(Nt.LogLevel.ERROR,t("Error"),[t("Sorry, something went wrong while trying to save your bookmark.")]),this.findWhere({jid:r.jid}).destroy()},fetchBookmarksFromServer(t){const n=Ct({from:e.connection.jid,type:"get"}).c("pubsub",{xmlns:Nt.NS.PUBSUB}).c("items",{node:"storage:bookmarks"});e.api.sendIQ(n).then(e=>this.onBookmarksReceived(t,e)).catch(e=>this.onBookmarksReceivedError(t,e))},markRoomAsBookmarked(t){const n=e.chatboxes.get(t.get("jid"));void 0!==n&&n.save("bookmarked",!0)},markRoomAsUnbookmarked(t){const n=e.chatboxes.get(t.get("jid"));void 0!==n&&n.save("bookmarked",!1)},createBookmarksFromStanza(e){const t=Ot('items[node="storage:bookmarks"] item storage[xmlns="storage:bookmarks"] conference',e);Tt.forEach(t,e=>{const t=e.getAttribute("jid");this.create({jid:t,name:e.getAttribute("name")||t,autojoin:"true"===e.getAttribute("autojoin"),nick:Tt.get(e.querySelector("nick"),"textContent")})})},onBookmarksReceived(e,t){if(this.createBookmarksFromStanza(t),void 0!==e)return e.resolve()},onBookmarksReceivedError(t,n){if(window.sessionStorage.setItem(this.fetched_flag,!0),e.log("Error while fetching bookmarks",Nt.LogLevel.ERROR),e.log(n.outerHTML,Nt.LogLevel.DEBUG),t)return n.querySelector('error[type="cancel"] item-not-found')?t.resolve():t.reject(new Error("Could not fetch bookmarks"))}}),e.BookmarksList=jt.Model.extend({defaults:{"toggle-state":e.OPENED}}),e.checkBookmarksSupport=async function(){const t=await e.api.disco.getIdentity("pubsub","pep",e.bare_jid);return e.allow_public_bookmarks?!!t:e.api.disco.supports(Nt.NS.PUBSUB+"#publish-options",e.bare_jid)};const n=async function(){e.allow_bookmarks&&await e.checkBookmarksSupport()&&(e.bookmarks=new e.Bookmarks,await e.bookmarks.fetchBookmarks(),e.api.trigger("bookmarksInitialized"))};e.api.listen.on("clearSession",()=>{void 0!==e.bookmarks&&(e.bookmarks.clearSession({silent:!0}),window.sessionStorage.removeItem(e.bookmarks.fetched_flag))}),e.api.listen.on("reconnected",n),e.api.listen.on("connected",async()=>{e.connection.addHandler(t=>{Ot('event[xmlns="'+Nt.NS.PUBSUB+'#event"] items[node="storage:bookmarks"]',t).length&&e.api.waitUntil("bookmarksInitialized").then(()=>e.bookmarks.createBookmarksFromStanza(t)).catch(t=>e.log(t,Nt.LogLevel.FATAL))},null,"message","headline",null,e.bare_jid),await Promise.all([e.api.waitUntil("chatBoxesFetched")]),n()})}});const Mt=T.Strophe,It=T.$build;Mt.Request=function(e,t,n,r){this.id=++Mt._requestId,this.xmlData=e,this.data=Mt.serialize(e),this.origFunc=t,this.func=t,this.rid=n,this.date=NaN,this.sends=r||0,this.abort=!1,this.dead=null,this.age=function(){if(!this.date)return 0;return(new Date-this.date)/1e3},this.timeDead=function(){if(!this.dead)return 0;return(new Date-this.dead)/1e3},this.xhr=this._newXHR()},Mt.Request.prototype={getResponse:function(){let e=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if("parsererror"===(e=this.xhr.responseXML.documentElement).tagName)throw Mt.error("invalid response received"),Mt.error("responseText: "+this.xhr.responseText),Mt.error("responseXML: "+Mt.serialize(this.xhr.responseXML)),new Error("parsererror")}else if(this.xhr.responseText){if(Mt.debug("Got responseText but no responseXML; attempting to parse it with DOMParser..."),!(e=(new DOMParser).parseFromString(this.xhr.responseText,"application/xml").documentElement))throw new Error("Parsing produced null node");if(e.querySelector("parsererror")){Mt.error("invalid response received: "+e.querySelector("parsererror").textContent),Mt.error("responseText: "+this.xhr.responseText);const t=new Error;throw t.name=Mt.ErrorCondition.BAD_FORMAT,t}}return e},_newXHR:function(){let e=null;return window.XMLHttpRequest?(e=new XMLHttpRequest).overrideMimeType&&e.overrideMimeType("text/xml; charset=utf-8"):window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP")),e.onreadystatechange=this.func.bind(null,this),e}},Mt.Bosh=function(e){this._conn=e,this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.hold=1,this.wait=60,this.window=5,this.errors=0,this.inactivity=null,this.lastResponseHeaders=null,this._requests=[]},Mt.Bosh.prototype={strip:null,_buildBody:function(){const e=It("body",{rid:this.rid++,xmlns:Mt.NS.HTTPBIND});return null!==this.sid&&e.attrs({sid:this.sid}),this._conn.options.keepalive&&this._conn._sessionCachingSupported()&&this._cacheSession(),e},_reset:function(){this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.errors=0,this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_connect:function(e,t,n){this.wait=e||this.wait,this.hold=t||this.hold,this.errors=0;const r=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":Mt.NS.BOSH});n&&r.attrs({route:n});const i=this._conn._connect_cb;this._requests.push(new Mt.Request(r.tree(),this._onRequestStateChange.bind(this,i.bind(this._conn)),r.tree().getAttribute("rid"))),this._throttledRequestHandler()},_attach:function(e,t,n,r,i,s,o){this._conn.jid=e,this.sid=t,this.rid=n,this._conn.connect_callback=r,this._conn.domain=Mt.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=i||this.wait,this.hold=s||this.hold,this.window=o||this.window,this._conn._changeConnectStatus(Mt.Status.ATTACHED,null)},_restore:function(e,t,n,r,i){const s=JSON.parse(window.sessionStorage.getItem("strophe-bosh-session"));if(!(null!=s&&s.rid&&s.sid&&s.jid&&(null==e||Mt.getBareJidFromJid(s.jid)===Mt.getBareJidFromJid(e)||null===Mt.getNodeFromJid(e)&&Mt.getDomainFromJid(s.jid)===e))){const e=new Error("_restore: no restoreable session.");throw e.name="StropheSessionError",e}this._conn.restored=!0,this._attach(s.jid,s.sid,s.rid,t,n,r,i)},_cacheSession:function(){this._conn.authenticated?this._conn.jid&&this.rid&&this.sid&&window.sessionStorage.setItem("strophe-bosh-session",JSON.stringify({jid:this._conn.jid,rid:this.rid,sid:this.sid})):window.sessionStorage.removeItem("strophe-bosh-session")},_connect_cb:function(e){const t=e.getAttribute("type");if(null!==t&&"terminate"===t){let t=e.getAttribute("condition");Mt.error("BOSH-Connection failed: "+t);const n=e.getElementsByTagName("conflict");return null!==t?("remote-stream-error"===t&&n.length>0&&(t="conflict"),this._conn._changeConnectStatus(Mt.Status.CONNFAIL,t)):this._conn._changeConnectStatus(Mt.Status.CONNFAIL,"unknown"),this._conn._doDisconnect(t),Mt.Status.CONNFAIL}this.sid||(this.sid=e.getAttribute("sid"));const n=e.getAttribute("requests");n&&(this.window=parseInt(n,10));const r=e.getAttribute("hold");r&&(this.hold=parseInt(r,10));const i=e.getAttribute("wait");i&&(this.wait=parseInt(i,10));const s=e.getAttribute("inactivity");s&&(this.inactivity=parseInt(s,10))},_disconnect:function(e){this._sendTerminate(e)},_doDisconnect:function(){this.sid=null,this.rid=Math.floor(4294967295*Math.random()),this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_emptyQueue:function(){return 0===this._requests.length},_callProtocolErrorHandlers:function(e){const t=this._getRequestStatus(e),n=this._conn.protocolErrorHandlers.HTTP[t];n&&n.call(this,t)},_hitError:function(e){this.errors++,Mt.warn("request errored, status: "+e+", number of errors: "+this.errors),this.errors>4&&this._conn._onDisconnectTimeout()},_no_auth_received:function(e){Mt.warn("Server did not yet offer a supported authentication mechanism. Sending a blank poll request."),e=e?e.bind(this._conn):this._conn._connect_cb.bind(this._conn);const t=this._buildBody();this._requests.push(new Mt.Request(t.tree(),this._onRequestStateChange.bind(this,e),t.tree().getAttribute("rid"))),this._throttledRequestHandler()},_onDisconnectTimeout:function(){this._abortAllRequests()},_abortAllRequests:function(){for(;this._requests.length>0;){const e=this._requests.pop();e.abort=!0,e.xhr.abort(),e.xhr.onreadystatechange=function(){}}},_onIdle:function(){const e=this._conn._data;if(this._conn.authenticated&&0===this._requests.length&&0===e.length&&!this._conn.disconnecting&&(Mt.debug("no requests during idle cycle, sending blank request"),e.push(null)),!this._conn.paused){if(this._requests.length<2&&e.length>0){const t=this._buildBody();for(let n=0;n<e.length;n++)null!==e[n]&&("restart"===e[n]?t.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":Mt.NS.BOSH}):t.cnode(e[n]).up());delete this._conn._data,this._conn._data=[],this._requests.push(new Mt.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"))),this._throttledRequestHandler()}if(this._requests.length>0){const e=this._requests[0].age();null!==this._requests[0].dead&&this._requests[0].timeDead()>Math.floor(Mt.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),e>Math.floor(Mt.TIMEOUT*this.wait)&&(Mt.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(Mt.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}}},_getRequestStatus:function(e,t){let n;if(4===e.xhr.readyState)try{n=e.xhr.status}catch(e){Mt.error("Caught an error while retrieving a request's status, reqStatus: "+n)}return void 0===n&&(n="number"==typeof t?t:0),n},_onRequestStateChange:function(e,t){if(Mt.debug("request id "+t.id+"."+t.sends+" state changed to "+t.xhr.readyState),t.abort)return void(t.abort=!1);if(4!==t.xhr.readyState)return;const n=this._getRequestStatus(t);if(this.lastResponseHeaders=t.xhr.getAllResponseHeaders(),this.disconnecting&&n>=400)return this._hitError(n),void this._callProtocolErrorHandlers(t);const r=n>0&&n<500,i=t.sends>this._conn.maxRetries;if((r||i)&&(this._removeRequest(t),Mt.debug("request id "+t.id+" should now be removed")),200===n){const n=this._requests[0]===t;(this._requests[1]===t||n&&this._requests.length>0&&this._requests[0].age()>Math.floor(Mt.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),this._conn.nextValidRid(Number(t.rid)+1),Mt.debug("request id "+t.id+"."+t.sends+" got 200"),e(t),this.errors=0}else 0===n||n>=400&&n<600||n>=12e3?(Mt.error("request id "+t.id+"."+t.sends+" error "+n+" happened"),this._hitError(n),this._callProtocolErrorHandlers(t),n>=400&&n<500&&(this._conn._changeConnectStatus(Mt.Status.DISCONNECTING,null),this._conn._doDisconnect())):Mt.error("request id "+t.id+"."+t.sends+" error "+n+" happened");r||i?i&&!this._conn.connected&&this._conn._changeConnectStatus(Mt.Status.CONNFAIL,"giving-up"):this._throttledRequestHandler()},_processRequest:function(e){let t=this._requests[e];const n=this._getRequestStatus(t,-1);if(t.sends>this._conn.maxRetries)return void this._conn._onDisconnectTimeout();const r=t.age(),i=!isNaN(r)&&r>Math.floor(Mt.TIMEOUT*this.wait),s=null!==t.dead&&t.timeDead()>Math.floor(Mt.SECONDARY_TIMEOUT*this.wait),o=4===t.xhr.readyState&&(n<1||n>=500);if((i||s||o)&&(s&&Mt.error(`Request ${this._requests[e].id} timed out (secondary), restarting`),t.abort=!0,t.xhr.abort(),t.xhr.onreadystatechange=function(){},this._requests[e]=new Mt.Request(t.xmlData,t.origFunc,t.rid,t.sends),t=this._requests[e]),0===t.xhr.readyState){Mt.debug("request id "+t.id+"."+t.sends+" posting");try{const e=this._conn.options.contentType||"text/xml; charset=utf-8";t.xhr.open("POST",this._conn.service,!this._conn.options.sync),void 0!==t.xhr.setRequestHeader&&t.xhr.setRequestHeader("Content-Type",e),this._conn.options.withCredentials&&(t.xhr.withCredentials=!0)}catch(e){return Mt.error("XHR open failed: "+e.toString()),this._conn.connected||this._conn._changeConnectStatus(Mt.Status.CONNFAIL,"bad-service"),void this._conn.disconnect()}const e=()=>{if(t.date=new Date,this._conn.options.customHeaders){const e=this._conn.options.customHeaders;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.xhr.setRequestHeader(n,e[n])}t.xhr.send(t.data)};if(t.sends>1){const n=1e3*Math.min(Math.floor(Mt.TIMEOUT*this.wait),Math.pow(t.sends,3));setTimeout(function(){e()},n)}else e();t.sends++,this._conn.xmlOutput!==Mt.Connection.prototype.xmlOutput&&(t.xmlData.nodeName===this.strip&&t.xmlData.childNodes.length?this._conn.xmlOutput(t.xmlData.childNodes[0]):this._conn.xmlOutput(t.xmlData)),this._conn.rawOutput!==Mt.Connection.prototype.rawOutput&&this._conn.rawOutput(t.data)}else Mt.debug("_processRequest: "+(0===e?"first":"second")+" request has readyState of "+t.xhr.readyState)},_removeRequest:function(e){Mt.debug("removing request");for(let t=this._requests.length-1;t>=0;t--)e===this._requests[t]&&this._requests.splice(t,1);e.xhr.onreadystatechange=function(){},this._throttledRequestHandler()},_restartRequest:function(e){const t=this._requests[e];null===t.dead&&(t.dead=new Date),this._processRequest(e)},_reqToData:function(e){try{return e.getResponse()}catch(e){if("parsererror"!==e.message)throw e;this._conn.disconnect("strophe-parsererror")}},_sendTerminate:function(e){Mt.debug("_sendTerminate was called");const t=this._buildBody().attrs({type:"terminate"});e&&t.cnode(e.tree());const n=new Mt.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"));this._requests.push(n),this._throttledRequestHandler()},_send:function(){clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout(()=>this._conn._onIdle(),100)},_sendRestart:function(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)},_throttledRequestHandler:function(){this._requests?Mt.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):Mt.debug("_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}};const{Backbone:kt,Strophe:Lt,_:Dt}=Ze.env,Ft="converse.bosh-session";Ze.plugins.add("converse-bosh",{initialize(){const{_converse:e}=this;e.api.settings.update({bosh_service_url:void 0,prebind_url:null}),e.startNewPreboundBOSHSession=function(){if(!e.prebind_url)throw new Error("attemptPreboundSession: If you use prebind then you MUST supply a prebind_url");const t=new XMLHttpRequest;t.open("GET",e.prebind_url,!0),t.setRequestHeader("Accept","application/json, text/javascript"),t.onload=function(){if(t.status>=200&&t.status<400){const n=JSON.parse(t.responseText);e.connection.attach(n.jid,n.sid,n.rid,e.onConnectStatusChanged)}else t.onerror()},t.onerror=function(){delete e.connection,e.api.trigger("noResumeableBOSHSession",e)},t.send()},e.restoreBOSHSession=async function(){if(!e.api.connection.isType("bosh"))return!1;const t=(await async function(){const t=Ft;return e.bosh_session||(e.bosh_session=new kt.Model({id:t}),e.bosh_session.browserStorage=new i.a.session(t),await new Promise(t=>e.bosh_session.fetch({success:t,error:t}))),e.jid&&e.bosh_session.get("jid")===e.jid&&(e.bosh_session.clear({silent:!0}),e.bosh_session.save({jid:e.jid,id:t})),e.bosh_session}()).get("jid");if(t)try{return e.connection.restore(t,e.onConnectStatusChanged),!0}catch(n){return e.log("Could not restore session for jid: "+t+" Error message: "+n.message,Lt.LogLevel.WARN),!1}return!1},e.api.listen.on("clearSession",()=>{if(void 0===e.bosh_session){const e=Ft;sessionStorage.removeItem(e),sessionStorage.removeItem("".concat(e,"-").concat(e))}else e.bosh_session.destroy(),e.bosh_session.browserStorage._clear(),delete e.bosh_session}),e.api.listen.on("setUserJID",()=>{void 0!==e.bosh_session&&e.bosh_session.save({jid:e.jid})}),e.api.listen.on("addClientFeatures",()=>e.api.disco.own.features.add(Lt.NS.BOSH)),Object.assign(e.api,{tokens:{get:t=>void 0===e.connection?null:"rid"===t.toLowerCase()?e.connection.rid||e.connection._proto.rid:"sid"===t.toLowerCase()?e.connection.sid||e.connection._proto.sid:void 0}})}});const{Strophe:Pt,$build:Ut,_:zt}=Ze.env;function Bt(e,t){return e.sort((e,n)=>e[t]>n[t]?-1:1)}function Ht(e){const t=e.api.disco.own.identities.get(),n=e.api.disco.own.features.get();t.length>1&&(Bt(t,"category"),Bt(t,"type"),Bt(t,"lang"));let r=zt.reduce(t,(e,t)=>"".concat(e).concat(t.category,"/").concat(t.type,"/").concat(zt.get(t,"lang",""),"/").concat(t.name,"<"),"");return n.sort(),r=zt.reduce(n,(e,t)=>"".concat(e).concat(t,"<"),r),x.b64_sha1(r)}Pt.addNamespace("CAPS","http://jabber.org/protocol/caps"),Ze.plugins.add("converse-caps",{overrides:{XMPPStatus:{constructPresence(){const e=this.__super__.constructPresence.apply(this,arguments);var t;return e.root().cnode((t=this.__super__._converse,Ut("c",{xmlns:Pt.NS.CAPS,hash:"sha-1",node:"https://conversejs.org",ver:Ht(t)}).nodeTree)),e}}}});var qt=n(2),$t=n(100),Gt=n.n($t);const{$msg:Wt,Backbone:Jt,Strophe:Yt,dayjs:Xt,sizzle:Vt,utils:Qt,_:Zt}=Ze.env,Kt=Ze.env.utils;Yt.addNamespace("MESSAGE_CORRECT","urn:xmpp:message-correct:0"),Yt.addNamespace("RECEIPTS","urn:xmpp:receipts"),Yt.addNamespace("REFERENCE","urn:xmpp:reference:0"),Yt.addNamespace("MARKERS","urn:xmpp:chat-markers:0"),Ze.plugins.add("converse-chatboxes",{dependencies:["converse-emoji","converse-roster","converse-vcard"],initialize(){const{_converse:e}=this,{__:t}=e;e.api.settings.update({auto_join_private_chats:[],clear_messages_on_reconnection:!1,filter_by_resource:!1,allow_message_corrections:"all",send_chat_state_notifications:!0}),e.api.promises.add(["chatBoxesFetched","chatBoxesInitialized","privateChatsAutoJoined"]),e.router.route("converse/chat?jid=:jid",function(t){if(!Qt.isValidJID(t))return e.log('Invalid JID "'.concat(t,'" provided in URL fragment'),Yt.LogLevel.WARN);e.api.chats.open(t)});const n=Jt.Model.extend({initialize(){this.rosterContactAdded=Kt.getResolveablePromise()},async setRosterContact(t){const n=await e.api.contacts.get(t);n&&(this.contact=n,this.set("nickname",n.get("nickname")),this.rosterContactAdded.resolve())}});e.Message=n.extend({defaults:()=>({msgid:e.connection.getUniqueId(),time:(new Date).toISOString(),ephemeral:!1}),initialize(){n.prototype.initialize.apply(this,arguments),"chat"===this.get("type")&&(this.setVCard(),this.setRosterContact(Yt.getBareJidFromJid(this.get("from")))),this.get("file")&&this.on("change:put",this.uploadFile,this),this.isEphemeral()&&window.setTimeout(this.safeDestroy.bind(this),1e4)},safeDestroy(){try{this.destroy()}catch(t){e.log(t,Yt.LogLevel.ERROR)}},setVCard(){if(e.vcards&&"error"!==this.get("type")){const t=Yt.getBareJidFromJid(this.get("from"));this.vcard=e.vcards.findWhere({jid:t})||e.vcards.create({jid:t})}},isOnlyChatStateNotification(){return Kt.isOnlyChatStateNotification(this)},isEphemeral(){return this.isOnlyChatStateNotification()||this.get("ephemeral")},getDisplayName(){return"groupchat"===this.get("type")?this.get("nick"):this.contact?this.contact.getDisplayName():this.vcard?this.vcard.getDisplayName():this.get("from")},getMessageText(){return this.get("is_encrypted")?this.get("plaintext")||(e.debug?t("Unencryptable OMEMO message"):null):this.get("message")},isMeCommand(){const e=this.getMessageText();return!!e&&e.startsWith("/me ")},sendSlotRequestStanza(){if(!this.file)return Promise.reject(new Error("file is undefined"));const t=Ze.env.$iq({from:e.jid,to:this.get("slot_request_url"),type:"get"}).c("request",{xmlns:Yt.NS.HTTPUPLOAD,filename:this.file.name,size:this.file.size,"content-type":this.file.type});return e.api.sendIQ(t)},async getRequestSlotURL(){let n;try{n=await this.sendSlotRequestStanza()}catch(n){return e.log(n,Yt.LogLevel.ERROR),this.save({type:"error",message:t("Sorry, could not determine upload URL."),ephemeral:!0})}const r=n.querySelector("slot");if(!r)return this.save({type:"error",message:t("Sorry, could not determine file upload URL."),ephemeral:!0});this.save({get:r.querySelector("get").getAttribute("url"),put:r.querySelector("put").getAttribute("url")})},uploadFile(){const n=new XMLHttpRequest;n.onreadystatechange=()=>{n.readyState===XMLHttpRequest.DONE&&(e.log("Status: "+n.status,Yt.LogLevel.INFO),200===n.status||201===n.status?this.save({upload:e.SUCCESS,oob_url:this.get("get"),message:this.get("get")}):n.onerror())},n.upload.addEventListener("progress",e=>{e.lengthComputable&&this.set("progress",e.loaded/e.total)},!1),n.onerror=()=>{let r;r=n.responseText?t('Sorry, could not succesfully upload your file. Your server’s response: "%1$s"',n.responseText):t("Sorry, could not succesfully upload your file."),this.save({type:"error",upload:e.FAILURE,message:r,ephemeral:!0})},n.open("PUT",this.get("put"),!0),n.setRequestHeader("Content-type",this.file.type),n.send(this.file)}}),e.Messages=e.Collection.extend({model:e.Message,comparator:"time"}),e.ChatBox=n.extend({messagesCollection:e.Messages,defaults(){return{bookmarked:!1,chat_state:void 0,hidden:["mobile","fullscreen"].includes(e.view_mode),message_type:"chat",nickname:void 0,num_unread:0,time_sent:new Date(0).toISOString(),time_opened:this.get("time_opened")||(new Date).getTime(),type:e.PRIVATE_CHAT_TYPE,url:""}},initialize(){n.prototype.initialize.apply(this,arguments);const t=this.get("jid");t&&(this.set({box_id:"box-".concat(btoa(t))}),e.vcards&&(this.vcard=e.vcards.findWhere({jid:t})||e.vcards.create({jid:t})),this.get("type")===e.PRIVATE_CHAT_TYPE&&(this.presence=e.presences.findWhere({jid:t})||e.presences.create({jid:t}),this.setRosterContact(t)),this.on("change:chat_state",this.sendChatState,this),this.initMessages(),this.fetchMessages())},getMessagesCacheKey(){return"converse.messages-".concat(this.get("jid"),"-").concat(e.bare_jid)},initMessages(){this.messages=new this.messagesCollection;const t=e.config.get("storage");this.messages.browserStorage=new i.a[t](this.getMessagesCacheKey()),this.messages.chatbox=this,this.listenTo(this.messages,"change:upload",t=>{t.get("upload")===e.SUCCESS&&e.api.send(this.createMessageStanza(t))})},afterMessagesFetched(){e.api.trigger("afterMessagesFetched",this)},fetchMessages(){if(this.messages.fetched)return void e.log("Not re-fetching messages for ".concat(this.get("jid")),Yt.LogLevel.INFO);this.messages.fetched=Kt.getResolveablePromise();const t=this.messages.fetched.resolve;return this.messages.fetch({add:!0,success:()=>{this.afterMessagesFetched(),t()},error:()=>{this.afterMessagesFetched(),t()}}),this.messages.fetched},clearMessages(){try{this.messages.models.forEach(e=>e.destroy()),this.messages.reset()}catch(t){this.messages.trigger("reset"),e.log(t,Yt.LogLevel.ERROR)}finally{delete this.messages.fetched,this.messages.browserStorage._clear()}},close(){try{this.destroy()}catch(t){e.log(t,Yt.LogLevel.ERROR)}finally{e.clear_messages_on_reconnection&&this.clearMessages()}},announceReconnection(){e.api.trigger("chatReconnected",this)},onReconnection(){e.clear_messages_on_reconnection&&this.clearMessages(),this.announceReconnection()},validate(t,n){if(!t.jid)return"Ignored ChatBox without JID";const r=e.auto_join_rooms.map(e=>Object(qt.isObject)(e)?e.jid:e),i=e.auto_join_private_chats.concat(r);if(e.singleton&&!i.includes(t.jid)&&!e.auto_join_on_invite){const n="".concat(t.jid," is not allowed because singleton is true and it's not being auto_joined");return e.log(n,Yt.LogLevel.WARN),n}},getDisplayName(){return this.contact?this.contact.getDisplayName():this.vcard?this.vcard.getDisplayName():this.get("jid")},createMessageFromError(t){if(t instanceof e.TimeoutError){this.messages.create({type:"error",message:t.message,retry:!0}).error=t}},getOldestMessage(){for(let e=0;e<this.messages.length;e++){const t=this.messages.at(e);if(t.get("type")===this.get("message_type"))return t}},getMostRecentMessage(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages.at(e);if(t.get("type")===this.get("message_type"))return t}},getUpdatedMessageAttributes:(e,t)=>({}),updateMessage(e,t){const n=this.getUpdatedMessageAttributes(e,t);n&&e.save(n)},setChatState(t,n){return void 0!==this.chat_state_timeout&&(window.clearTimeout(this.chat_state_timeout),delete this.chat_state_timeout),t===e.COMPOSING?this.chat_state_timeout=window.setTimeout(this.setChatState.bind(this),e.TIMEOUTS.PAUSED,e.PAUSED):t===e.PAUSED&&(this.chat_state_timeout=window.setTimeout(this.setChatState.bind(this),e.TIMEOUTS.INACTIVE,e.INACTIVE)),this.set("chat_state",t,n),this},shouldShowErrorMessage(e){const t=e.getAttribute("id");if(t){const n=this.messages.where({msgid:t});if(!n.filter(e=>"error"!==e.get("type")).length&&null===e.querySelector("body"))return;if(n.filter(e=>"error"===e.get("type")).length)return}return!0},getReplaceId(e){const t=Vt('replace[xmlns="'.concat(Yt.NS.MESSAGE_CORRECT,'"]'),e).pop();if(t)return t.getAttribute("id")},correctMessage(e){if(!e.replaced_id||!e.from)return;const t=this.messages.findWhere({msgid:e.replaced_id,from:e.from});if(!t)return;const n=t.get("older_versions")||{};return e.time<t.get("time")&&t.get("edited")?(n[e.time]=e.message,t.save({older_versions:n})):(n[t.get("time")]=t.get("message"),delete(e=Object.assign(e,{older_versions:n})).id,t.save(e)),t},async getDuplicateMessage(e){return this.findDuplicateFromOriginID(e)||await this.findDuplicateFromStanzaID(e)||this.findDuplicateFromMessage(e)},findDuplicateFromOriginID(e){const t=Vt('origin-id[xmlns="'.concat(Yt.NS.SID,'"]'),e).pop();return t?this.messages.findWhere({origin_id:t.getAttribute("id"),from:e.getAttribute("from")}):null},async findDuplicateFromStanzaID(t){const n=Vt('stanza-id[xmlns="'.concat(Yt.NS.SID,'"]'),t).pop();if(!n)return!1;const r=n.getAttribute("by");if(!await e.api.disco.supports(Yt.NS.SID,r))return!1;const i={};return i["stanza_id ".concat(r)]=n.getAttribute("id"),this.messages.findWhere(i)},findDuplicateFromMessage(e){const t=this.getMessageBody(e)||void 0;if(!t)return!1;const n=e.getAttribute("id");return!!n&&this.messages.findWhere({message:t,from:e.getAttribute("from"),msgid:n})},sendMarker(t,n,r){const i=Wt({from:e.connection.jid,id:e.connection.getUniqueId(),to:t,type:"chat"}).c(r,{xmlns:Yt.NS.MARKERS,id:n});e.api.send(i)},handleChatMarker(t,n,r,i,s){if(Yt.getBareJidFromJid(t.getAttribute("to"))!==e.bare_jid)return!1;const o=Vt('[xmlns="'.concat(Yt.NS.MARKERS,'"]'),t);if(0===o.length)return!1;if(o.length>1)return e.log("handleChatMarker: Ignoring incoming stanza with multiple message markers",Yt.LogLevel.ERROR),e.log(t,Yt.LogLevel.ERROR),!1;{const e=o.pop();if("markable"===e.nodeName)return!i||r||s||this.sendMarker(n,t.getAttribute("id"),"received"),!1;{const t=e&&e.getAttribute("id"),n=t&&this.messages.findWhere({msgid:t}),r="marker_".concat(e.nodeName);return n&&!n.get(r)&&n.save({field_name:(new Date).toISOString()}),!0}}},sendReceiptStanza(t,n){const r=Wt({from:e.connection.jid,id:e.connection.getUniqueId(),to:t,type:"chat"}).c("received",{xmlns:Yt.NS.RECEIPTS,id:n}).up().c("store",{xmlns:Yt.NS.HINTS}).up();e.api.send(r)},handleReceipt(t,n,r,i,s){if(!(void 0!==Vt('request[xmlns="'.concat(Yt.NS.RECEIPTS,'"]'),t).pop())||r||i||this.sendReceiptStanza(n,t.getAttribute("id")),Yt.getBareJidFromJid(t.getAttribute("to"))===e.bare_jid){const e=Vt('received[xmlns="'.concat(Yt.NS.RECEIPTS,'"]'),t).pop();if(e){const t=e&&e.getAttribute("id"),n=t&&this.messages.findWhere({msgid:t});return n&&!n.get("received")&&n.save({received:(new Date).toISOString()}),!0}}return!1},createMessageStanza(t){const n=Wt({from:e.connection.jid,to:this.get("jid"),type:this.get("message_type"),id:t.get("edited")&&e.connection.getUniqueId()||t.get("msgid")}).c("body").t(t.get("message")).up().c(e.ACTIVE,{xmlns:Yt.NS.CHATSTATES}).root();return"chat"===t.get("type")&&n.c("request",{xmlns:Yt.NS.RECEIPTS}).root(),t.get("is_spoiler")&&(t.get("spoiler_hint")?n.c("spoiler",{xmlns:Yt.NS.SPOILER},t.get("spoiler_hint")).root():n.c("spoiler",{xmlns:Yt.NS.SPOILER}).root()),(t.get("references")||[]).forEach(e=>{const t={xmlns:Yt.NS.REFERENCE,begin:e.begin,end:e.end,type:e.type};e.uri&&(t.uri=e.uri),n.c("reference",t).root()}),t.get("oob_url")&&n.c("x",{xmlns:Yt.NS.OUTOFBAND}).c("url").t(t.get("oob_url")).root(),t.get("edited")&&n.c("replace",{xmlns:Yt.NS.MESSAGE_CORRECT,id:t.get("msgid")}).root(),t.get("origin_id")&&n.c("origin-id",{xmlns:Yt.NS.SID,id:t.get("origin_id")}).root(),n},getOutgoingMessageAttributes(t,n){const r=this.get("composing_spoiler"),i=e.connection.getUniqueId();return{id:i,jid:this.get("jid"),nickname:this.get("nickname"),msgid:i,origin_id:i,fullname:e.xmppstatus.get("fullname"),from:e.bare_jid,is_single_emoji:!!t&&Kt.isSingleEmoji(t),sender:"me",time:(new Date).toISOString(),message:t?Kt.httpToGeoUri(Kt.shortnameToUnicode(t),e):void 0,is_spoiler:r,spoiler_hint:r?n:void 0,type:this.get("message_type")}},setEditable(t,n,r){if(!(r&&Kt.isHeadlineMessage(e,r)||Kt.isEmptyMessage(t)||"me"!==t.sender))if("all"===e.allow_message_corrections)t.editable=!0;else if("last"===e.allow_message_corrections&&n>this.get("time_sent")){this.set({time_sent:n});const e=this.messages.findWhere({editable:!0});e&&e.save({editable:!1}),t.editable=!0}},sendMessage(t,n){const r=this.getOutgoingMessageAttributes(t,n);let i=this.messages.findWhere("correcting");if(i){const t=i.get("older_versions")||{};t[i.get("time")]=i.get("message"),i.save({correcting:!1,edited:(new Date).toISOString(),message:r.message,older_versions:t,references:r.references,is_single_emoji:!!r.message&&Kt.isSingleEmoji(r.message),origin_id:e.connection.getUniqueId(),received:void 0})}else this.setEditable(r,(new Date).toISOString()),i=this.messages.create(r);return e.api.send(this.createMessageStanza(i)),i},sendChatState(){if(e.send_chat_state_notifications&&this.get("chat_state")){const t=e.send_chat_state_notifications;if(Array.isArray(t)&&!t.includes(this.get("chat_state")))return;e.api.send(Wt({id:e.connection.getUniqueId(),to:this.get("jid"),type:"chat"}).c(this.get("chat_state"),{xmlns:Yt.NS.CHATSTATES}).up().c("no-store",{xmlns:Yt.NS.HINTS}).up().c("no-permanent-store",{xmlns:Yt.NS.HINTS}))}},async sendFiles(n){const r=(await e.api.disco.features.get(Yt.NS.HTTPUPLOAD,e.domain)).pop();if(!r)return void this.messages.create({message:t("Sorry, looks like file upload is not supported by your server."),type:"error",ephemeral:!0});const i=r.dataforms.where({FORM_TYPE:{value:Yt.NS.HTTPUPLOAD,type:"hidden"}}).pop(),s=window.parseInt(Object(qt.get)(i,"attributes.max-file-size.value")),o=Object(qt.get)(r,"id");o?Array.from(n).forEach(e=>{if(!window.isNaN(s)&&window.parseInt(e.size)>s)return this.messages.create({message:t("The size of your file, %1$s, exceeds the maximum allowed by your server, which is %2$s.",e.name,Gt()(s)),type:"error",ephemeral:!0});{const t=this.messages.create(Object.assign(this.getOutgoingMessageAttributes(),{file:!0,progress:0,slot_request_url:o}),{silent:!0});t.file=e,this.messages.trigger("add",t),t.getRequestSlotURL()}}):this.messages.create({message:t("Sorry, looks like file upload is not supported by your server."),type:"error",ephemeral:!0})},getReferencesFromStanza(e){const t=Object(qt.propertyOf)(e.querySelector("body"))("textContent");return Vt('reference[xmlns="'.concat(Yt.NS.REFERENCE,'"]'),e).map(e=>{const n=e.getAttribute("begin"),r=e.getAttribute("end");return{begin:n,end:r,type:e.getAttribute("type"),value:t.slice(n,r),uri:e.getAttribute("uri")}})},getStanzaIDs(e){const t={},n=Vt('stanza-id[xmlns="'.concat(Yt.NS.SID,'"]'),e);n.length&&n.forEach(e=>t["stanza_id ".concat(e.getAttribute("by"))]=e.getAttribute("id"));const r=Vt('message > result[xmlns="'.concat(Yt.NS.MAM,'"]'),e).pop();if(r){const n=e.getAttribute("from");t["stanza_id ".concat(n)]=r.getAttribute("id")}const i=Vt('origin-id[xmlns="'.concat(Yt.NS.SID,'"]'),e).pop();return i&&(t.origin_id=i.getAttribute("id")),t},isArchived:e=>!!Vt('result[xmlns="'.concat(Yt.NS.MAM,'"]'),e).pop(),getErrorMessage(e){const n=e.querySelector("error");return Object(qt.propertyOf)(n.querySelector("text"))("textContent")||t("Sorry, an error occurred:")+" "+n.innerHTML},getMessageBody(e){if("error"===e.getAttribute("type"))return this.getErrorMessage(e);{const t=e.querySelector("body");if(t)return t.textContent.trim()}},async getMessageAttributesFromStanza(t,n){const r=Vt('spoiler[xmlns="'.concat(Yt.NS.SPOILER,'"]'),n).pop(),i=Vt('delay[xmlns="'.concat(Yt.NS.DELAY,'"]'),n).pop(),s=this.getMessageBody(t)||void 0,o=t.getElementsByTagName(e.COMPOSING).length&&e.COMPOSING||t.getElementsByTagName(e.PAUSED).length&&e.PAUSED||t.getElementsByTagName(e.INACTIVE).length&&e.INACTIVE||t.getElementsByTagName(e.ACTIVE).length&&e.ACTIVE||t.getElementsByTagName(e.GONE).length&&e.GONE,a=this.getReplaceId(t),c=a||t.getAttribute("id")||n.getAttribute("id"),u=Object.assign({chat_state:o,is_archived:this.isArchived(n),is_delayed:!!i,is_single_emoji:!!s&&await Kt.isSingleEmoji(s),is_spoiler:!!r,message:s,msgid:c,replaced_id:a,references:this.getReferencesFromStanza(t),subject:Object(qt.propertyOf)(t.querySelector("subject"))("textContent"),thread:Object(qt.propertyOf)(t.querySelector("thread"))("textContent"),time:i?Xt(i.getAttribute("stamp")).toISOString():(new Date).toISOString(),type:t.getAttribute("type")},this.getStanzaIDs(n));return"groupchat"===u.type?(u.from=t.getAttribute("from"),u.nick=Yt.unescapeNode(Yt.getResourceFromJid(u.from)),u.sender=u.nick===this.get("nick")?"me":"them",u.received=(new Date).toISOString()):(u.from=Yt.getBareJidFromJid(t.getAttribute("from")),u.from===e.bare_jid?(u.sender="me",u.fullname=e.xmppstatus.get("fullname")):(u.sender="them",u.fullname=this.get("fullname"))),Vt('x[xmlns="'.concat(Yt.NS.OUTOFBAND,'"]'),t).forEach(e=>{u.oob_url=e.querySelector("url").textContent,u.oob_desc=e.querySelector("url").textContent}),r&&(u.spoiler_hint=r.textContent.length>0?r.textContent:""),a&&(u.edited=(new Date).toISOString()),u.id=u.origin_id||u["stanza_id ".concat(u.from)]||e.connection.getUniqueId(),u},maybeShow(){return this.trigger("show")},isHidden(){return this.get("hidden")||this.get("minimized")||this.isScrolledUp()||"hidden"===e.windowState},incrementUnreadMsgCounter(t){t&&t.get("message")&&Qt.isNewMessage(t)&&this.isHidden()&&(this.save({num_unread:this.get("num_unread")+1}),e.incrementMsgCounter())},clearUnreadMsgCounter(){Kt.safeSave(this,{num_unread:0})},isScrolledUp(){return this.get("scrolled",!0)}}),e.ChatBoxes=e.Collection.extend({comparator:"time_opened",model:(t,n)=>new e.ChatBox(t,n),registerMessageHandler(){e.connection.addHandler(t=>Vt('message > result[xmlns="'.concat(Yt.NS.MAM,'"]'),t).pop()?(e.log('Received a MAM message with type "chat".',Yt.LogLevel.WARN),!0):(this.onMessage(t),!0),null,"message","chat"),e.connection.addHandler(e=>null!==e.getAttribute("type")||(this.onMessage(e),!0),Yt.NS.RECEIPTS,"message"),e.connection.addHandler(e=>(this.onErrorMessage(e),!0),null,"message","error")},onChatBoxesFetched(t){t.filter(e=>!e.isValid()).forEach(e=>e.destroy()),t.forEach(e=>e.maybeShow()),e.api.trigger("chatBoxesFetched")},onConnected(t){if(t)return;const n=e.config.get("storage");this.browserStorage=new i.a[n]("converse.chatboxes-".concat(e.bare_jid)),this.registerMessageHandler(),this.fetch({add:!0,success:e=>this.onChatBoxesFetched(e)})},async onErrorMessage(t){const n=Yt.getBareJidFromJid(t.getAttribute("from"));if(Qt.isSameBareJID(n,e.bare_jid))return;const r=this.getChatBox(n);if(!r)return;if(!await r.shouldShowErrorMessage(t))return;const i=await r.getMessageAttributesFromStanza(t,t);r.messages.create(i)},rejectMessage(t,n){e.api.send(Wt({to:t.getAttribute("from"),type:"error",id:t.getAttribute("id")}).c("error",{type:"cancel"}).c("not-allowed",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("text",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).t(n)),e.log("Rejecting message stanza with the following reason: ".concat(n),Yt.LogLevel.WARN),e.log(t,Yt.LogLevel.WARN)},async onMessage(t){const n=t;let r=t.getAttribute("to");const i=Yt.getResourceFromJid(r);if(e.filter_by_resource&&i&&i!==e.resource)return e.log("onMessage: Ignoring incoming message intended for a different resource: ".concat(r),Yt.LogLevel.INFO);if(Qt.isHeadlineMessage(e,t))return e.log("onMessage: Ignoring incoming headline message from JID: ".concat(t.getAttribute("from")),Yt.LogLevel.INFO);if(Vt('message > forwarded[xmlns="'.concat(Yt.NS.FORWARD,'"]'),t).length)return this.rejectMessage(t,"Forwarded messages not part of an encapsulating protocol are not supported");let s=t.getAttribute("from")||e.bare_jid;const o=Kt.isCarbonMessage(t);if(o){if(s!==e.bare_jid)return this.rejectMessage(t,"Rejecting carbon from invalid JID");{const e='[xmlns="'.concat(Yt.NS.CARBONS,'"] > forwarded[xmlns="').concat(Yt.NS.FORWARD,'"] > message');r=(t=Vt(e,t).pop()).getAttribute("to"),s=t.getAttribute("from")}}const a=Kt.isMAMMessage(t);if(a){if(s!==e.bare_jid)return e.log("onMessage: Ignoring alleged MAM message from ".concat(t.getAttribute("from")),Yt.LogLevel.WARN);{const e='[xmlns="'.concat(Yt.NS.MAM,'"] > forwarded[xmlns="').concat(Yt.NS.FORWARD,'"] > message');r=(t=Vt(e,t).pop()).getAttribute("to"),s=t.getAttribute("from")}}const c=Yt.getBareJidFromJid(s),u=c===e.bare_jid;if(u&&null===r)return e.log("Don't know how to handle message stanza without 'to' attribute. ".concat(t.outerHTML),Yt.LogLevel.ERROR);const l=u?Yt.getBareJidFromJid(r):c,d=await e.api.contacts.get(l),h=void 0!==d;if(!u&&!h&&!e.allow_non_roster_messaging)return;const f=Vt('body, encrypted[xmlns="'.concat(Yt.NS.OMEMO,'"]'),t).length>0,p=Object(qt.get)(d,"attributes.nickname"),g=this.getChatBox(l,{nickname:p},f);if(g){const e=await g.getDuplicateMessage(t);if(e&&g.updateMessage(e,n),!e&&!g.handleReceipt(t,s,o,u,a)&&!g.handleChatMarker(t,s,o,h,a)){const e=await g.getMessageAttributesFromStanza(t,n);if(g.setEditable(e,e.time,t),e.chat_state||!Kt.isEmptyMessage(e)){const t=g.correctMessage(e)||g.messages.create(e);g.incrementUnreadMsgCounter(t)}}}e.api.trigger("message",{stanza:n,chatbox:g})},getChatBox(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;Object(qt.isObject)(t)&&(r=n,t=(n=t).jid),t=Yt.getBareJidFromJid(t.toLowerCase());let i=this.get(Yt.getBareJidFromJid(t));if(i)i.save(n);else if(r&&(Object.assign(n,{jid:t,id:t}),!(i=this.create(n,{error(t,n){e.log(n.responseText)}})).isValid()))return i.destroy(),null;return i}}),e.api.listen.on("chatBoxesFetched",function(){e.auto_join_private_chats.forEach(t=>{e.chatboxes.where({jid:t}).length||(Object(qt.isString)(t)?e.api.chats.open(t):e.log('Invalid jid criteria specified for "auto_join_private_chats"',Yt.LogLevel.ERROR))}),e.api.trigger("privateChatsAutoJoined")}),e.api.listen.on("addClientFeatures",()=>{e.api.disco.own.features.add(Yt.NS.MESSAGE_CORRECT),e.api.disco.own.features.add(Yt.NS.HTTPUPLOAD),e.api.disco.own.features.add(Yt.NS.OUTOFBAND)}),e.api.listen.on("pluginsInitialized",()=>{e.chatboxes=new e.ChatBoxes,e.api.trigger("chatBoxesInitialized")}),e.api.listen.on("clearSession",()=>{e.shouldClearCache()&&e.chatboxes.filter(e=>e.messages&&e.messages.clearSession({silent:!0}))}),e.api.listen.on("presencesInitialized",t=>e.chatboxes.onConnected(t)),e.api.listen.on("reconnected",()=>e.chatboxes.forEach(e=>e.onReconnection())),Object.assign(e.api,{chats:{async create(t,n){if(Object(qt.isString)(t)){if(n&&!Object(qt.get)(n,"fullname")){const r=await e.api.contacts.get(t);n.fullname=Object(qt.get)(r,"attributes.fullname")}const r=e.chatboxes.getChatBox(t,n,!0);return r||void e.log("Could not open chatbox for JID: "+t,Yt.LogLevel.ERROR)}return Array.isArray(t)?Promise.all(t.forEach(async r=>{const i=await e.api.contacts.get(t);return n.fullname=Object(qt.get)(i,"attributes.fullname"),e.chatboxes.getChatBox(r,n,!0).maybeShow()})):(e.log("chats.create: You need to provide at least one JID",Yt.LogLevel.ERROR),null)},async open(t,n,r){if(await Promise.all([e.api.waitUntil("rosterContactsFetched"),e.api.waitUntil("chatBoxesFetched")]),Object(qt.isString)(t)){const i=await e.api.chats.create(t,n);return i?i.maybeShow(r):i}if(Array.isArray(t))return Promise.all(t.map(t=>e.api.chats.create(t,n).then(e=>e?e.maybeShow(r):null)).filter(e=>e));const i="chats.open: You need to provide at least one JID";throw e.log(i,Yt.LogLevel.ERROR),new Error(i)},get(t){if(void 0===t){const t=[];return e.chatboxes.each(function(n){n.get("type")!==e.CHATROOMS_TYPE&&t.push(n)}),t}return Object(qt.isString)(t)?e.chatboxes.getChatBox(t):t.map(t=>e.chatboxes.getChatBox(t,{},!0))}}})}});const{Strophe:en,$build:tn}=Ze.env;en.addNamespace("RSM","http://jabber.org/protocol/rsm"),Ze.plugins.add("converse-rsm",{initialize(){const{_converse:e}=this,t=["max","first","last","after","before","index","count"];e.RSM_ATTRIBUTES=t;class n{constructor(e){if(void 0!==e.xml)this.fromXMLElement(e.xml);else for(let n=0;n<t.length;n++){const r=t[n];this[r]=e[r]}}toXML(){let e=tn("set",{xmlns:en.NS.RSM});for(let n=0;n<t.length;n++){const r=t[n];void 0!==this[r]&&(e=e.c(r).t(this[r].toString()).up())}return e.tree()}next(e,t){return new n({max:e,after:this.last,before:t})}previous(e,t){return new n({max:e,before:this.first,after:t})}fromXMLElement(e){for(var n=0;n<t.length;n++){const r=t[n],i=e.getElementsByTagName(r)[0];null!=i&&(this[r]=en.getText(i),"first"==r&&(this.index=i.getAttribute("index")))}}}e.RSM=n}});const{Strophe:nn,$iq:rn,$build:sn,dayjs:on}=Ze.env,an=Ze.env.utils,cn=["with","start","end"];Ze.plugins.add("converse-mam",{dependencies:["converse-rsm","converse-disco","converse-muc"],overrides:{ChatBox:{async getDuplicateMessage(e){const t=await this.__super__.getDuplicateMessage.apply(this,arguments);return t||this.findDuplicateFromArchiveID(e)},getUpdatedMessageAttributes(e,t){const n=this.__super__.getUpdatedMessageAttributes.apply(this,arguments);return e&&!e.get("is_archived")?Object.assign(n,{is_archived:this.isArchived(t)},this.getStanzaIDs(t)):n}}},initialize(){const{_converse:e}=this;e.api.settings.update({archived_messages_page_size:"50",message_archiving:void 0,message_archiving_timeout:2e4});const t={fetchNewestMessages(){if(this.disable_mam)return;const e=this.getMostRecentMessage();if(e){const t=e.get("stanza_id ".concat(this.get("jid")));t?this.fetchArchivedMessages({after:t},"forwards"):this.fetchArchivedMessages({start:e.get("time")},"forwards")}else this.fetchArchivedMessages({before:""})},async fetchArchivedMessages(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(this.disable_mam)return;const r=this.get("type")===e.CHATROOMS_TYPE,i=r?this.get("jid"):e.bare_jid;if(!await e.api.disco.supports(nn.NS.MAM,i))return;const s=r?this.onMessage.bind(this):e.chatboxes.onMessage.bind(e.chatboxes),o=Object.assign({groupchat:r,max:e.archived_messages_page_size,with:this.get("jid")},t),a=await e.api.archive.query(o);for(const t of a.messages)try{await s(t)}catch(t){e.log(t,nn.LogLevel.ERROR)}return a.error&&(a.error.retry=()=>this.fetchArchivedMessages(t,n),this.createMessageFromError(a.error)),n&&a.rsm?("forwards"===n?t=a.rsm.next(e.archived_messages_page_size,t.before):"backwards"===n&&(t=a.rsm.previous(e.archived_messages_page_size,t.after)),this.fetchArchivedMessages(t,n)):void 0},async findDuplicateFromArchiveID(t){const n=Se()('result[xmlns="'.concat(nn.NS.MAM,'"]'),t).pop();if(!n)return null;const r=t.getAttribute("from")||this.get("jid");if(!await e.api.disco.supports(nn.NS.MAM,r))return null;const i={};return i["stanza_id ".concat(r)]=n.getAttribute("id"),this.messages.findWhere(i)}};Object.assign(e.ChatBox.prototype,t),Object.assign(e.ChatRoom.prototype,{fetchArchivedMessagesIfNecessary(){this.get("connection_status")===Ze.ROOMSTATUS.ENTERED&&this.get("mam_enabled")&&!this.get("mam_initialized")&&(this.fetchNewestMessages(),this.save({mam_initialized:!0}))}}),e.onMAMError=function(t){t.querySelectorAll("feature-not-implemented").length?e.log("Message Archive Management (XEP-0313) not supported by this server",nn.LogLevel.WARN):(e.log("An error occured while trying to set archiving preferences.",nn.LogLevel.ERROR),e.log(t))},e.onMAMPreferences=function(t,n){const r=Se()('prefs[xmlns="'.concat(nn.NS.MAM,'"]'),t).pop();if(r.getAttribute("default")!==e.message_archiving){const t=rn({type:"set"}).c("prefs",{xmlns:nn.NS.MAM,default:e.message_archiving});Array.from(r.children).forEach(e=>t.cnode(e).up()),e.api.sendIQ(t).then(()=>n.save({preferences:{default:e.message_archiving}})).catch(e.onMAMError)}else n.save({preferences:{default:e.message_archiving}})},e.api.listen.on("addClientFeatures",()=>e.api.disco.own.features.add(nn.NS.MAM)),e.api.listen.on("serviceDiscovered",function(t){const n=t.get("preferences")||{};t.get("var")===nn.NS.MAM&&void 0!==e.message_archiving&&n.default!==e.message_archiving&&e.api.sendIQ(rn({type:"get"}).c("prefs",{xmlns:nn.NS.MAM})).then(n=>e.onMAMPreferences(n,t)).catch(e.onMAMError)}),e.api.listen.on("enteredNewRoom",e=>e.fetchNewestMessages()),e.api.listen.on("chatReconnected",t=>{t.get("type")===e.PRIVATE_CHAT_TYPE&&t.fetchNewestMessages()}),e.api.listen.on("afterMessagesFetched",t=>{t.get("type")===e.PRIVATE_CHAT_TYPE&&void 0===t.get("chat_state")&&t.fetchNewestMessages()}),e.api.listen.on("chatRoomOpened",e=>{e.on("change:mam_enabled",e.fetchArchivedMessagesIfNecessary,e),e.on("change:connection_status",e.fetchArchivedMessagesIfNecessary,e)}),Object.assign(e.api,{archive:{async query(t){if(!e.api.connection.connected())throw new Error("Can't call `api.archive.query` before having established an XMPP session");const n={type:"set"};if(t&&t.groupchat){if(!t.with)throw new Error('You need to specify a "with" value containing the chat room JID, when querying groupchat messages.');n.to=t.with}const r=n.to||e.bare_jid;if(!await e.api.disco.supports(nn.NS.MAM,r))return e.log("Did not fetch MAM archive for ".concat(r," because it doesn't support ").concat(nn.NS.MAM)),{messages:[]};const i=e.connection.getUniqueId(),s=rn(n).c("query",{xmlns:nn.NS.MAM,queryid:i});t&&(s.c("x",{xmlns:nn.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t(nn.NS.MAM).up().up(),t.with&&!t.groupchat&&s.c("field",{var:"with"}).c("value").t(t.with).up().up(),["start","end"].forEach(e=>{if(t[e]){const n=on(t[e]);if(!n.isValid())throw new TypeError("archive.query: invalid date provided for: ".concat(e));s.c("field",{var:e}).c("value").t(n.toISOString()).up().up()}}),s.up(),t instanceof e.RSM?s.cnode(t.toXML()):Object(qt.intersection)(e.RSM_ATTRIBUTES,Object.keys(t)).length&&s.cnode(new e.RSM(t).toXML()));const o=[],a=e.connection.addHandler(n=>{const r=Se()('message > result[xmlns="'.concat(nn.NS.MAM,'"]'),n).pop();if(void 0===r||r.getAttribute("queryid")!==i)return!0;const s=n.getAttribute("from")||e.bare_jid;if(t.groupchat){if(s!==t.with)return e.log("Ignoring alleged groupchat MAM message from ".concat(n.getAttribute("from")),nn.LogLevel.WARN),!0}else if(s!==e.bare_jid)return e.log("Ignoring alleged MAM message from ".concat(n.getAttribute("from")),nn.LogLevel.WARN),!0;return o.push(n),!0},nn.NS.MAM);let c;const u=await e.api.sendIQ(s,e.message_archiving_timeout,!1);if(null===u){const t="Timeout while trying to fetch archived messages.";return e.log(t,nn.LogLevel.ERROR),c=new e.TimeoutError(t),{messages:o,error:c}}if(an.isErrorStanza(u))return e.log("Error stanza received while trying to fetch archived messages",nn.LogLevel.ERROR),e.log(u,nn.LogLevel.ERROR),{messages:o};let l;e.connection.deleteHandler(a);const d=u&&Se()('fin[xmlns="'.concat(nn.NS.MAM,'"]'),u).pop();if(d&&[null,"false"].includes(d.getAttribute("complete"))){const n=Se()('set[xmlns="'.concat(nn.NS.RSM,'"]'),d).pop();n&&(l=new e.RSM({xml:n}),Object.assign(l,Object.assign(Object(qt.pick)(t,[...cn,...e.RSM_ATTRIBUTES]),l)))}return{messages:o,rsm:l,error:c}}}})}});const{Strophe:un,$iq:ln,_:dn}=Ze.env,hn=Ze.env.utils;un.addNamespace("PING","urn:xmpp:ping"),Ze.plugins.add("converse-ping",{initialize(){const{_converse:e}=this;let t;function n(n){t=new Date;const r=n.getAttribute("from"),i=n.getAttribute("id"),s=ln({type:"result",to:r,id:i});return e.connection.sendIQ(s),!0}e.api.settings.update({ping_interval:60}),setTimeout(()=>{if(e.ping_interval>0){const n=new Date;return t||(t=n),!((n-t)/1e3>e.ping_interval)||e.api.ping()}},1e3);const r=function(){void 0!==e.connection.disco&&e.api.disco.own.features.add(un.NS.PING),e.connection.addHandler(n,un.NS.PING,"iq","get"),e.connection.addHandler(()=>{if(e.ping_interval>0)return t=new Date,!0})};e.api.listen.on("connected",r),e.api.listen.on("reconnected",r),Object.assign(e.api,{async ping(n){if(t=new Date,n=n||un.getDomainFromJid(e.bare_jid),e.connection){const t=ln({type:"get",to:n,id:e.connection.getUniqueId("ping")}).c("ping",{xmlns:un.NS.PING}),r=await e.api.sendIQ(t,1e4,!1);return null===r?(e.log("Timeout while pinging ".concat(n),un.LogLevel.WARN),n===un.getDomainFromJid(e.bare_jid)&&e.api.connection.reconnect()):hn.isErrorStanza(r)&&(e.log("Error while pinging ".concat(n),un.LogLevel.ERROR),e.log(r,un.LogLevel.ERROR)),!0}return!1}})}});const{Strophe:fn,Backbone:pn,$iq:gn,$build:mn,$msg:_n,$pres:vn,dayjs:bn,_:yn}=Ze.env;fn.addNamespace("PUBSUB_ERROR",fn.NS.PUBSUB+"#errors"),Ze.plugins.add("converse-pubsub",{dependencies:["converse-disco"],initialize(){const{_converse:e}=this,{__:t}=e;Object.assign(e.api,{pubsub:{async publish(t,n,r,i){let s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const o=gn({from:e.bare_jid,type:"set",to:t}).c("pubsub",{xmlns:fn.NS.PUBSUB}).c("publish",{node:n}).cnode(r.tree()).up().up();i&&(t=t||e.bare_jid,await e.api.disco.supports(fn.NS.PUBSUB+"#publish-options",t)?(o.c("publish-options").c("x",{xmlns:fn.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t("".concat(fn.NS.PUBSUB,"#publish-options")).up().up(),Object.keys(i).forEach(e=>o.c("field",{var:e}).c("value").t(i[e]).up().up())):e.log("_converse.api.publish: ".concat(t," does not support #publish-options, ")+"so we didn't set them even though they were provided."));try{e.api.sendIQ(o)}catch(t){if(!(t instanceof Element&&s&&t.querySelector('precondition-not-met[xmlns="'.concat(fn.NS.PUBSUB_ERROR,'"]'))))throw t;{const t=o.nodeTree;t.querySelector("publish-options").outerHTML="",e.log("PubSub: Republishing without publish options. ".concat(t.outerHTML),fn.LogLevel.WARN),e.api.sendIQ(t)}}}}})}});const{Backbone:Sn,Strophe:wn,$iq:xn,$pres:En,dayjs:An,sizzle:jn,_:Nn}=Ze.env,Cn=Ze.env.utils;Ze.plugins.add("converse-roster",{dependencies:[],initialize(){const{_converse:e}=this,{__:t}=e;e.api.settings.update({allow_contact_requests:!0,auto_subscribe:!1,synchronize_availability:!0}),e.api.promises.add(["cachedRoster","roster","rosterContactsFetched","rosterGroupsFetched","rosterInitialized"]),e.HEADER_CURRENT_CONTACTS=t("My contacts"),e.HEADER_PENDING_CONTACTS=t("Pending contacts"),e.HEADER_REQUESTING_CONTACTS=t("Contact requests"),e.HEADER_UNGROUPED=t("Ungrouped");const n={};n[e.HEADER_REQUESTING_CONTACTS]=0,n[e.HEADER_CURRENT_CONTACTS]=1,n[e.HEADER_UNGROUPED]=2,n[e.HEADER_PENDING_CONTACTS]=3,e.registerPresenceHandler=function(){e.unregisterPresenceHandler(),e.presence_ref=e.connection.addHandler(t=>(e.roster.presenceHandler(t),!0),null,"presence",null)},e.initRoster=function(){const t=e.config.get("storage");e.roster=new e.RosterContacts,e.roster.browserStorage=new i.a[t]("converse.contacts-".concat(e.bare_jid)),e.roster.data=new Sn.Model;const n="converse-roster-model-".concat(e.bare_jid);e.roster.data.id=n,e.roster.data.browserStorage=new i.a[t](n),e.roster.data.fetch(),e.rostergroups=new e.RosterGroups,e.rostergroups.browserStorage=new i.a[t]("converse.roster.groups".concat(e.bare_jid)),e.api.trigger("rosterInitialized")},e.populateRoster=async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t){e.send_initial_presence=!0;try{await e.roster.fetchFromServer(),e.api.trigger("rosterContactsFetched")}catch(t){e.log(t,wn.LogLevel.ERROR)}finally{e.sendInitialPresence()}}else try{await e.rostergroups.fetchRosterGroups(),e.api.trigger("rosterGroupsFetched"),await e.roster.fetchRosterContacts(),e.api.trigger("rosterContactsFetched")}catch(t){e.log(t,wn.LogLevel.ERROR)}finally{e.sendInitialPresence()}};const r=Sn.Model.extend({idAttribute:"name"}),s=e.Collection.extend({model:r});function o(t){const n=e.roster&&e.roster.findWhere({jid:t.get("jid")});void 0!==n&&n.save({num_unread:t.get("num_unread")})}function a(){e.presences&&(e.presences.forEach(e=>{e.resources.reject(e=>void 0===e).forEach(e=>e.destroy({silent:!0}))}),e.presences.clearSession())}e.Presence=Sn.Model.extend({defaults:{show:"offline"},initialize(){this.resources=new s;const e="converse.identities-".concat(this.get("jid"));this.resources.browserStorage=new i.a.session(e),this.listenTo(this.resources,"update",this.onResourcesChanged),this.listenTo(this.resources,"change",this.onResourcesChanged)},onResourcesChanged(){const e=this.getHighestPriorityResource(),t=Nn.get(e,"attributes.show","offline");this.get("show")!==t&&this.save({show:t})},getHighestPriorityResource(){return this.resources.sortBy(e=>"".concat(e.get("priority"),"-").concat(e.get("timestamp"))).reverse()[0]},addResource(e){const t=e.getAttribute("from"),n=wn.getResourceFromJid(t),r=jn('delay[xmlns="'.concat(wn.NS.DELAY,'"]'),e).pop(),i=Nn.propertyOf(e.querySelector("priority"))("textContent")||0,s=this.resources.get(n),o={name:n,priority:Nn.isNaN(parseInt(i,10))?0:parseInt(i,10),show:Nn.propertyOf(e.querySelector("show"))("textContent")||"online",timestamp:r?An(r.getAttribute("stamp")).toISOString():(new Date).toISOString()};s?s.save(o):this.resources.create(o)},removeResource(e){const t=this.resources.get(e);t&&t.destroy()}}),e.Presences=e.Collection.extend({model:e.Presence}),e.RosterContact=Sn.Model.extend({defaults:{chat_state:void 0,image:e.DEFAULT_IMAGE,image_type:e.DEFAULT_IMAGE_TYPE,num_unread:0,status:void 0},async initialize(t){this.setPresence();const{jid:n}=t,r=wn.getBareJidFromJid(n).toLowerCase();t.jid=r,this.set(Nn.assignIn({groups:[],id:r,jid:r,user_id:wn.getNodeFromJid(n)},t)),this.listenTo(this.presence,"change:show",()=>e.api.trigger("contactPresenceChanged",this)),this.listenTo(this.presence,"change:show",()=>this.trigger("presenceChanged")),await e.api.trigger("rosterContactInitialized",this,{Synchronous:!0})},setPresence(){const t=this.get("jid");this.presence=e.presences.findWhere({jid:t})||e.presences.create({jid:t})},getDisplayName(){return this.get("nickname")?this.get("nickname"):this.get("jid")},getFullname(){return this.get("jid")},subscribe(t){const n=En({to:this.get("jid"),type:"subscribe"});t&&""!==t&&n.c("status").t(t).up();const r=e.xmppstatus.getNickname()||e.xmppstatus.getFullname();return r&&n.c("nick",{xmlns:wn.NS.NICK}).t(r).up(),e.api.send(n),this.save("ask","subscribe"),this},ackSubscribe(){e.api.send(En({type:"subscribe",to:this.get("jid")}))},ackUnsubscribe(){e.api.send(En({type:"unsubscribe",to:this.get("jid")})),this.removeFromRoster(),this.destroy()},unauthorize(t){return e.rejectPresenceSubscription(this.get("jid"),t),this},authorize(t){const n=En({to:this.get("jid"),type:"subscribed"});return t&&""!==t&&n.c("status").t(t),e.api.send(n),this},removeFromRoster(){const t=xn({type:"set"}).c("query",{xmlns:wn.NS.ROSTER}).c("item",{jid:this.get("jid"),subscription:"remove"});return e.api.sendIQ(t)}}),e.RosterContacts=e.Collection.extend({model:e.RosterContact,comparator(t,n){const r=t.presence.get("show")||"offline",i=n.presence.get("show")||"offline";if(e.STATUS_WEIGHTS[r]===e.STATUS_WEIGHTS[i]){const e=t.getDisplayName().toLowerCase(),r=n.getDisplayName().toLowerCase();return e<r?-1:e>r?1:0}return e.STATUS_WEIGHTS[r]<e.STATUS_WEIGHTS[i]?-1:1},onConnected(){this.registerRosterHandler(),this.registerRosterXHandler()},registerRosterHandler(){e.connection.addHandler(t=>(e.roster.onRosterPush(t),!0),wn.NS.ROSTER,"iq","set")},registerRosterXHandler(){let t=0;e.connection.addHandler(function(n){return window.setTimeout(function(){e.connection.flush(),e.roster.subscribeToSuggestedItems.bind(e.roster)(n)},t),t+=250*n.querySelectorAll("item").length,!0},wn.NS.ROSTERX,"message",null)},async fetchRosterContacts(){let t;try{t=await new Promise((e,t)=>{this.fetch({add:!0,silent:!0,success:e,error:t})})}catch(t){e.log(t,wn.LogLevel.ERROR),e.session.set("roster_fetched",!1)}if(!e.session.get("roster_fetched"))return e.send_initial_presence=!0,e.roster.fetchFromServer();e.api.trigger("cachedRoster",t)},subscribeToSuggestedItems:t=>(Array.from(t.querySelectorAll("item")).forEach(t=>{"add"===t.getAttribute("action")&&e.roster.addAndSubscribe(t.getAttribute("jid"),e.xmppstatus.getNickname()||e.xmppstatus.getFullname())}),!0),isSelf:t=>Cn.isSameBareJID(t,e.connection.jid),addAndSubscribe(t,n,r,i,s){const o=t=>{t instanceof e.RosterContact&&t.subscribe(i)};this.addContactToRoster(t,n,r,s).then(o,o)},sendContactAddIQ(t,n,r){n=Nn.isEmpty(n)?null:n;const i=xn({type:"set"}).c("query",{xmlns:wn.NS.ROSTER}).c("item",{jid:t,name:n});return r.forEach(e=>i.c("group").t(e).up()),e.api.sendIQ(i)},async addContactToRoster(n,r,i,s){i=i||[];try{await this.sendContactAddIQ(n,r,i)}catch(i){return e.log(i,wn.LogLevel.ERROR),alert(t("Sorry, there was an error while trying to add %1$s as a contact.",r||n)),i}return this.create(Nn.assignIn({ask:void 0,nickname:r,groups:i,jid:n,requesting:!1,subscription:"none"},s),{sort:!1})},subscribeBack(t,n){const r=this.get(t);if(r instanceof e.RosterContact)r.authorize().subscribe();else{const r=t=>{t instanceof e.RosterContact&&t.authorize().subscribe()},i=Nn.get(jn('nick[xmlns="'.concat(wn.NS.NICK,'"]'),n).pop(),"textContent",null);this.addContactToRoster(t,i,[],{subscription:"from"}).then(r,r)}},getNumOnlineContacts(){let t=["offline","unavailable"];return e.show_only_online_users&&(t=Nn.union(t,["dnd","xa","away"])),Nn.sum(this.models.filter(e=>!Nn.includes(t,e.presence.get("show"))))},onRosterPush(t){const n=t.getAttribute("id"),r=t.getAttribute("from");if(r&&r!==e.bare_jid)return void e.log("Ignoring roster illegitimate roster push message from ".concat(t.getAttribute("from")),wn.LogLevel.WARN);e.api.send(xn({type:"result",id:n,from:e.connection.jid}));const i=jn('query[xmlns="'.concat(wn.NS.ROSTER,'"]'),t).pop();this.data.save("version",i.getAttribute("ver"));const s=jn("item",i);if(s.length>1)throw e.log(t,wn.LogLevel.ERROR),new Error('Roster push query may not contain more than one "item" element.');if(0===s.length)return e.log(t,wn.LogLevel.WARN),void e.log('Received a roster push stanza without an "item" element.',wn.LogLevel.WARN);this.updateContact(s.pop()),e.api.trigger("rosterPush",t)},rosterVersioningSupported(){return!(!e.api.disco.stream.getFeature("ver","urn:xmpp:features:rosterver")||!this.data.get("version"))},async fetchFromServer(){const t=xn({type:"get",id:e.connection.getUniqueId("roster")}).c("query",{xmlns:wn.NS.ROSTER});this.rosterVersioningSupported()&&t.attrs({ver:this.data.get("version")});const n=await e.api.sendIQ(t,null,!1);if("error"!==n.getAttribute("type")){const e=jn('query[xmlns="'.concat(wn.NS.ROSTER,'"]'),n).pop();if(e){jn("item",e).forEach(e=>this.updateContact(e)),this.data.save("version",e.getAttribute("ver"))}}else if(!Cn.isServiceUnavailableError(n))return e.log(n,wn.LogLevel.ERROR),e.log("Error while trying to fetch roster from the server",wn.LogLevel.ERROR);e.session.save("roster_fetched",!0),e.api.trigger("roster",n)},updateContact(e){const t=e.getAttribute("jid");if(this.isSelf(t))return;const n=this.get(t),r=e.getAttribute("subscription"),i=e.getAttribute("ask"),s=Nn.map(e.getElementsByTagName("group"),wn.getText);if(n){if("remove"===r)return n.destroy();n.save({subscription:r,ask:i,nickname:e.getAttribute("name"),requesting:null,groups:s})}else{if("none"===r&&null===i||"remove"===r)return;this.create({ask:i,nickname:e.getAttribute("name"),groups:s,jid:t,subscription:r},{sort:!1})}},createRequestingContact(t){const n={jid:wn.getBareJidFromJid(t.getAttribute("from")),subscription:"none",ask:null,requesting:!0,nickname:Nn.get(jn('nick[xmlns="'.concat(wn.NS.NICK,'"]'),t).pop(),"textContent",null)};e.api.trigger("contactRequest",this.create(n))},handleIncomingSubscription(n){const r=n.getAttribute("from"),i=wn.getBareJidFromJid(r),s=this.get(i);e.allow_contact_requests||e.rejectPresenceSubscription(r,t("This client does not allow presence subscriptions")),e.auto_subscribe?s&&"to"===s.get("subscription")?s.authorize():this.subscribeBack(i,n):s?"none"!==s.get("subscription")?s.authorize():"subscribe"===s.get("ask")&&s.authorize():this.createRequestingContact(n)},handleOwnPresence(t){const n=t.getAttribute("from"),r=wn.getResourceFromJid(n),i=t.getAttribute("type");if(e.connection.jid!==n&&"unavailable"!==i&&(!0===e.synchronize_availability||e.synchronize_availability===r)){const n=Nn.propertyOf(t.querySelector("show"))("textContent")||"online";e.xmppstatus.save({status:n},{silent:!0});const r=Nn.propertyOf(t.querySelector("status"))("textContent");r&&e.xmppstatus.save({status_message:r})}e.jid===n&&"unavailable"===i&&e.xmppstatus.sendPresence()},presenceHandler(e){const t=e.getAttribute("type");if("error"===t)return!0;const n=e.getAttribute("from"),r=wn.getBareJidFromJid(n);if(this.isSelf(r))return this.handleOwnPresence(e);if(jn('query[xmlns="'.concat(wn.NS.MUC,'"]'),e).length)return;const i=Nn.propertyOf(e.querySelector("status"))("textContent"),s=this.get(r);if(s&&i!==s.get("status")&&s.save({status:i}),"subscribed"===t&&s)s.ackSubscribe();else if("unsubscribed"===t&&s)s.ackUnsubscribe();else{if("unsubscribe"===t)return;if("subscribe"===t)this.handleIncomingSubscription(e);else if("unavailable"===t&&s){const e=wn.getResourceFromJid(n);s.presence.removeResource(e)}else s&&s.presence.addResource(e)}}}),e.RosterGroup=Sn.Model.extend({initialize(n){this.set(Nn.assignIn({description:t("Click to hide these contacts"),state:e.OPENED},n)),this.contacts=new e.RosterContacts}}),e.RosterGroups=e.Collection.extend({model:e.RosterGroup,comparator(t,r){t=t.get("name"),r=r.get("name");const i=Object.keys(n),s=Nn.includes(i,t),o=Nn.includes(i,r);return s||o?s&&o?n[t]<n[r]?-1:n[t]>n[r]?1:0:!s&&o?r===e.HEADER_REQUESTING_CONTACTS?1:-1:s&&!o?t===e.HEADER_REQUESTING_CONTACTS?-1:1:void 0:t.toLowerCase()<r.toLowerCase()?-1:t.toLowerCase()>r.toLowerCase()?1:0},fetchRosterGroups(){return new Promise(e=>{this.fetch({success:e,silent:!0})})}}),e.unregisterPresenceHandler=function(){void 0!==e.presence_ref&&(e.connection.deleteHandler(e.presence_ref),delete e.presence_ref)},e.api.listen.on("chatBoxesInitialized",()=>{e.chatboxes.on("change:num_unread",o),e.chatboxes.on("add",t=>{t.get("type")===e.PRIVATE_CHAT_TYPE&&t.setRosterContact(t.get("jid"))})}),e.api.listen.on("beforeTearDown",e.unregisterPresenceHandler()),e.api.waitUntil("rosterContactsFetched").then(()=>{e.roster.on("add",t=>{const n=e.chatboxes.findWhere({jid:t.get("jid")});n&&n.setRosterContact(t.get("jid"))})}),e.api.listen.on("clearSession",()=>{a(),e.shouldClearCache()&&(e.roster&&(Nn.invoke(e,"roster.data.destroy"),Nn.invoke(e,"roster.data.browserStorage._clear"),e.roster.clearSession(),delete e.roster),e.rostergroups&&(e.rostergroups.clearSession(),delete e.rostergroups))}),e.api.listen.on("statusInitialized",t=>{if(t)!e.haveResumed()&&a();else{e.presences=new e.Presences;const t="converse.presences-".concat(e.bare_jid);e.presences.browserStorage=new i.a.session(t),e.presences.fetch()}e.api.trigger("presencesInitialized",t)}),e.api.listen.on("presencesInitialized",t=>{t?e.api.trigger("rosterReadyAfterReconnection"):(e.registerIntervalHandler(),e.initRoster()),e.roster.onConnected(),e.registerPresenceHandler(),e.populateRoster(t)}),Object.assign(e.api,{contacts:{async get(t){await e.api.waitUntil("rosterContactsFetched");const n=t=>e.roster.get(wn.getBareJidFromJid(t));if(void 0===t)t=e.roster.pluck("jid");else if(Nn.isString(t))return n(t);return Nn.map(t,n)},add(t,n){if(!Nn.isString(t)||!Nn.includes(t,"@"))throw new TypeError("contacts.add: invalid jid");e.roster.addAndSubscribe(t,Nn.isEmpty(n)?t:n)}}})}});const{Strophe:On,$build:Tn,_:Rn}=Ze.env,Mn=Ze.env.utils;On.addNamespace("SM","urn:xmpp:sm:3"),Ze.plugins.add("converse-smacks",{initialize(){const{_converse:e}=this;function t(){return!(e.api.connection.isType("bosh")&&!e.isTestEnv())&&e.api.disco.stream.getFeature("sm",On.NS.SM)}function n(t){if(!e.session.get("smacks_enabled"))return!0;const n=parseInt(t.getAttribute("h"),10),r=e.session.get("num_stanzas_handled_by_server"),i=n-r;if(i<0){const t="New reported stanza count lower than previous. "+"New: ".concat(n," - Previous: ").concat(r);e.log(t,On.LogLevel.ERROR)}const s=e.session.get("unacked_stanzas");if(i>s.length){const t="Higher reported acknowledge count than unacknowledged stanzas. "+"Reported Acknowledged Count: ".concat(i," -")+"Unacknowledged Stanza Count: ".concat(s.length," -")+"New: ".concat(n," - Previous: ").concat(r);e.log(t,On.LogLevel.ERROR)}return e.session.save({num_stanzas_handled_by_server:n,num_stanzas_since_last_ack:0,unacked_stanzas:s.slice(i)}),!0}function r(){if(e.session.get("smacks_enabled")){const t=e.session.get("num_stanzas_handled"),n=Mn.toStanza('<a xmlns="'.concat(On.NS.SM,'" h="').concat(t,'"/>'));e.api.send(n)}return!0}function i(t){if(e.session.get("smacks_enabled")&&(Mn.isTagEqual(t,"iq")||Mn.isTagEqual(t,"presence")||Mn.isTagEqual(t,"message"))){const t=e.session.get("num_stanzas_handled");e.session.save("num_stanzas_handled",t+1)}return!0}function s(){e.session&&e.session.save({smacks_enabled:!1,num_stanzas_handled:0,num_stanzas_handled_by_server:0,num_stanzas_since_last_ack:0,unacked_stanzas:[]})}function o(t){const n={smacks_enabled:!0};return["1","true"].includes(t.getAttribute("resume"))&&(n.smacks_stream_id=t.getAttribute("id")),e.session.save(n),!0}function a(t){return t.querySelector("item-not-found")?e.log("Could not resume previous SMACKS session, session id not found. A new session will be established.",On.LogLevel.WARN):(e.log("Failed to enable stream management",On.LogLevel.ERROR),e.log(t.outerHTML,On.LogLevel.ERROR)),s(),!0}function c(t,r){o(t),n(t),function(){const t=e.session.get("unacked_stanzas");e.session.save("unacked_stanzas",[]),t.forEach(t=>e.api.send(t))}(),e.connection.do_bind=!1,e.connection.authenticated=!0,e.connection.restored=!0,e.connection._changeConnectStatus(On.Status.CONNECTED,null)}e.api.settings.update({enable_smacks:!1,smacks_max_unacked_stanzas:5}),e.api.listen.on("userSessionInitialized",function(){e.session.save({smacks_enabled:e.session.get("smacks_enabled")||!1,num_stanzas_handled:e.session.get("num_stanzas_handled")||0,num_stanzas_handled_by_server:e.session.get("num_stanzas_handled_by_server")||0,num_stanzas_since_last_ack:e.session.get("num_stanzas_since_last_ack")||0,unacked_stanzas:e.session.get("unacked_stanzas")||[]})}),e.api.listen.on("beforeResourceBinding",async function(){e.enable_smacks&&await t()&&(e.connection.addHandler(i),e.connection.addHandler(r,On.NS.SM,"r"),e.connection.addHandler(n,On.NS.SM,"a"),e.session.get("smacks_stream_id")?await async function(){const t=Mn.getResolveablePromise();e.connection._addSysHandler(Rn.flow(c,t.resolve),On.NS.SM,"resumed"),e.connection._addSysHandler(Rn.flow(a,t.resolve),On.NS.SM,"failed");const n=e.session.get("smacks_stream_id"),r=e.session.get("num_stanzas_handled"),i=Mn.toStanza('<resume xmlns="'.concat(On.NS.SM,'" h="').concat(r,'" previd="').concat(n,'"/>'));e.api.send(i),e.connection.flush(),await t}():s())}),e.api.listen.on("afterResourceBinding",async function(){if(e.enable_smacks&&!e.session.get("smacks_enabled")&&await t()){const t=Mn.getResolveablePromise();e.connection._addSysHandler(Rn.flow(o,t.resolve),On.NS.SM,"enabled"),e.connection._addSysHandler(Rn.flow(a,t.resolve),On.NS.SM,"failed");const n=e.api.connection.isType("websocket")||e.isTestEnv(),r=Mn.toStanza('<enable xmlns="'.concat(On.NS.SM,'" resume="').concat(n,'"/>'));e.api.send(r),e.connection.flush(),await t}}),e.api.listen.on("send",function(t){if(e.session){if(e.session.get("smacks_enabled")&&(Mn.isTagEqual(t,"iq")||Mn.isTagEqual(t,"presence")||Mn.isTagEqual(t,"message"))){const n=On.serialize(t);e.session.save("unacked_stanzas",(e.session.get("unacked_stanzas")||[]).concat([n]));const r=e.smacks_max_unacked_stanzas;if(r>0){const t=e.session.get("num_stanzas_since_last_ack")+1;t%r==0&&e.api.send(Mn.toStanza('<r xmlns="'.concat(On.NS.SM,'"/>'))),e.session.save({num_stanzas_since_last_ack:t})}}}else e.log("No _converse.session!",On.LogLevel.WARN)})}});var In=n(101),kn=n.n(In);const{Backbone:Ln,Strophe:Dn,_:Fn,$iq:Pn,$build:Un,dayjs:zn,sizzle:Bn}=Ze.env,Hn=Ze.env.utils;Ze.plugins.add("converse-vcard",{dependencies:["converse-roster"],overrides:{XMPPStatus:{getNickname(){const{_converse:e}=this.__super__,t=this.__super__.getNickname.apply(this);return!t&&e.xmppstatus.vcard?e.xmppstatus.vcard.get("nickname"):t},getFullname(){const{_converse:e}=this.__super__,t=this.__super__.getFullname.apply(this);return!t&&e.xmppstatus.vcard?e.xmppstatus.vcard.get("fullname"):t}},RosterContact:{getDisplayName(){return!this.get("nickname")&&this.vcard?this.vcard.getDisplayName():this.__super__.getDisplayName.apply(this)},getFullname(){return this.vcard?this.vcard.get("fullname"):this.__super__.getFullname.apply(this)}}},initialize(){const{_converse:e}=this;function t(e,t,n){const r=Pn(t?{type:e,to:t}:{type:e});return n?r.cnode(n):r.c("vCard",{xmlns:Dn.NS.VCARD}),r}async function n(e,n){const r=Dn.getBareJidFromJid(n)===e.bare_jid?null:n;let i;try{i=await e.api.sendIQ(t("get",r))}catch(i){return{stanza:i,jid:n,vcard_error:(new Date).toISOString()}}return async function(e,t){const n=t.querySelector("vCard");let r={};if(null!==n&&(r={stanza:t,fullname:Fn.get(n.querySelector("FN"),"textContent"),nickname:Fn.get(n.querySelector("NICKNAME"),"textContent"),image:Fn.get(n.querySelector("PHOTO BINVAL"),"textContent"),image_type:Fn.get(n.querySelector("PHOTO TYPE"),"textContent"),url:Fn.get(n.querySelector("URL"),"textContent"),role:Fn.get(n.querySelector("ROLE"),"textContent"),email:Fn.get(n.querySelector("EMAIL USERID"),"textContent"),vcard_updated:(new Date).toISOString(),vcard_error:void 0}),r.image){const e=Hn.base64ToArrayBuffer(r.image),t=await crypto.subtle.digest("SHA-1",e);r.image_hash=Hn.arrayBufferToHex(t)}return r}(0,i)}e.VCard=Ln.Model.extend({defaults:{image:e.DEFAULT_IMAGE,image_type:e.DEFAULT_IMAGE_TYPE},set(t,n,r){let i;return"object"==typeof t?(i=t,r=n):(i={})[t]=n,Fn.has(i,"image")&&!i.image?(i.image=e.DEFAULT_IMAGE,i.image_type=e.DEFAULT_IMAGE_TYPE,Ln.Model.prototype.set.call(this,i,r)):Ln.Model.prototype.set.apply(this,arguments)},getDisplayName(){return this.get("nickname")||this.get("fullname")||this.get("jid")}}),e.VCards=e.Collection.extend({model:e.VCard,initialize(){this.on("add",t=>e.api.vcard.update(t))}}),e.initVCardCollection=function(){e.vcards=new e.VCards;const t="".concat(e.bare_jid,"-converse.vcards");e.vcards.browserStorage=new(i.a[e.config.get("storage")])(t),e.vcards.fetch()},e.api.listen.on("afterResourceBinding",e.initVCardCollection),e.api.listen.on("statusInitialized",()=>{const t=e.vcards;if(e.session){const n=e.session.get("bare_jid");e.xmppstatus.vcard=t.findWhere({jid:n})||t.create({jid:n})}}),e.api.listen.on("clearSession",()=>{e.shouldClearCache()&&e.vcards&&(e.vcards.clearSession(),delete e.vcards)}),e.api.listen.on("addClientFeatures",()=>e.api.disco.own.features.add(Dn.NS.VCARD)),e.api.listen.on("rosterContactInitialized",t=>(function(t){const n=t.get("jid");t.vcard=e.vcards.findWhere({jid:n}),t.vcard||(t.vcard=e.vcards.create({jid:n}))})(t)),Object.assign(e.api,{vcard:{set(n,r){if(!n)throw Error("No jid provided for the VCard data");const i=Dn.xmlHtmlNode(kn()(r)).firstElementChild;return e.api.sendIQ(t("set",n,i))},get(t,r){if(Fn.isString(t))return n(e,t);if(!r&&t.get("vcard_updated")&&zn(t.get("vcard_error")).isSame(new Date,"day"))return Promise.resolve({});{const r=t.get("jid");if(!r)throw new Error("No JID to get vcard for!");return n(e,r)}},async update(e,t){const n=await this.get(e,t);delete n.stanza,e.save(n)}}})}});t.default=Ze}]);
//# sourceMappingURL=converse-headless.min.js.map